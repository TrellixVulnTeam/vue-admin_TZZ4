{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js!/home/mengy/develop/iwork/kafo/vue-admin/src/proto/js/anchortype_pb.js","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-admin/src/proto/js/anchortype_pb.js","mtime":1630412312351},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8gc291cmNlOiBhbmNob3J0eXBlLnByb3RvCgovKioKICogQGZpbGVvdmVydmlldwogKiBAZW5oYW5jZWFibGUKICogQHN1cHByZXNzIHttaXNzaW5nUmVxdWlyZX0gcmVwb3J0cyBlcnJvciBvbiBpbXBsaWNpdCB0eXBlIHVzYWdlcy4KICogQHN1cHByZXNzIHttZXNzYWdlQ29udmVudGlvbnN9IEpTIENvbXBpbGVyIHJlcG9ydHMgYW4gZXJyb3IgaWYgYSB2YXJpYWJsZSBvcgogKiAgICAgZmllbGQgc3RhcnRzIHdpdGggJ01TR18nIGFuZCBpc24ndCBhIHRyYW5zbGF0YWJsZSBtZXNzYWdlLgogKiBAcHVibGljCiAqLwovLyBHRU5FUkFURUQgQ09ERSAtLSBETyBOT1QgRURJVCEKCi8qIGVzbGludC1kaXNhYmxlICovCi8vIEB0cy1ub2NoZWNrCnZhciBqc3BiID0gcmVxdWlyZSgnZ29vZ2xlLXByb3RvYnVmJyk7Cgp2YXIgZ29vZyA9IGpzcGI7CnZhciBnbG9iYWwgPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpOwoKdmFyIHVzZXJ0eXBlX3BiID0gcmVxdWlyZSgnLi91c2VydHlwZV9wYi5qcycpOwoKZ29vZy5vYmplY3QuZXh0ZW5kKHByb3RvLCB1c2VydHlwZV9wYik7Cmdvb2cuZXhwb3J0U3ltYm9sKCdwcm90by5wYi5BbmNob3JCYXNpYycsIG51bGwsIGdsb2JhbCk7Cmdvb2cuZXhwb3J0U3ltYm9sKCdwcm90by5wYi5BbmNob3JQcm9maWxlJywgbnVsbCwgZ2xvYmFsKTsKZ29vZy5leHBvcnRTeW1ib2woJ3Byb3RvLnBiLk9ubGluZVJlY29yZCcsIG51bGwsIGdsb2JhbCk7Cmdvb2cuZXhwb3J0U3ltYm9sKCdwcm90by5wYi5TZXR0bGVSZWNvcmQnLCBudWxsLCBnbG9iYWwpOwovKioKICogR2VuZXJhdGVkIGJ5IEpzUGJDb2RlR2VuZXJhdG9yLgogKiBAcGFyYW0ge0FycmF5PX0gb3B0X2RhdGEgT3B0aW9uYWwgaW5pdGlhbCBkYXRhIGFycmF5LCB0eXBpY2FsbHkgZnJvbSBhCiAqIHNlcnZlciByZXNwb25zZSwgb3IgY29uc3RydWN0ZWQgZGlyZWN0bHkgaW4gSmF2YXNjcmlwdC4gVGhlIGFycmF5IGlzIHVzZWQKICogaW4gcGxhY2UgYW5kIGJlY29tZXMgcGFydCBvZiB0aGUgY29uc3RydWN0ZWQgb2JqZWN0LiBJdCBpcyBub3QgY2xvbmVkLgogKiBJZiBubyBkYXRhIGlzIHByb3ZpZGVkLCB0aGUgY29uc3RydWN0ZWQgb2JqZWN0IHdpbGwgYmUgZW1wdHksIGJ1dCBzdGlsbAogKiB2YWxpZC4KICogQGV4dGVuZHMge2pzcGIuTWVzc2FnZX0KICogQGNvbnN0cnVjdG9yCiAqLwoKcHJvdG8ucGIuQW5jaG9yQmFzaWMgPSBmdW5jdGlvbiAob3B0X2RhdGEpIHsKICBqc3BiLk1lc3NhZ2UuaW5pdGlhbGl6ZSh0aGlzLCBvcHRfZGF0YSwgMCwgLTEsIHByb3RvLnBiLkFuY2hvckJhc2ljLnJlcGVhdGVkRmllbGRzXywgbnVsbCk7Cn07Cgpnb29nLmluaGVyaXRzKHByb3RvLnBiLkFuY2hvckJhc2ljLCBqc3BiLk1lc3NhZ2UpOwoKaWYgKGdvb2cuREVCVUcgJiYgIUNPTVBJTEVEKSB7CiAgLyoqCiAgICogQHB1YmxpYwogICAqIEBvdmVycmlkZQogICAqLwogIHByb3RvLnBiLkFuY2hvckJhc2ljLmRpc3BsYXlOYW1lID0gJ3Byb3RvLnBiLkFuY2hvckJhc2ljJzsKfQovKioKICogR2VuZXJhdGVkIGJ5IEpzUGJDb2RlR2VuZXJhdG9yLgogKiBAcGFyYW0ge0FycmF5PX0gb3B0X2RhdGEgT3B0aW9uYWwgaW5pdGlhbCBkYXRhIGFycmF5LCB0eXBpY2FsbHkgZnJvbSBhCiAqIHNlcnZlciByZXNwb25zZSwgb3IgY29uc3RydWN0ZWQgZGlyZWN0bHkgaW4gSmF2YXNjcmlwdC4gVGhlIGFycmF5IGlzIHVzZWQKICogaW4gcGxhY2UgYW5kIGJlY29tZXMgcGFydCBvZiB0aGUgY29uc3RydWN0ZWQgb2JqZWN0LiBJdCBpcyBub3QgY2xvbmVkLgogKiBJZiBubyBkYXRhIGlzIHByb3ZpZGVkLCB0aGUgY29uc3RydWN0ZWQgb2JqZWN0IHdpbGwgYmUgZW1wdHksIGJ1dCBzdGlsbAogKiB2YWxpZC4KICogQGV4dGVuZHMge2pzcGIuTWVzc2FnZX0KICogQGNvbnN0cnVjdG9yCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUgPSBmdW5jdGlvbiAob3B0X2RhdGEpIHsKICBqc3BiLk1lc3NhZ2UuaW5pdGlhbGl6ZSh0aGlzLCBvcHRfZGF0YSwgMCwgLTEsIHByb3RvLnBiLkFuY2hvclByb2ZpbGUucmVwZWF0ZWRGaWVsZHNfLCBudWxsKTsKfTsKCmdvb2cuaW5oZXJpdHMocHJvdG8ucGIuQW5jaG9yUHJvZmlsZSwganNwYi5NZXNzYWdlKTsKCmlmIChnb29nLkRFQlVHICYmICFDT01QSUxFRCkgewogIC8qKgogICAqIEBwdWJsaWMKICAgKiBAb3ZlcnJpZGUKICAgKi8KICBwcm90by5wYi5BbmNob3JQcm9maWxlLmRpc3BsYXlOYW1lID0gJ3Byb3RvLnBiLkFuY2hvclByb2ZpbGUnOwp9Ci8qKgogKiBHZW5lcmF0ZWQgYnkgSnNQYkNvZGVHZW5lcmF0b3IuCiAqIEBwYXJhbSB7QXJyYXk9fSBvcHRfZGF0YSBPcHRpb25hbCBpbml0aWFsIGRhdGEgYXJyYXksIHR5cGljYWxseSBmcm9tIGEKICogc2VydmVyIHJlc3BvbnNlLCBvciBjb25zdHJ1Y3RlZCBkaXJlY3RseSBpbiBKYXZhc2NyaXB0LiBUaGUgYXJyYXkgaXMgdXNlZAogKiBpbiBwbGFjZSBhbmQgYmVjb21lcyBwYXJ0IG9mIHRoZSBjb25zdHJ1Y3RlZCBvYmplY3QuIEl0IGlzIG5vdCBjbG9uZWQuCiAqIElmIG5vIGRhdGEgaXMgcHJvdmlkZWQsIHRoZSBjb25zdHJ1Y3RlZCBvYmplY3Qgd2lsbCBiZSBlbXB0eSwgYnV0IHN0aWxsCiAqIHZhbGlkLgogKiBAZXh0ZW5kcyB7anNwYi5NZXNzYWdlfQogKiBAY29uc3RydWN0b3IKICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkID0gZnVuY3Rpb24gKG9wdF9kYXRhKSB7CiAganNwYi5NZXNzYWdlLmluaXRpYWxpemUodGhpcywgb3B0X2RhdGEsIDAsIC0xLCBudWxsLCBudWxsKTsKfTsKCmdvb2cuaW5oZXJpdHMocHJvdG8ucGIuT25saW5lUmVjb3JkLCBqc3BiLk1lc3NhZ2UpOwoKaWYgKGdvb2cuREVCVUcgJiYgIUNPTVBJTEVEKSB7CiAgLyoqCiAgICogQHB1YmxpYwogICAqIEBvdmVycmlkZQogICAqLwogIHByb3RvLnBiLk9ubGluZVJlY29yZC5kaXNwbGF5TmFtZSA9ICdwcm90by5wYi5PbmxpbmVSZWNvcmQnOwp9Ci8qKgogKiBHZW5lcmF0ZWQgYnkgSnNQYkNvZGVHZW5lcmF0b3IuCiAqIEBwYXJhbSB7QXJyYXk9fSBvcHRfZGF0YSBPcHRpb25hbCBpbml0aWFsIGRhdGEgYXJyYXksIHR5cGljYWxseSBmcm9tIGEKICogc2VydmVyIHJlc3BvbnNlLCBvciBjb25zdHJ1Y3RlZCBkaXJlY3RseSBpbiBKYXZhc2NyaXB0LiBUaGUgYXJyYXkgaXMgdXNlZAogKiBpbiBwbGFjZSBhbmQgYmVjb21lcyBwYXJ0IG9mIHRoZSBjb25zdHJ1Y3RlZCBvYmplY3QuIEl0IGlzIG5vdCBjbG9uZWQuCiAqIElmIG5vIGRhdGEgaXMgcHJvdmlkZWQsIHRoZSBjb25zdHJ1Y3RlZCBvYmplY3Qgd2lsbCBiZSBlbXB0eSwgYnV0IHN0aWxsCiAqIHZhbGlkLgogKiBAZXh0ZW5kcyB7anNwYi5NZXNzYWdlfQogKiBAY29uc3RydWN0b3IKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkID0gZnVuY3Rpb24gKG9wdF9kYXRhKSB7CiAganNwYi5NZXNzYWdlLmluaXRpYWxpemUodGhpcywgb3B0X2RhdGEsIDAsIC0xLCBudWxsLCBudWxsKTsKfTsKCmdvb2cuaW5oZXJpdHMocHJvdG8ucGIuU2V0dGxlUmVjb3JkLCBqc3BiLk1lc3NhZ2UpOwoKaWYgKGdvb2cuREVCVUcgJiYgIUNPTVBJTEVEKSB7CiAgLyoqCiAgICogQHB1YmxpYwogICAqIEBvdmVycmlkZQogICAqLwogIHByb3RvLnBiLlNldHRsZVJlY29yZC5kaXNwbGF5TmFtZSA9ICdwcm90by5wYi5TZXR0bGVSZWNvcmQnOwp9Ci8qKgogKiBMaXN0IG9mIHJlcGVhdGVkIGZpZWxkcyB3aXRoaW4gdGhpcyBtZXNzYWdlIHR5cGUuCiAqIEBwcml2YXRlIHshQXJyYXk8bnVtYmVyPn0KICogQGNvbnN0CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnJlcGVhdGVkRmllbGRzXyA9IFsxNCwgMjIsIDEwMCwgMTAxXTsKCmlmIChqc3BiLk1lc3NhZ2UuR0VORVJBVEVfVE9fT0JKRUNUKSB7CiAgLyoqCiAgICogQ3JlYXRlcyBhbiBvYmplY3QgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBwcm90by4KICAgKiBGaWVsZCBuYW1lcyB0aGF0IGFyZSByZXNlcnZlZCBpbiBKYXZhU2NyaXB0IGFuZCB3aWxsIGJlIHJlbmFtZWQgdG8gcGJfbmFtZS4KICAgKiBPcHRpb25hbCBmaWVsZHMgdGhhdCBhcmUgbm90IHNldCB3aWxsIGJlIHNldCB0byB1bmRlZmluZWQuCiAgICogVG8gYWNjZXNzIGEgcmVzZXJ2ZWQgZmllbGQgdXNlLCBmb28ucGJfPG5hbWU+LCBlZywgZm9vLnBiX2RlZmF1bHQuCiAgICogRm9yIHRoZSBsaXN0IG9mIHJlc2VydmVkIG5hbWVzIHBsZWFzZSBzZWU6CiAgICogICAgIG5ldC9wcm90bzIvY29tcGlsZXIvanMvaW50ZXJuYWwvZ2VuZXJhdG9yLmNjI2tLZXl3b3JkLgogICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbmNsdWRlSW5zdGFuY2UgRGVwcmVjYXRlZC4gd2hldGhlciB0byBpbmNsdWRlIHRoZQogICAqICAgICBKU1BCIGluc3RhbmNlIGZvciB0cmFuc2l0aW9uYWwgc295IHByb3RvIHN1cHBvcnQ6CiAgICogICAgIGh0dHA6Ly9nb3RvL3NveS1wYXJhbS1taWdyYXRpb24KICAgKiBAcmV0dXJuIHshT2JqZWN0fQogICAqLwogIHByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS50b09iamVjdCA9IGZ1bmN0aW9uIChvcHRfaW5jbHVkZUluc3RhbmNlKSB7CiAgICByZXR1cm4gcHJvdG8ucGIuQW5jaG9yQmFzaWMudG9PYmplY3Qob3B0X2luY2x1ZGVJbnN0YW5jZSwgdGhpcyk7CiAgfTsKICAvKioKICAgKiBTdGF0aWMgdmVyc2lvbiBvZiB0aGUge0BzZWUgdG9PYmplY3R9IG1ldGhvZC4KICAgKiBAcGFyYW0ge2Jvb2xlYW58dW5kZWZpbmVkfSBpbmNsdWRlSW5zdGFuY2UgRGVwcmVjYXRlZC4gV2hldGhlciB0byBpbmNsdWRlCiAgICogICAgIHRoZSBKU1BCIGluc3RhbmNlIGZvciB0cmFuc2l0aW9uYWwgc295IHByb3RvIHN1cHBvcnQ6CiAgICogICAgIGh0dHA6Ly9nb3RvL3NveS1wYXJhbS1taWdyYXRpb24KICAgKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JCYXNpY30gbXNnIFRoZSBtc2cgaW5zdGFuY2UgdG8gdHJhbnNmb3JtLgogICAqIEByZXR1cm4geyFPYmplY3R9CiAgICogQHN1cHByZXNzIHt1bnVzZWRMb2NhbFZhcmlhYmxlc30gZiBpcyBvbmx5IHVzZWQgZm9yIG5lc3RlZCBtZXNzYWdlcwogICAqLwoKCiAgcHJvdG8ucGIuQW5jaG9yQmFzaWMudG9PYmplY3QgPSBmdW5jdGlvbiAoaW5jbHVkZUluc3RhbmNlLCBtc2cpIHsKICAgIHZhciBmLAogICAgICAgIG9iaiA9IHsKICAgICAgaWQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMSwgMCksCiAgICAgIGFwcElkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDIsIDApLAogICAgICB2ZXJzaW9uOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDMsIDApLAogICAgICBndWlsZElkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDQsIDApLAogICAgICBhcmVhSWQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNSwgMCksCiAgICAgIHJvYm90OiBqc3BiLk1lc3NhZ2UuZ2V0Qm9vbGVhbkZpZWxkV2l0aERlZmF1bHQobXNnLCA2LCBmYWxzZSksCiAgICAgIGNvdW50cnk6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNywgIiIpLAogICAgICBvbmxpbmVTdGF0dXM6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgOCwgMCksCiAgICAgIHJldmlld1N0YXR1czoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCA5LCAwKSwKICAgICAgcHJvZmlsZUNvdW50OiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDEwLCAwKSwKICAgICAgYWN0aXZlQ291bnQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMTEsIDApLAogICAgICBsZXZlbDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAxMiwgMCksCiAgICAgIGxhbmc6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMTMsICIiKSwKICAgICAgbGFuZ3NMaXN0OiAoZiA9IGpzcGIuTWVzc2FnZS5nZXRSZXBlYXRlZEZpZWxkKG1zZywgMTQpKSA9PSBudWxsID8gdW5kZWZpbmVkIDogZiwKICAgICAgcHJpY2U6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMTUsIDApLAogICAgICBjYWxsSW5jb21lOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDE2LCAwKSwKICAgICAgZ2lmdEluY29tZToganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAxNywgMCksCiAgICAgIGNvbW1pc3Npb25JbmNvbWU6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMTgsIDApLAogICAgICBiYWxhbmNlOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDE5LCAwKSwKICAgICAgc2V0dGxlZDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAyMCwgMCksCiAgICAgIGZhbnNDb3VudDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAyMSwgMCksCiAgICAgIGxpdmVJZHNMaXN0OiAoZiA9IGpzcGIuTWVzc2FnZS5nZXRSZXBlYXRlZEZpZWxkKG1zZywgMjIpKSA9PSBudWxsID8gdW5kZWZpbmVkIDogZiwKICAgICAgb2ZmbGluZUF0OiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDIzLCAwKSwKICAgICAgYmxvY2tTdGF0dXM6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMjQsIDApLAogICAgICBvbmxpbmVJcDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAyNSwgIiIpLAogICAgICBsb25naXR1ZGU6IGpzcGIuTWVzc2FnZS5nZXRGbG9hdGluZ1BvaW50RmllbGRXaXRoRGVmYXVsdChtc2csIDI2LCAwLjApLAogICAgICBsYXRpdHVkZToganNwYi5NZXNzYWdlLmdldEZsb2F0aW5nUG9pbnRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMjcsIDAuMCksCiAgICAgIGNyZWF0ZUlwOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDI4LCAiIiksCiAgICAgIGRldmljZUlkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDI5LCAwKSwKICAgICAgbmV0d29ya1R5cGU6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMzAsIDApLAogICAgICBiYW5rTmFtZToganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAzMSwgIiIpLAogICAgICBhY2NvdW50TmFtZToganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAzMiwgIiIpLAogICAgICBiYW5rQWNjb3VudDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAzMywgIiIpLAogICAgICBlbWFpbDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAzNCwgIiIpLAogICAgICBub3RlOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDM1LCAiIiksCiAgICAgIGhlYXJ0YmVhdEF0OiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDM2LCAwKSwKICAgICAgYWNjZXNzVG9rZW46IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMzcsICIiKSwKICAgICAgYWNjZXNzRXhwaXJlQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMzgsIDApLAogICAgICBhZ29yYVJ0bVRva2VuOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDM5LCAiIiksCiAgICAgIGFnb3JhUnRtRXhwaXJlQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNDAsIDApLAogICAgICByY1Rva2VuOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDQxLCAiIiksCiAgICAgIHJjRXhwaXJlQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNDIsIDApLAogICAgICB1cGRhdGVkQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNTAsIDApLAogICAgICBjcmVhdGVkQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNTEsIDApLAogICAgICB0b3lhSWQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNTIsIDApLAogICAgICB0b3lhU3luY2VkQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNTMsIDApLAogICAgICB0b3lhU3RhdHVzOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDU0LCAwKSwKICAgICAgcHJvZmlsZXNMaXN0OiBqc3BiLk1lc3NhZ2UudG9PYmplY3RMaXN0KG1zZy5nZXRQcm9maWxlc0xpc3QoKSwgcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS50b09iamVjdCwgaW5jbHVkZUluc3RhbmNlKSwKICAgICAgbGl2ZXNMaXN0OiBqc3BiLk1lc3NhZ2UudG9PYmplY3RMaXN0KG1zZy5nZXRMaXZlc0xpc3QoKSwgdXNlcnR5cGVfcGIuRmlsZVJlY29yZC50b09iamVjdCwgaW5jbHVkZUluc3RhbmNlKQogICAgfTsKCiAgICBpZiAoaW5jbHVkZUluc3RhbmNlKSB7CiAgICAgIG9iai4kanNwYk1lc3NhZ2VJbnN0YW5jZSA9IG1zZzsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH07Cn0KLyoqCiAqIERlc2VyaWFsaXplcyBiaW5hcnkgZGF0YSAoaW4gcHJvdG9idWYgd2lyZSBmb3JtYXQpLgogKiBAcGFyYW0ge2pzcGIuQnl0ZVNvdXJjZX0gYnl0ZXMgVGhlIGJ5dGVzIHRvIGRlc2VyaWFsaXplLgogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLmRlc2VyaWFsaXplQmluYXJ5ID0gZnVuY3Rpb24gKGJ5dGVzKSB7CiAgdmFyIHJlYWRlciA9IG5ldyBqc3BiLkJpbmFyeVJlYWRlcihieXRlcyk7CiAgdmFyIG1zZyA9IG5ldyBwcm90by5wYi5BbmNob3JCYXNpYygpOwogIHJldHVybiBwcm90by5wYi5BbmNob3JCYXNpYy5kZXNlcmlhbGl6ZUJpbmFyeUZyb21SZWFkZXIobXNnLCByZWFkZXIpOwp9OwovKioKICogRGVzZXJpYWxpemVzIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlIGZvcm1hdCkgZnJvbSB0aGUKICogZ2l2ZW4gcmVhZGVyIGludG8gdGhlIGdpdmVuIG1lc3NhZ2Ugb2JqZWN0LgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JCYXNpY30gbXNnIFRoZSBtZXNzYWdlIG9iamVjdCB0byBkZXNlcmlhbGl6ZSBpbnRvLgogKiBAcGFyYW0geyFqc3BiLkJpbmFyeVJlYWRlcn0gcmVhZGVyIFRoZSBCaW5hcnlSZWFkZXIgdG8gdXNlLgogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLmRlc2VyaWFsaXplQmluYXJ5RnJvbVJlYWRlciA9IGZ1bmN0aW9uIChtc2csIHJlYWRlcikgewogIHdoaWxlIChyZWFkZXIubmV4dEZpZWxkKCkpIHsKICAgIGlmIChyZWFkZXIuaXNFbmRHcm91cCgpKSB7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIHZhciBmaWVsZCA9IHJlYWRlci5nZXRGaWVsZE51bWJlcigpOwoKICAgIHN3aXRjaCAoZmllbGQpIHsKICAgICAgY2FzZSAxOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0SWQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0QXBwSWQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0VmVyc2lvbih2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDQ6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRHdWlsZElkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEFyZWFJZCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDY6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge2Jvb2xlYW59ICovCiAgICAgICAgcmVhZGVyLnJlYWRCb29sKCk7CiAgICAgICAgbXNnLnNldFJvYm90KHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNzoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgICAgIHJlYWRlci5yZWFkU3RyaW5nKCk7CiAgICAgICAgbXNnLnNldENvdW50cnkodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA4OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuT25saW5lU3RhdHVzfSAqLwogICAgICAgIHJlYWRlci5yZWFkRW51bSgpOwogICAgICAgIG1zZy5zZXRPbmxpbmVTdGF0dXModmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA5OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuUmV2aWV3U3RhdHVzfSAqLwogICAgICAgIHJlYWRlci5yZWFkRW51bSgpOwogICAgICAgIG1zZy5zZXRSZXZpZXdTdGF0dXModmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxMDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldFByb2ZpbGVDb3VudCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDExOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0QWN0aXZlQ291bnQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxMjoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7IXByb3RvLnBiLkFuY2hvckxldmVsfSAqLwogICAgICAgIHJlYWRlci5yZWFkRW51bSgpOwogICAgICAgIG1zZy5zZXRMZXZlbCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDEzOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICAgICAgcmVhZGVyLnJlYWRTdHJpbmcoKTsKICAgICAgICBtc2cuc2V0TGFuZyh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDE0OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICAgICAgcmVhZGVyLnJlYWRTdHJpbmcoKTsKICAgICAgICBtc2cuYWRkTGFuZ3ModmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxNToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldFByaWNlKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTY6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRDYWxsSW5jb21lKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTc6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRHaWZ0SW5jb21lKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTg6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRDb21taXNzaW9uSW5jb21lKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTk6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRCYWxhbmNlKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjA6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRTZXR0bGVkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjE6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRGYW5zQ291bnQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyMjoKICAgICAgICB2YXIgdmFsdWVzID0KICAgICAgICAvKiogQHR5cGUgeyFBcnJheTxudW1iZXI+fSAqLwogICAgICAgIHJlYWRlci5pc0RlbGltaXRlZCgpID8gcmVhZGVyLnJlYWRQYWNrZWRVaW50NjQoKSA6IFtyZWFkZXIucmVhZFVpbnQ2NCgpXTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIG1zZy5hZGRMaXZlSWRzKHZhbHVlc1tpXSk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjM6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRPZmZsaW5lQXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyNDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7IXByb3RvLnBiLkJsb2NrU3RhdHVzfSAqLwogICAgICAgIHJlYWRlci5yZWFkRW51bSgpOwogICAgICAgIG1zZy5zZXRCbG9ja1N0YXR1cyh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDI1OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICAgICAgcmVhZGVyLnJlYWRTdHJpbmcoKTsKICAgICAgICBtc2cuc2V0T25saW5lSXAodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyNjoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkRmxvYXQoKTsKICAgICAgICBtc2cuc2V0TG9uZ2l0dWRlKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjc6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZEZsb2F0KCk7CiAgICAgICAgbXNnLnNldExhdGl0dWRlKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjg6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgICAgICByZWFkZXIucmVhZFN0cmluZygpOwogICAgICAgIG1zZy5zZXRDcmVhdGVJcCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDI5OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0RGV2aWNlSWQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzMDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7IXByb3RvLnBiLk5ldHdvcmtUeXBlfSAqLwogICAgICAgIHJlYWRlci5yZWFkRW51bSgpOwogICAgICAgIG1zZy5zZXROZXR3b3JrVHlwZSh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDMxOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICAgICAgcmVhZGVyLnJlYWRTdHJpbmcoKTsKICAgICAgICBtc2cuc2V0QmFua05hbWUodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzMjoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgICAgIHJlYWRlci5yZWFkU3RyaW5nKCk7CiAgICAgICAgbXNnLnNldEFjY291bnROYW1lKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzM6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgICAgICByZWFkZXIucmVhZFN0cmluZygpOwogICAgICAgIG1zZy5zZXRCYW5rQWNjb3VudCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDM0OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICAgICAgcmVhZGVyLnJlYWRTdHJpbmcoKTsKICAgICAgICBtc2cuc2V0RW1haWwodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzNToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgICAgIHJlYWRlci5yZWFkU3RyaW5nKCk7CiAgICAgICAgbXNnLnNldE5vdGUodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzNjoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEhlYXJ0YmVhdEF0KHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzc6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgICAgICByZWFkZXIucmVhZFN0cmluZygpOwogICAgICAgIG1zZy5zZXRBY2Nlc3NUb2tlbih2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDM4OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0QWNjZXNzRXhwaXJlQXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzOToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgICAgIHJlYWRlci5yZWFkU3RyaW5nKCk7CiAgICAgICAgbXNnLnNldEFnb3JhUnRtVG9rZW4odmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA0MDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEFnb3JhUnRtRXhwaXJlQXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA0MToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgICAgIHJlYWRlci5yZWFkU3RyaW5nKCk7CiAgICAgICAgbXNnLnNldFJjVG9rZW4odmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA0MjoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldFJjRXhwaXJlQXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA1MDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldFVwZGF0ZWRBdCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDUxOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0Q3JlYXRlZEF0KHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNTI6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRUb3lhSWQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA1MzoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldFRveWFTeW5jZWRBdCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDU0OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuVG95YVN0YXR1c30gKi8KICAgICAgICByZWFkZXIucmVhZEVudW0oKTsKICAgICAgICBtc2cuc2V0VG95YVN0YXR1cyh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDEwMDoKICAgICAgICB2YXIgdmFsdWUgPSBuZXcgcHJvdG8ucGIuQW5jaG9yUHJvZmlsZSgpOwogICAgICAgIHJlYWRlci5yZWFkTWVzc2FnZSh2YWx1ZSwgcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5kZXNlcmlhbGl6ZUJpbmFyeUZyb21SZWFkZXIpOwogICAgICAgIG1zZy5hZGRQcm9maWxlcyh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDEwMToKICAgICAgICB2YXIgdmFsdWUgPSBuZXcgdXNlcnR5cGVfcGIuRmlsZVJlY29yZCgpOwogICAgICAgIHJlYWRlci5yZWFkTWVzc2FnZSh2YWx1ZSwgdXNlcnR5cGVfcGIuRmlsZVJlY29yZC5kZXNlcmlhbGl6ZUJpbmFyeUZyb21SZWFkZXIpOwogICAgICAgIG1zZy5hZGRMaXZlcyh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHJlYWRlci5za2lwRmllbGQoKTsKICAgICAgICBicmVhazsKICAgIH0KICB9CgogIHJldHVybiBtc2c7Cn07Ci8qKgogKiBTZXJpYWxpemVzIHRoZSBtZXNzYWdlIHRvIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlIGZvcm1hdCkuCiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2VyaWFsaXplQmluYXJ5ID0gZnVuY3Rpb24gKCkgewogIHZhciB3cml0ZXIgPSBuZXcganNwYi5CaW5hcnlXcml0ZXIoKTsKICBwcm90by5wYi5BbmNob3JCYXNpYy5zZXJpYWxpemVCaW5hcnlUb1dyaXRlcih0aGlzLCB3cml0ZXIpOwogIHJldHVybiB3cml0ZXIuZ2V0UmVzdWx0QnVmZmVyKCk7Cn07Ci8qKgogKiBTZXJpYWxpemVzIHRoZSBnaXZlbiBtZXNzYWdlIHRvIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlCiAqIGZvcm1hdCksIHdyaXRpbmcgdG8gdGhlIGdpdmVuIEJpbmFyeVdyaXRlci4KICogQHBhcmFtIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IG1lc3NhZ2UKICogQHBhcmFtIHshanNwYi5CaW5hcnlXcml0ZXJ9IHdyaXRlcgogKiBAc3VwcHJlc3Mge3VudXNlZExvY2FsVmFyaWFibGVzfSBmIGlzIG9ubHkgdXNlZCBmb3IgbmVzdGVkIG1lc3NhZ2VzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnNlcmlhbGl6ZUJpbmFyeVRvV3JpdGVyID0gZnVuY3Rpb24gKG1lc3NhZ2UsIHdyaXRlcikgewogIHZhciBmID0gdW5kZWZpbmVkOwogIGYgPSBtZXNzYWdlLmdldElkKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMSwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRBcHBJZCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDIsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0VmVyc2lvbigpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDMsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0R3VpbGRJZCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDQsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0QXJlYUlkKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoNSwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRSb2JvdCgpOwoKICBpZiAoZikgewogICAgd3JpdGVyLndyaXRlQm9vbCg2LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldENvdW50cnkoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlU3RyaW5nKDcsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0T25saW5lU3RhdHVzKCk7CgogIGlmIChmICE9PSAwLjApIHsKICAgIHdyaXRlci53cml0ZUVudW0oOCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRSZXZpZXdTdGF0dXMoKTsKCiAgaWYgKGYgIT09IDAuMCkgewogICAgd3JpdGVyLndyaXRlRW51bSg5LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFByb2ZpbGVDb3VudCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDEwLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEFjdGl2ZUNvdW50KCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMTEsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0TGV2ZWwoKTsKCiAgaWYgKGYgIT09IDAuMCkgewogICAgd3JpdGVyLndyaXRlRW51bSgxMiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRMYW5nKCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVN0cmluZygxMywgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRMYW5nc0xpc3QoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlUmVwZWF0ZWRTdHJpbmcoMTQsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0UHJpY2UoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigxNSwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRDYWxsSW5jb21lKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMTYsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0R2lmdEluY29tZSgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDE3LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldENvbW1pc3Npb25JbmNvbWUoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigxOCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRCYWxhbmNlKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMTksIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0U2V0dGxlZCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDIwLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEZhbnNDb3VudCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDIxLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldExpdmVJZHNMaXN0KCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVBhY2tlZFVpbnQ2NCgyMiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRPZmZsaW5lQXQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigyMywgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRCbG9ja1N0YXR1cygpOwoKICBpZiAoZiAhPT0gMC4wKSB7CiAgICB3cml0ZXIud3JpdGVFbnVtKDI0LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldE9ubGluZUlwKCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVN0cmluZygyNSwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRMb25naXR1ZGUoKTsKCiAgaWYgKGYgIT09IDAuMCkgewogICAgd3JpdGVyLndyaXRlRmxvYXQoMjYsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0TGF0aXR1ZGUoKTsKCiAgaWYgKGYgIT09IDAuMCkgewogICAgd3JpdGVyLndyaXRlRmxvYXQoMjcsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0Q3JlYXRlSXAoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlU3RyaW5nKDI4LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldERldmljZUlkKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMjksIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0TmV0d29ya1R5cGUoKTsKCiAgaWYgKGYgIT09IDAuMCkgewogICAgd3JpdGVyLndyaXRlRW51bSgzMCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRCYW5rTmFtZSgpOwoKICBpZiAoZi5sZW5ndGggPiAwKSB7CiAgICB3cml0ZXIud3JpdGVTdHJpbmcoMzEsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0QWNjb3VudE5hbWUoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlU3RyaW5nKDMyLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEJhbmtBY2NvdW50KCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVN0cmluZygzMywgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRFbWFpbCgpOwoKICBpZiAoZi5sZW5ndGggPiAwKSB7CiAgICB3cml0ZXIud3JpdGVTdHJpbmcoMzQsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0Tm90ZSgpOwoKICBpZiAoZi5sZW5ndGggPiAwKSB7CiAgICB3cml0ZXIud3JpdGVTdHJpbmcoMzUsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0SGVhcnRiZWF0QXQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigzNiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRBY2Nlc3NUb2tlbigpOwoKICBpZiAoZi5sZW5ndGggPiAwKSB7CiAgICB3cml0ZXIud3JpdGVTdHJpbmcoMzcsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0QWNjZXNzRXhwaXJlQXQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigzOCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRBZ29yYVJ0bVRva2VuKCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVN0cmluZygzOSwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRBZ29yYVJ0bUV4cGlyZUF0KCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoNDAsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0UmNUb2tlbigpOwoKICBpZiAoZi5sZW5ndGggPiAwKSB7CiAgICB3cml0ZXIud3JpdGVTdHJpbmcoNDEsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0UmNFeHBpcmVBdCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDQyLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFVwZGF0ZWRBdCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDUwLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldENyZWF0ZWRBdCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDUxLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFRveWFJZCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDUyLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFRveWFTeW5jZWRBdCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDUzLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFRveWFTdGF0dXMoKTsKCiAgaWYgKGYgIT09IDAuMCkgewogICAgd3JpdGVyLndyaXRlRW51bSg1NCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRQcm9maWxlc0xpc3QoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlUmVwZWF0ZWRNZXNzYWdlKDEwMCwgZiwgcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5zZXJpYWxpemVCaW5hcnlUb1dyaXRlcik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRMaXZlc0xpc3QoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlUmVwZWF0ZWRNZXNzYWdlKDEwMSwgZiwgdXNlcnR5cGVfcGIuRmlsZVJlY29yZC5zZXJpYWxpemVCaW5hcnlUb1dyaXRlcik7CiAgfQp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGlkID0gMTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0SWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMSwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRJZCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGFwcF9pZCA9IDI7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldEFwcElkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDIsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0QXBwSWQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDIsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiB2ZXJzaW9uID0gMzsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0VmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAzLCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldFZlcnNpb24gPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDMsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBndWlsZF9pZCA9IDQ7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldEd1aWxkSWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgNCwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRHdWlsZElkID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCA0LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgYXJlYV9pZCA9IDU7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldEFyZWFJZCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA1LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldEFyZWFJZCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgNSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgYm9vbCByb2JvdCA9IDY7CiAqIEByZXR1cm4ge2Jvb2xlYW59CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRSb2JvdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtib29sZWFufSAqLwogICAganNwYi5NZXNzYWdlLmdldEJvb2xlYW5GaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDYsIGZhbHNlKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge2Jvb2xlYW59IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRSb2JvdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zQm9vbGVhbkZpZWxkKHRoaXMsIDYsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHN0cmluZyBjb3VudHJ5ID0gNzsKICogQHJldHVybiB7c3RyaW5nfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0Q291bnRyeSA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA3LCAiIikKICApOwp9OwovKioKICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRDb3VudHJ5ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNTdHJpbmdGaWVsZCh0aGlzLCA3LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBPbmxpbmVTdGF0dXMgb25saW5lX3N0YXR1cyA9IDg7CiAqIEByZXR1cm4geyFwcm90by5wYi5PbmxpbmVTdGF0dXN9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRPbmxpbmVTdGF0dXMgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7IXByb3RvLnBiLk9ubGluZVN0YXR1c30gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDgsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLk9ubGluZVN0YXR1c30gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldE9ubGluZVN0YXR1cyA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zRW51bUZpZWxkKHRoaXMsIDgsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIFJldmlld1N0YXR1cyByZXZpZXdfc3RhdHVzID0gOTsKICogQHJldHVybiB7IXByb3RvLnBiLlJldmlld1N0YXR1c30KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldFJldmlld1N0YXR1cyA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuUmV2aWV3U3RhdHVzfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgOSwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuUmV2aWV3U3RhdHVzfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0UmV2aWV3U3RhdHVzID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNFbnVtRmllbGQodGhpcywgOSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIHByb2ZpbGVfY291bnQgPSAxMDsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0UHJvZmlsZUNvdW50ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDEwLCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldFByb2ZpbGVDb3VudCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMTAsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBhY3RpdmVfY291bnQgPSAxMTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0QWN0aXZlQ291bnQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTEsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0QWN0aXZlQ291bnQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDExLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBBbmNob3JMZXZlbCBsZXZlbCA9IDEyOwogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yTGV2ZWx9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRMZXZlbCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuQW5jaG9yTGV2ZWx9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAxMiwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQW5jaG9yTGV2ZWx9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRMZXZlbCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zRW51bUZpZWxkKHRoaXMsIDEyLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBzdHJpbmcgbGFuZyA9IDEzOwogKiBAcmV0dXJuIHtzdHJpbmd9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRMYW5nID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDEzLCAiIikKICApOwp9OwovKioKICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRMYW5nID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNTdHJpbmdGaWVsZCh0aGlzLCAxMywgdmFsdWUpOwp9OwovKioKICogcmVwZWF0ZWQgc3RyaW5nIGxhbmdzID0gMTQ7CiAqIEByZXR1cm4geyFBcnJheTxzdHJpbmc+fQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0TGFuZ3NMaXN0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUgeyFBcnJheTxzdHJpbmc+fSAqLwogICAganNwYi5NZXNzYWdlLmdldFJlcGVhdGVkRmllbGQodGhpcywgMTQpCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRMYW5nc0xpc3QgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldEZpZWxkKHRoaXMsIDE0LCB2YWx1ZSB8fCBbXSk7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUKICogQHBhcmFtIHtudW1iZXI9fSBvcHRfaW5kZXgKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmFkZExhbmdzID0gZnVuY3Rpb24gKHZhbHVlLCBvcHRfaW5kZXgpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLmFkZFRvUmVwZWF0ZWRGaWVsZCh0aGlzLCAxNCwgdmFsdWUsIG9wdF9pbmRleCk7Cn07Ci8qKgogKiBDbGVhcnMgdGhlIGxpc3QgbWFraW5nIGl0IGVtcHR5IGJ1dCBub24tbnVsbC4KICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmNsZWFyTGFuZ3NMaXN0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzLnNldExhbmdzTGlzdChbXSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgcHJpY2UgPSAxNTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0UHJpY2UgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTUsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0UHJpY2UgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDE1LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgY2FsbF9pbmNvbWUgPSAxNjsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0Q2FsbEluY29tZSA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAxNiwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRDYWxsSW5jb21lID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAxNiwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGdpZnRfaW5jb21lID0gMTc7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldEdpZnRJbmNvbWUgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTcsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0R2lmdEluY29tZSA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMTcsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBjb21taXNzaW9uX2luY29tZSA9IDE4OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRDb21taXNzaW9uSW5jb21lID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDE4LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldENvbW1pc3Npb25JbmNvbWUgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDE4LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgYmFsYW5jZSA9IDE5OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRCYWxhbmNlID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDE5LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldEJhbGFuY2UgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDE5LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgc2V0dGxlZCA9IDIwOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRTZXR0bGVkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDIwLCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldFNldHRsZWQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDIwLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgZmFuc19jb3VudCA9IDIxOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRGYW5zQ291bnQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMjEsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0RmFuc0NvdW50ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAyMSwgdmFsdWUpOwp9OwovKioKICogcmVwZWF0ZWQgdWludDY0IGxpdmVfaWRzID0gMjI7CiAqIEByZXR1cm4geyFBcnJheTxudW1iZXI+fQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0TGl2ZUlkc0xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7IUFycmF5PG51bWJlcj59ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0UmVwZWF0ZWRGaWVsZCh0aGlzLCAyMikKICApOwp9OwovKioKICogQHBhcmFtIHshQXJyYXk8bnVtYmVyPn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldExpdmVJZHNMaXN0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRGaWVsZCh0aGlzLCAyMiwgdmFsdWUgfHwgW10pOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X2luZGV4CiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5hZGRMaXZlSWRzID0gZnVuY3Rpb24gKHZhbHVlLCBvcHRfaW5kZXgpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLmFkZFRvUmVwZWF0ZWRGaWVsZCh0aGlzLCAyMiwgdmFsdWUsIG9wdF9pbmRleCk7Cn07Ci8qKgogKiBDbGVhcnMgdGhlIGxpc3QgbWFraW5nIGl0IGVtcHR5IGJ1dCBub24tbnVsbC4KICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmNsZWFyTGl2ZUlkc0xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHRoaXMuc2V0TGl2ZUlkc0xpc3QoW10pOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIG9mZmxpbmVfYXQgPSAyMzsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0T2ZmbGluZUF0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDIzLCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldE9mZmxpbmVBdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMjMsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIEJsb2NrU3RhdHVzIGJsb2NrX3N0YXR1cyA9IDI0OwogKiBAcmV0dXJuIHshcHJvdG8ucGIuQmxvY2tTdGF0dXN9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRCbG9ja1N0YXR1cyA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuQmxvY2tTdGF0dXN9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAyNCwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQmxvY2tTdGF0dXN9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRCbG9ja1N0YXR1cyA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zRW51bUZpZWxkKHRoaXMsIDI0LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBzdHJpbmcgb25saW5lX2lwID0gMjU7CiAqIEByZXR1cm4ge3N0cmluZ30KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldE9ubGluZUlwID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDI1LCAiIikKICApOwp9OwovKioKICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRPbmxpbmVJcCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zU3RyaW5nRmllbGQodGhpcywgMjUsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIGZsb2F0IGxvbmdpdHVkZSA9IDI2OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRMb25naXR1ZGUgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZsb2F0aW5nUG9pbnRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDI2LCAwLjApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0TG9uZ2l0dWRlID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNGbG9hdEZpZWxkKHRoaXMsIDI2LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBmbG9hdCBsYXRpdHVkZSA9IDI3OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRMYXRpdHVkZSA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmxvYXRpbmdQb2ludEZpZWxkV2l0aERlZmF1bHQodGhpcywgMjcsIDAuMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRMYXRpdHVkZSA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zRmxvYXRGaWVsZCh0aGlzLCAyNywgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgc3RyaW5nIGNyZWF0ZV9pcCA9IDI4OwogKiBAcmV0dXJuIHtzdHJpbmd9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRDcmVhdGVJcCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAyOCwgIiIpCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0Q3JlYXRlSXAgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM1N0cmluZ0ZpZWxkKHRoaXMsIDI4LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgZGV2aWNlX2lkID0gMjk7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldERldmljZUlkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDI5LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldERldmljZUlkID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAyOSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgTmV0d29ya1R5cGUgbmV0d29ya190eXBlID0gMzA7CiAqIEByZXR1cm4geyFwcm90by5wYi5OZXR3b3JrVHlwZX0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldE5ldHdvcmtUeXBlID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUgeyFwcm90by5wYi5OZXR3b3JrVHlwZX0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDMwLCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5OZXR3b3JrVHlwZX0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldE5ldHdvcmtUeXBlID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNFbnVtRmllbGQodGhpcywgMzAsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHN0cmluZyBiYW5rX25hbWUgPSAzMTsKICogQHJldHVybiB7c3RyaW5nfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0QmFua05hbWUgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMzEsICIiKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldEJhbmtOYW1lID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNTdHJpbmdGaWVsZCh0aGlzLCAzMSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgc3RyaW5nIGFjY291bnRfbmFtZSA9IDMyOwogKiBAcmV0dXJuIHtzdHJpbmd9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRBY2NvdW50TmFtZSA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAzMiwgIiIpCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0QWNjb3VudE5hbWUgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM1N0cmluZ0ZpZWxkKHRoaXMsIDMyLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBzdHJpbmcgYmFua19hY2NvdW50ID0gMzM7CiAqIEByZXR1cm4ge3N0cmluZ30KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldEJhbmtBY2NvdW50ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDMzLCAiIikKICApOwp9OwovKioKICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRCYW5rQWNjb3VudCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zU3RyaW5nRmllbGQodGhpcywgMzMsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHN0cmluZyBlbWFpbCA9IDM0OwogKiBAcmV0dXJuIHtzdHJpbmd9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRFbWFpbCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAzNCwgIiIpCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0RW1haWwgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM1N0cmluZ0ZpZWxkKHRoaXMsIDM0LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBzdHJpbmcgbm90ZSA9IDM1OwogKiBAcmV0dXJuIHtzdHJpbmd9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXROb3RlID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDM1LCAiIikKICApOwp9OwovKioKICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXROb3RlID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNTdHJpbmdGaWVsZCh0aGlzLCAzNSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGhlYXJ0YmVhdF9hdCA9IDM2OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRIZWFydGJlYXRBdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAzNiwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRIZWFydGJlYXRBdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMzYsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHN0cmluZyBhY2Nlc3NfdG9rZW4gPSAzNzsKICogQHJldHVybiB7c3RyaW5nfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0QWNjZXNzVG9rZW4gPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMzcsICIiKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNTdHJpbmdGaWVsZCh0aGlzLCAzNywgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGFjY2Vzc19leHBpcmVfYXQgPSAzODsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0QWNjZXNzRXhwaXJlQXQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMzgsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0QWNjZXNzRXhwaXJlQXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDM4LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBzdHJpbmcgYWdvcmFfcnRtX3Rva2VuID0gMzk7CiAqIEByZXR1cm4ge3N0cmluZ30KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldEFnb3JhUnRtVG9rZW4gPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMzksICIiKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldEFnb3JhUnRtVG9rZW4gPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM1N0cmluZ0ZpZWxkKHRoaXMsIDM5LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgYWdvcmFfcnRtX2V4cGlyZV9hdCA9IDQwOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRBZ29yYVJ0bUV4cGlyZUF0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDQwLCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldEFnb3JhUnRtRXhwaXJlQXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDQwLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBzdHJpbmcgcmNfdG9rZW4gPSA0MTsKICogQHJldHVybiB7c3RyaW5nfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0UmNUb2tlbiA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA0MSwgIiIpCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0UmNUb2tlbiA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zU3RyaW5nRmllbGQodGhpcywgNDEsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiByY19leHBpcmVfYXQgPSA0MjsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0UmNFeHBpcmVBdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA0MiwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRSY0V4cGlyZUF0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCA0MiwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIHVwZGF0ZWRfYXQgPSA1MDsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0VXBkYXRlZEF0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDUwLCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLnNldFVwZGF0ZWRBdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgNTAsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBjcmVhdGVkX2F0ID0gNTE7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldENyZWF0ZWRBdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA1MSwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRDcmVhdGVkQXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDUxLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgdG95YV9pZCA9IDUyOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRUb3lhSWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgNTIsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0VG95YUlkID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCA1MiwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIHRveWFfc3luY2VkX2F0ID0gNTM7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmdldFRveWFTeW5jZWRBdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA1MywgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRUb3lhU3luY2VkQXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDUzLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBUb3lhU3RhdHVzIHRveWFfc3RhdHVzID0gNTQ7CiAqIEByZXR1cm4geyFwcm90by5wYi5Ub3lhU3RhdHVzfQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0VG95YVN0YXR1cyA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuVG95YVN0YXR1c30gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDU0LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Ub3lhU3RhdHVzfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0VG95YVN0YXR1cyA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zRW51bUZpZWxkKHRoaXMsIDU0LCB2YWx1ZSk7Cn07Ci8qKgogKiByZXBlYXRlZCBBbmNob3JQcm9maWxlIHByb2ZpbGVzID0gMTAwOwogKiBAcmV0dXJuIHshQXJyYXk8IXByb3RvLnBiLkFuY2hvclByb2ZpbGU+fQogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuZ2V0UHJvZmlsZXNMaXN0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGV7IUFycmF5PCFwcm90by5wYi5BbmNob3JQcm9maWxlPn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRSZXBlYXRlZFdyYXBwZXJGaWVsZCh0aGlzLCBwcm90by5wYi5BbmNob3JQcm9maWxlLCAxMDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7IUFycmF5PCFwcm90by5wYi5BbmNob3JQcm9maWxlPn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXR1cm5zIHRoaXMKKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuc2V0UHJvZmlsZXNMaXN0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRSZXBlYXRlZFdyYXBwZXJGaWVsZCh0aGlzLCAxMDAsIHZhbHVlKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGU9fSBvcHRfdmFsdWUKICogQHBhcmFtIHtudW1iZXI9fSBvcHRfaW5kZXgKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5hZGRQcm9maWxlcyA9IGZ1bmN0aW9uIChvcHRfdmFsdWUsIG9wdF9pbmRleCkgewogIHJldHVybiBqc3BiLk1lc3NhZ2UuYWRkVG9SZXBlYXRlZFdyYXBwZXJGaWVsZCh0aGlzLCAxMDAsIG9wdF92YWx1ZSwgcHJvdG8ucGIuQW5jaG9yUHJvZmlsZSwgb3B0X2luZGV4KTsKfTsKLyoqCiAqIENsZWFycyB0aGUgbGlzdCBtYWtpbmcgaXQgZW1wdHkgYnV0IG5vbi1udWxsLgogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JCYXNpYy5wcm90b3R5cGUuY2xlYXJQcm9maWxlc0xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHRoaXMuc2V0UHJvZmlsZXNMaXN0KFtdKTsKfTsKLyoqCiAqIHJlcGVhdGVkIEZpbGVSZWNvcmQgbGl2ZXMgPSAxMDE7CiAqIEByZXR1cm4geyFBcnJheTwhcHJvdG8ucGIuRmlsZVJlY29yZD59CiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5nZXRMaXZlc0xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZXshQXJyYXk8IXByb3RvLnBiLkZpbGVSZWNvcmQ+fSAqLwogICAganNwYi5NZXNzYWdlLmdldFJlcGVhdGVkV3JhcHBlckZpZWxkKHRoaXMsIHVzZXJ0eXBlX3BiLkZpbGVSZWNvcmQsIDEwMSkKICApOwp9OwovKioKICogQHBhcmFtIHshQXJyYXk8IXByb3RvLnBiLkZpbGVSZWNvcmQ+fSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJldHVybnMgdGhpcwoqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5zZXRMaXZlc0xpc3QgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFJlcGVhdGVkV3JhcHBlckZpZWxkKHRoaXMsIDEwMSwgdmFsdWUpOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRmlsZVJlY29yZD19IG9wdF92YWx1ZQogKiBAcGFyYW0ge251bWJlcj19IG9wdF9pbmRleAogKiBAcmV0dXJuIHshcHJvdG8ucGIuRmlsZVJlY29yZH0KICovCgoKcHJvdG8ucGIuQW5jaG9yQmFzaWMucHJvdG90eXBlLmFkZExpdmVzID0gZnVuY3Rpb24gKG9wdF92YWx1ZSwgb3B0X2luZGV4KSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5hZGRUb1JlcGVhdGVkV3JhcHBlckZpZWxkKHRoaXMsIDEwMSwgb3B0X3ZhbHVlLCBwcm90by5wYi5GaWxlUmVjb3JkLCBvcHRfaW5kZXgpOwp9OwovKioKICogQ2xlYXJzIHRoZSBsaXN0IG1ha2luZyBpdCBlbXB0eSBidXQgbm9uLW51bGwuCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvckJhc2ljLnByb3RvdHlwZS5jbGVhckxpdmVzTGlzdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy5zZXRMaXZlc0xpc3QoW10pOwp9OwovKioKICogTGlzdCBvZiByZXBlYXRlZCBmaWVsZHMgd2l0aGluIHRoaXMgbWVzc2FnZSB0eXBlLgogKiBAcHJpdmF0ZSB7IUFycmF5PG51bWJlcj59CiAqIEBjb25zdAogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnJlcGVhdGVkRmllbGRzXyA9IFsxNCwgMTgsIDE5LCAxMDAsIDEwMV07CgppZiAoanNwYi5NZXNzYWdlLkdFTkVSQVRFX1RPX09CSkVDVCkgewogIC8qKgogICAqIENyZWF0ZXMgYW4gb2JqZWN0IHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgcHJvdG8uCiAgICogRmllbGQgbmFtZXMgdGhhdCBhcmUgcmVzZXJ2ZWQgaW4gSmF2YVNjcmlwdCBhbmQgd2lsbCBiZSByZW5hbWVkIHRvIHBiX25hbWUuCiAgICogT3B0aW9uYWwgZmllbGRzIHRoYXQgYXJlIG5vdCBzZXQgd2lsbCBiZSBzZXQgdG8gdW5kZWZpbmVkLgogICAqIFRvIGFjY2VzcyBhIHJlc2VydmVkIGZpZWxkIHVzZSwgZm9vLnBiXzxuYW1lPiwgZWcsIGZvby5wYl9kZWZhdWx0LgogICAqIEZvciB0aGUgbGlzdCBvZiByZXNlcnZlZCBuYW1lcyBwbGVhc2Ugc2VlOgogICAqICAgICBuZXQvcHJvdG8yL2NvbXBpbGVyL2pzL2ludGVybmFsL2dlbmVyYXRvci5jYyNrS2V5d29yZC4KICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaW5jbHVkZUluc3RhbmNlIERlcHJlY2F0ZWQuIHdoZXRoZXIgdG8gaW5jbHVkZSB0aGUKICAgKiAgICAgSlNQQiBpbnN0YW5jZSBmb3IgdHJhbnNpdGlvbmFsIHNveSBwcm90byBzdXBwb3J0OgogICAqICAgICBodHRwOi8vZ290by9zb3ktcGFyYW0tbWlncmF0aW9uCiAgICogQHJldHVybiB7IU9iamVjdH0KICAgKi8KICBwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS50b09iamVjdCA9IGZ1bmN0aW9uIChvcHRfaW5jbHVkZUluc3RhbmNlKSB7CiAgICByZXR1cm4gcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS50b09iamVjdChvcHRfaW5jbHVkZUluc3RhbmNlLCB0aGlzKTsKICB9OwogIC8qKgogICAqIFN0YXRpYyB2ZXJzaW9uIG9mIHRoZSB7QHNlZSB0b09iamVjdH0gbWV0aG9kLgogICAqIEBwYXJhbSB7Ym9vbGVhbnx1bmRlZmluZWR9IGluY2x1ZGVJbnN0YW5jZSBEZXByZWNhdGVkLiBXaGV0aGVyIHRvIGluY2x1ZGUKICAgKiAgICAgdGhlIEpTUEIgaW5zdGFuY2UgZm9yIHRyYW5zaXRpb25hbCBzb3kgcHJvdG8gc3VwcG9ydDoKICAgKiAgICAgaHR0cDovL2dvdG8vc295LXBhcmFtLW1pZ3JhdGlvbgogICAqIEBwYXJhbSB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IG1zZyBUaGUgbXNnIGluc3RhbmNlIHRvIHRyYW5zZm9ybS4KICAgKiBAcmV0dXJuIHshT2JqZWN0fQogICAqIEBzdXBwcmVzcyB7dW51c2VkTG9jYWxWYXJpYWJsZXN9IGYgaXMgb25seSB1c2VkIGZvciBuZXN0ZWQgbWVzc2FnZXMKICAgKi8KCgogIHByb3RvLnBiLkFuY2hvclByb2ZpbGUudG9PYmplY3QgPSBmdW5jdGlvbiAoaW5jbHVkZUluc3RhbmNlLCBtc2cpIHsKICAgIHZhciBmLAogICAgICAgIG9iaiA9IHsKICAgICAgaWQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMSwgMCksCiAgICAgIGFwcElkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDIsIDApLAogICAgICBhcmVhSWQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMywgMCksCiAgICAgIGFuY2hvcklkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDQsIDApLAogICAgICBwYXJlbnRJZDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCA1LCAwKSwKICAgICAgc3RhdHVzOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDYsIDApLAogICAgICBsYW5nOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDcsICIiKSwKICAgICAgZ2VuZGVyOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDgsIDApLAogICAgICBuaWNrbmFtZToganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCA5LCAiIiksCiAgICAgIHNpZ25hdHVyZToganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAxMCwgIiIpLAogICAgICBhdmF0YXI6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMTEsICIiKSwKICAgICAgb2NjdXBhdGlvbjoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAxMiwgMCksCiAgICAgIGJpcnRoZGF5OiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDEzLCAwKSwKICAgICAgdGFnc0xpc3Q6IChmID0ganNwYi5NZXNzYWdlLmdldFJlcGVhdGVkRmllbGQobXNnLCAxNCkpID09IG51bGwgPyB1bmRlZmluZWQgOiBmLAogICAgICB2b2ljZUdyZWV0aW5nOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDE1LCAiIiksCiAgICAgIG9ubGluZVN0YXJ0OiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDE2LCAwKSwKICAgICAgb25saW5lRW5kOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDE3LCAwKSwKICAgICAgcGhvdG9JZHNMaXN0OiAoZiA9IGpzcGIuTWVzc2FnZS5nZXRSZXBlYXRlZEZpZWxkKG1zZywgMTgpKSA9PSBudWxsID8gdW5kZWZpbmVkIDogZiwKICAgICAgdmlkZW9JZHNMaXN0OiAoZiA9IGpzcGIuTWVzc2FnZS5nZXRSZXBlYXRlZEZpZWxkKG1zZywgMTkpKSA9PSBudWxsID8gdW5kZWZpbmVkIDogZiwKICAgICAgcmVqZWN0UmVhc29uOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDIwLCAiIiksCiAgICAgIHVwZGF0ZWRBdDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAzMCwgMCksCiAgICAgIGNyZWF0ZWRBdDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAzMSwgMCksCiAgICAgIHBob3Rvc0xpc3Q6IGpzcGIuTWVzc2FnZS50b09iamVjdExpc3QobXNnLmdldFBob3Rvc0xpc3QoKSwgdXNlcnR5cGVfcGIuRmlsZVJlY29yZC50b09iamVjdCwgaW5jbHVkZUluc3RhbmNlKSwKICAgICAgdmlkZW9zTGlzdDoganNwYi5NZXNzYWdlLnRvT2JqZWN0TGlzdChtc2cuZ2V0VmlkZW9zTGlzdCgpLCB1c2VydHlwZV9wYi5GaWxlUmVjb3JkLnRvT2JqZWN0LCBpbmNsdWRlSW5zdGFuY2UpLAogICAgICBpc09sZDoganNwYi5NZXNzYWdlLmdldEJvb2xlYW5GaWVsZFdpdGhEZWZhdWx0KG1zZywgMjAwLCBmYWxzZSkKICAgIH07CgogICAgaWYgKGluY2x1ZGVJbnN0YW5jZSkgewogICAgICBvYmouJGpzcGJNZXNzYWdlSW5zdGFuY2UgPSBtc2c7CiAgICB9CgogICAgcmV0dXJuIG9iajsKICB9Owp9Ci8qKgogKiBEZXNlcmlhbGl6ZXMgYmluYXJ5IGRhdGEgKGluIHByb3RvYnVmIHdpcmUgZm9ybWF0KS4KICogQHBhcmFtIHtqc3BiLkJ5dGVTb3VyY2V9IGJ5dGVzIFRoZSBieXRlcyB0byBkZXNlcmlhbGl6ZS4KICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUuZGVzZXJpYWxpemVCaW5hcnkgPSBmdW5jdGlvbiAoYnl0ZXMpIHsKICB2YXIgcmVhZGVyID0gbmV3IGpzcGIuQmluYXJ5UmVhZGVyKGJ5dGVzKTsKICB2YXIgbXNnID0gbmV3IHByb3RvLnBiLkFuY2hvclByb2ZpbGUoKTsKICByZXR1cm4gcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5kZXNlcmlhbGl6ZUJpbmFyeUZyb21SZWFkZXIobXNnLCByZWFkZXIpOwp9OwovKioKICogRGVzZXJpYWxpemVzIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlIGZvcm1hdCkgZnJvbSB0aGUKICogZ2l2ZW4gcmVhZGVyIGludG8gdGhlIGdpdmVuIG1lc3NhZ2Ugb2JqZWN0LgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSBtc2cgVGhlIG1lc3NhZ2Ugb2JqZWN0IHRvIGRlc2VyaWFsaXplIGludG8uCiAqIEBwYXJhbSB7IWpzcGIuQmluYXJ5UmVhZGVyfSByZWFkZXIgVGhlIEJpbmFyeVJlYWRlciB0byB1c2UuCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLmRlc2VyaWFsaXplQmluYXJ5RnJvbVJlYWRlciA9IGZ1bmN0aW9uIChtc2csIHJlYWRlcikgewogIHdoaWxlIChyZWFkZXIubmV4dEZpZWxkKCkpIHsKICAgIGlmIChyZWFkZXIuaXNFbmRHcm91cCgpKSB7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIHZhciBmaWVsZCA9IHJlYWRlci5nZXRGaWVsZE51bWJlcigpOwoKICAgIHN3aXRjaCAoZmllbGQpIHsKICAgICAgY2FzZSAxOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0SWQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0QXBwSWQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0QXJlYUlkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEFuY2hvcklkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldFBhcmVudElkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNjoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7IXByb3RvLnBiLlJldmlld1N0YXR1c30gKi8KICAgICAgICByZWFkZXIucmVhZEVudW0oKTsKICAgICAgICBtc2cuc2V0U3RhdHVzKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNzoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgICAgIHJlYWRlci5yZWFkU3RyaW5nKCk7CiAgICAgICAgbXNnLnNldExhbmcodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA4OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuR2VuZGVyVHlwZX0gKi8KICAgICAgICByZWFkZXIucmVhZEVudW0oKTsKICAgICAgICBtc2cuc2V0R2VuZGVyKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgOToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgICAgIHJlYWRlci5yZWFkU3RyaW5nKCk7CiAgICAgICAgbXNnLnNldE5pY2tuYW1lKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTA6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgICAgICByZWFkZXIucmVhZFN0cmluZygpOwogICAgICAgIG1zZy5zZXRTaWduYXR1cmUodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxMToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgICAgIHJlYWRlci5yZWFkU3RyaW5nKCk7CiAgICAgICAgbXNnLnNldEF2YXRhcih2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDEyOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuT2NjdXBhdGlvblR5cGV9ICovCiAgICAgICAgcmVhZGVyLnJlYWRFbnVtKCk7CiAgICAgICAgbXNnLnNldE9jY3VwYXRpb24odmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxMzoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEJpcnRoZGF5KHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTQ6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgICAgICByZWFkZXIucmVhZFN0cmluZygpOwogICAgICAgIG1zZy5hZGRUYWdzKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTU6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgICAgICByZWFkZXIucmVhZFN0cmluZygpOwogICAgICAgIG1zZy5zZXRWb2ljZUdyZWV0aW5nKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTY6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRPbmxpbmVTdGFydCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDE3OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0T25saW5lRW5kKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTg6CiAgICAgICAgdmFyIHZhbHVlcyA9CiAgICAgICAgLyoqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn0gKi8KICAgICAgICByZWFkZXIuaXNEZWxpbWl0ZWQoKSA/IHJlYWRlci5yZWFkUGFja2VkVWludDY0KCkgOiBbcmVhZGVyLnJlYWRVaW50NjQoKV07CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBtc2cuYWRkUGhvdG9JZHModmFsdWVzW2ldKTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxOToKICAgICAgICB2YXIgdmFsdWVzID0KICAgICAgICAvKiogQHR5cGUgeyFBcnJheTxudW1iZXI+fSAqLwogICAgICAgIHJlYWRlci5pc0RlbGltaXRlZCgpID8gcmVhZGVyLnJlYWRQYWNrZWRVaW50NjQoKSA6IFtyZWFkZXIucmVhZFVpbnQ2NCgpXTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIG1zZy5hZGRWaWRlb0lkcyh2YWx1ZXNbaV0pOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDIwOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICAgICAgcmVhZGVyLnJlYWRTdHJpbmcoKTsKICAgICAgICBtc2cuc2V0UmVqZWN0UmVhc29uKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzA6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRVcGRhdGVkQXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzMToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldENyZWF0ZWRBdCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDEwMDoKICAgICAgICB2YXIgdmFsdWUgPSBuZXcgdXNlcnR5cGVfcGIuRmlsZVJlY29yZCgpOwogICAgICAgIHJlYWRlci5yZWFkTWVzc2FnZSh2YWx1ZSwgdXNlcnR5cGVfcGIuRmlsZVJlY29yZC5kZXNlcmlhbGl6ZUJpbmFyeUZyb21SZWFkZXIpOwogICAgICAgIG1zZy5hZGRQaG90b3ModmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxMDE6CiAgICAgICAgdmFyIHZhbHVlID0gbmV3IHVzZXJ0eXBlX3BiLkZpbGVSZWNvcmQoKTsKICAgICAgICByZWFkZXIucmVhZE1lc3NhZ2UodmFsdWUsIHVzZXJ0eXBlX3BiLkZpbGVSZWNvcmQuZGVzZXJpYWxpemVCaW5hcnlGcm9tUmVhZGVyKTsKICAgICAgICBtc2cuYWRkVmlkZW9zKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjAwOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtib29sZWFufSAqLwogICAgICAgIHJlYWRlci5yZWFkQm9vbCgpOwogICAgICAgIG1zZy5zZXRJc09sZCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHJlYWRlci5za2lwRmllbGQoKTsKICAgICAgICBicmVhazsKICAgIH0KICB9CgogIHJldHVybiBtc2c7Cn07Ci8qKgogKiBTZXJpYWxpemVzIHRoZSBtZXNzYWdlIHRvIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlIGZvcm1hdCkuCiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5zZXJpYWxpemVCaW5hcnkgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIHdyaXRlciA9IG5ldyBqc3BiLkJpbmFyeVdyaXRlcigpOwogIHByb3RvLnBiLkFuY2hvclByb2ZpbGUuc2VyaWFsaXplQmluYXJ5VG9Xcml0ZXIodGhpcywgd3JpdGVyKTsKICByZXR1cm4gd3JpdGVyLmdldFJlc3VsdEJ1ZmZlcigpOwp9OwovKioKICogU2VyaWFsaXplcyB0aGUgZ2l2ZW4gbWVzc2FnZSB0byBiaW5hcnkgZGF0YSAoaW4gcHJvdG9idWYgd2lyZQogKiBmb3JtYXQpLCB3cml0aW5nIHRvIHRoZSBnaXZlbiBCaW5hcnlXcml0ZXIuCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IG1lc3NhZ2UKICogQHBhcmFtIHshanNwYi5CaW5hcnlXcml0ZXJ9IHdyaXRlcgogKiBAc3VwcHJlc3Mge3VudXNlZExvY2FsVmFyaWFibGVzfSBmIGlzIG9ubHkgdXNlZCBmb3IgbmVzdGVkIG1lc3NhZ2VzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUuc2VyaWFsaXplQmluYXJ5VG9Xcml0ZXIgPSBmdW5jdGlvbiAobWVzc2FnZSwgd3JpdGVyKSB7CiAgdmFyIGYgPSB1bmRlZmluZWQ7CiAgZiA9IG1lc3NhZ2UuZ2V0SWQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigxLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEFwcElkKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRBcmVhSWQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigzLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEFuY2hvcklkKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoNCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRQYXJlbnRJZCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDUsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0U3RhdHVzKCk7CgogIGlmIChmICE9PSAwLjApIHsKICAgIHdyaXRlci53cml0ZUVudW0oNiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRMYW5nKCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVN0cmluZyg3LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEdlbmRlcigpOwoKICBpZiAoZiAhPT0gMC4wKSB7CiAgICB3cml0ZXIud3JpdGVFbnVtKDgsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0Tmlja25hbWUoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlU3RyaW5nKDksIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0U2lnbmF0dXJlKCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVN0cmluZygxMCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRBdmF0YXIoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlU3RyaW5nKDExLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldE9jY3VwYXRpb24oKTsKCiAgaWYgKGYgIT09IDAuMCkgewogICAgd3JpdGVyLndyaXRlRW51bSgxMiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRCaXJ0aGRheSgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDEzLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFRhZ3NMaXN0KCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVJlcGVhdGVkU3RyaW5nKDE0LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFZvaWNlR3JlZXRpbmcoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlU3RyaW5nKDE1LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldE9ubGluZVN0YXJ0KCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMTYsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0T25saW5lRW5kKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMTcsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0UGhvdG9JZHNMaXN0KCk7CgogIGlmIChmLmxlbmd0aCA+IDApIHsKICAgIHdyaXRlci53cml0ZVBhY2tlZFVpbnQ2NCgxOCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRWaWRlb0lkc0xpc3QoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlUGFja2VkVWludDY0KDE5LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFJlamVjdFJlYXNvbigpOwoKICBpZiAoZi5sZW5ndGggPiAwKSB7CiAgICB3cml0ZXIud3JpdGVTdHJpbmcoMjAsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0VXBkYXRlZEF0KCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMzAsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0Q3JlYXRlZEF0KCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMzEsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0UGhvdG9zTGlzdCgpOwoKICBpZiAoZi5sZW5ndGggPiAwKSB7CiAgICB3cml0ZXIud3JpdGVSZXBlYXRlZE1lc3NhZ2UoMTAwLCBmLCB1c2VydHlwZV9wYi5GaWxlUmVjb3JkLnNlcmlhbGl6ZUJpbmFyeVRvV3JpdGVyKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFZpZGVvc0xpc3QoKTsKCiAgaWYgKGYubGVuZ3RoID4gMCkgewogICAgd3JpdGVyLndyaXRlUmVwZWF0ZWRNZXNzYWdlKDEwMSwgZiwgdXNlcnR5cGVfcGIuRmlsZVJlY29yZC5zZXJpYWxpemVCaW5hcnlUb1dyaXRlcik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRJc09sZCgpOwoKICBpZiAoZikgewogICAgd3JpdGVyLndyaXRlQm9vbCgyMDAsIGYpOwogIH0KfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBpZCA9IDE7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuZ2V0SWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMSwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0SWQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDEsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBhcHBfaWQgPSAyOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldEFwcElkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDIsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldEFwcElkID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAyLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgYXJlYV9pZCA9IDM7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuZ2V0QXJlYUlkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDMsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldEFyZWFJZCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMywgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGFuY2hvcl9pZCA9IDQ7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuZ2V0QW5jaG9ySWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgNCwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0QW5jaG9ySWQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDQsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBwYXJlbnRfaWQgPSA1OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldFBhcmVudElkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDUsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldFBhcmVudElkID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCA1LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBSZXZpZXdTdGF0dXMgc3RhdHVzID0gNjsKICogQHJldHVybiB7IXByb3RvLnBiLlJldmlld1N0YXR1c30KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuZ2V0U3RhdHVzID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUgeyFwcm90by5wYi5SZXZpZXdTdGF0dXN9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA2LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5SZXZpZXdTdGF0dXN9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0U3RhdHVzID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNFbnVtRmllbGQodGhpcywgNiwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgc3RyaW5nIGxhbmcgPSA3OwogKiBAcmV0dXJuIHtzdHJpbmd9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldExhbmcgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgNywgIiIpCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldExhbmcgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM1N0cmluZ0ZpZWxkKHRoaXMsIDcsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIEdlbmRlclR5cGUgZ2VuZGVyID0gODsKICogQHJldHVybiB7IXByb3RvLnBiLkdlbmRlclR5cGV9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldEdlbmRlciA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHshcHJvdG8ucGIuR2VuZGVyVHlwZX0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDgsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkdlbmRlclR5cGV9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0R2VuZGVyID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNFbnVtRmllbGQodGhpcywgOCwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgc3RyaW5nIG5pY2tuYW1lID0gOTsKICogQHJldHVybiB7c3RyaW5nfQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5nZXROaWNrbmFtZSA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA5LCAiIikKICApOwp9OwovKioKICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0Tmlja25hbWUgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM1N0cmluZ0ZpZWxkKHRoaXMsIDksIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHN0cmluZyBzaWduYXR1cmUgPSAxMDsKICogQHJldHVybiB7c3RyaW5nfQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5nZXRTaWduYXR1cmUgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTAsICIiKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5zZXRTaWduYXR1cmUgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM1N0cmluZ0ZpZWxkKHRoaXMsIDEwLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCBzdHJpbmcgYXZhdGFyID0gMTE7CiAqIEByZXR1cm4ge3N0cmluZ30KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuZ2V0QXZhdGFyID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDExLCAiIikKICApOwp9OwovKioKICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0QXZhdGFyID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNTdHJpbmdGaWVsZCh0aGlzLCAxMSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgT2NjdXBhdGlvblR5cGUgb2NjdXBhdGlvbiA9IDEyOwogKiBAcmV0dXJuIHshcHJvdG8ucGIuT2NjdXBhdGlvblR5cGV9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldE9jY3VwYXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7IXByb3RvLnBiLk9jY3VwYXRpb25UeXBlfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTIsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLk9jY3VwYXRpb25UeXBlfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldE9jY3VwYXRpb24gPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0VudW1GaWVsZCh0aGlzLCAxMiwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGJpcnRoZGF5ID0gMTM7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuZ2V0QmlydGhkYXkgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTMsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldEJpcnRoZGF5ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAxMywgdmFsdWUpOwp9OwovKioKICogcmVwZWF0ZWQgc3RyaW5nIHRhZ3MgPSAxNDsKICogQHJldHVybiB7IUFycmF5PHN0cmluZz59CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldFRhZ3NMaXN0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUgeyFBcnJheTxzdHJpbmc+fSAqLwogICAganNwYi5NZXNzYWdlLmdldFJlcGVhdGVkRmllbGQodGhpcywgMTQpCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0VGFnc0xpc3QgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldEZpZWxkKHRoaXMsIDE0LCB2YWx1ZSB8fCBbXSk7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUKICogQHBhcmFtIHtudW1iZXI9fSBvcHRfaW5kZXgKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5hZGRUYWdzID0gZnVuY3Rpb24gKHZhbHVlLCBvcHRfaW5kZXgpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLmFkZFRvUmVwZWF0ZWRGaWVsZCh0aGlzLCAxNCwgdmFsdWUsIG9wdF9pbmRleCk7Cn07Ci8qKgogKiBDbGVhcnMgdGhlIGxpc3QgbWFraW5nIGl0IGVtcHR5IGJ1dCBub24tbnVsbC4KICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5jbGVhclRhZ3NMaXN0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzLnNldFRhZ3NMaXN0KFtdKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHN0cmluZyB2b2ljZV9ncmVldGluZyA9IDE1OwogKiBAcmV0dXJuIHtzdHJpbmd9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldFZvaWNlR3JlZXRpbmcgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTUsICIiKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5zZXRWb2ljZUdyZWV0aW5nID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNTdHJpbmdGaWVsZCh0aGlzLCAxNSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIG9ubGluZV9zdGFydCA9IDE2OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldE9ubGluZVN0YXJ0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDE2LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5zZXRPbmxpbmVTdGFydCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMTYsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBvbmxpbmVfZW5kID0gMTc7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuZ2V0T25saW5lRW5kID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDE3LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5zZXRPbmxpbmVFbmQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDE3LCB2YWx1ZSk7Cn07Ci8qKgogKiByZXBlYXRlZCB1aW50NjQgcGhvdG9faWRzID0gMTg7CiAqIEByZXR1cm4geyFBcnJheTxudW1iZXI+fQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5nZXRQaG90b0lkc0xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7IUFycmF5PG51bWJlcj59ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0UmVwZWF0ZWRGaWVsZCh0aGlzLCAxOCkKICApOwp9OwovKioKICogQHBhcmFtIHshQXJyYXk8bnVtYmVyPn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5zZXRQaG90b0lkc0xpc3QgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldEZpZWxkKHRoaXMsIDE4LCB2YWx1ZSB8fCBbXSk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHBhcmFtIHtudW1iZXI9fSBvcHRfaW5kZXgKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5hZGRQaG90b0lkcyA9IGZ1bmN0aW9uICh2YWx1ZSwgb3B0X2luZGV4KSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5hZGRUb1JlcGVhdGVkRmllbGQodGhpcywgMTgsIHZhbHVlLCBvcHRfaW5kZXgpOwp9OwovKioKICogQ2xlYXJzIHRoZSBsaXN0IG1ha2luZyBpdCBlbXB0eSBidXQgbm9uLW51bGwuCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuY2xlYXJQaG90b0lkc0xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHRoaXMuc2V0UGhvdG9JZHNMaXN0KFtdKTsKfTsKLyoqCiAqIHJlcGVhdGVkIHVpbnQ2NCB2aWRlb19pZHMgPSAxOTsKICogQHJldHVybiB7IUFycmF5PG51bWJlcj59CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldFZpZGVvSWRzTGlzdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRSZXBlYXRlZEZpZWxkKHRoaXMsIDE5KQogICk7Cn07Ci8qKgogKiBAcGFyYW0geyFBcnJheTxudW1iZXI+fSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldFZpZGVvSWRzTGlzdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0RmllbGQodGhpcywgMTksIHZhbHVlIHx8IFtdKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcGFyYW0ge251bWJlcj19IG9wdF9pbmRleAogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmFkZFZpZGVvSWRzID0gZnVuY3Rpb24gKHZhbHVlLCBvcHRfaW5kZXgpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLmFkZFRvUmVwZWF0ZWRGaWVsZCh0aGlzLCAxOSwgdmFsdWUsIG9wdF9pbmRleCk7Cn07Ci8qKgogKiBDbGVhcnMgdGhlIGxpc3QgbWFraW5nIGl0IGVtcHR5IGJ1dCBub24tbnVsbC4KICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5jbGVhclZpZGVvSWRzTGlzdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy5zZXRWaWRlb0lkc0xpc3QoW10pOwp9OwovKioKICogb3B0aW9uYWwgc3RyaW5nIHJlamVjdF9yZWFzb24gPSAyMDsKICogQHJldHVybiB7c3RyaW5nfQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5nZXRSZWplY3RSZWFzb24gPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMjAsICIiKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5zZXRSZWplY3RSZWFzb24gPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM1N0cmluZ0ZpZWxkKHRoaXMsIDIwLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgdXBkYXRlZF9hdCA9IDMwOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldFVwZGF0ZWRBdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAzMCwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0VXBkYXRlZEF0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAzMCwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGNyZWF0ZWRfYXQgPSAzMTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5nZXRDcmVhdGVkQXQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMzEsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldENyZWF0ZWRBdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMzEsIHZhbHVlKTsKfTsKLyoqCiAqIHJlcGVhdGVkIEZpbGVSZWNvcmQgcGhvdG9zID0gMTAwOwogKiBAcmV0dXJuIHshQXJyYXk8IXByb3RvLnBiLkZpbGVSZWNvcmQ+fQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5nZXRQaG90b3NMaXN0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGV7IUFycmF5PCFwcm90by5wYi5GaWxlUmVjb3JkPn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRSZXBlYXRlZFdyYXBwZXJGaWVsZCh0aGlzLCB1c2VydHlwZV9wYi5GaWxlUmVjb3JkLCAxMDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7IUFycmF5PCFwcm90by5wYi5GaWxlUmVjb3JkPn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwoqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLnNldFBob3Rvc0xpc3QgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFJlcGVhdGVkV3JhcHBlckZpZWxkKHRoaXMsIDEwMCwgdmFsdWUpOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRmlsZVJlY29yZD19IG9wdF92YWx1ZQogKiBAcGFyYW0ge251bWJlcj19IG9wdF9pbmRleAogKiBAcmV0dXJuIHshcHJvdG8ucGIuRmlsZVJlY29yZH0KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuYWRkUGhvdG9zID0gZnVuY3Rpb24gKG9wdF92YWx1ZSwgb3B0X2luZGV4KSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5hZGRUb1JlcGVhdGVkV3JhcHBlckZpZWxkKHRoaXMsIDEwMCwgb3B0X3ZhbHVlLCBwcm90by5wYi5GaWxlUmVjb3JkLCBvcHRfaW5kZXgpOwp9OwovKioKICogQ2xlYXJzIHRoZSBsaXN0IG1ha2luZyBpdCBlbXB0eSBidXQgbm9uLW51bGwuCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuY2xlYXJQaG90b3NMaXN0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzLnNldFBob3Rvc0xpc3QoW10pOwp9OwovKioKICogcmVwZWF0ZWQgRmlsZVJlY29yZCB2aWRlb3MgPSAxMDE7CiAqIEByZXR1cm4geyFBcnJheTwhcHJvdG8ucGIuRmlsZVJlY29yZD59CiAqLwoKCnByb3RvLnBiLkFuY2hvclByb2ZpbGUucHJvdG90eXBlLmdldFZpZGVvc0xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZXshQXJyYXk8IXByb3RvLnBiLkZpbGVSZWNvcmQ+fSAqLwogICAganNwYi5NZXNzYWdlLmdldFJlcGVhdGVkV3JhcHBlckZpZWxkKHRoaXMsIHVzZXJ0eXBlX3BiLkZpbGVSZWNvcmQsIDEwMSkKICApOwp9OwovKioKICogQHBhcmFtIHshQXJyYXk8IXByb3RvLnBiLkZpbGVSZWNvcmQ+fSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmV0dXJucyB0aGlzCiovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0VmlkZW9zTGlzdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UmVwZWF0ZWRXcmFwcGVyRmllbGQodGhpcywgMTAxLCB2YWx1ZSk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5GaWxlUmVjb3JkPX0gb3B0X3ZhbHVlCiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X2luZGV4CiAqIEByZXR1cm4geyFwcm90by5wYi5GaWxlUmVjb3JkfQogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5hZGRWaWRlb3MgPSBmdW5jdGlvbiAob3B0X3ZhbHVlLCBvcHRfaW5kZXgpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLmFkZFRvUmVwZWF0ZWRXcmFwcGVyRmllbGQodGhpcywgMTAxLCBvcHRfdmFsdWUsIHByb3RvLnBiLkZpbGVSZWNvcmQsIG9wdF9pbmRleCk7Cn07Ci8qKgogKiBDbGVhcnMgdGhlIGxpc3QgbWFraW5nIGl0IGVtcHR5IGJ1dCBub24tbnVsbC4KICogQHJldHVybiB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5BbmNob3JQcm9maWxlLnByb3RvdHlwZS5jbGVhclZpZGVvc0xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHRoaXMuc2V0VmlkZW9zTGlzdChbXSk7Cn07Ci8qKgogKiBvcHRpb25hbCBib29sIGlzX29sZCA9IDIwMDsKICogQHJldHVybiB7Ym9vbGVhbn0KICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuZ2V0SXNPbGQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRCb29sZWFuRmllbGRXaXRoRGVmYXVsdCh0aGlzLCAyMDAsIGZhbHNlKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge2Jvb2xlYW59IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuQW5jaG9yUHJvZmlsZS5wcm90b3R5cGUuc2V0SXNPbGQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0Jvb2xlYW5GaWVsZCh0aGlzLCAyMDAsIHZhbHVlKTsKfTsKCmlmIChqc3BiLk1lc3NhZ2UuR0VORVJBVEVfVE9fT0JKRUNUKSB7CiAgLyoqCiAgICogQ3JlYXRlcyBhbiBvYmplY3QgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBwcm90by4KICAgKiBGaWVsZCBuYW1lcyB0aGF0IGFyZSByZXNlcnZlZCBpbiBKYXZhU2NyaXB0IGFuZCB3aWxsIGJlIHJlbmFtZWQgdG8gcGJfbmFtZS4KICAgKiBPcHRpb25hbCBmaWVsZHMgdGhhdCBhcmUgbm90IHNldCB3aWxsIGJlIHNldCB0byB1bmRlZmluZWQuCiAgICogVG8gYWNjZXNzIGEgcmVzZXJ2ZWQgZmllbGQgdXNlLCBmb28ucGJfPG5hbWU+LCBlZywgZm9vLnBiX2RlZmF1bHQuCiAgICogRm9yIHRoZSBsaXN0IG9mIHJlc2VydmVkIG5hbWVzIHBsZWFzZSBzZWU6CiAgICogICAgIG5ldC9wcm90bzIvY29tcGlsZXIvanMvaW50ZXJuYWwvZ2VuZXJhdG9yLmNjI2tLZXl3b3JkLgogICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbmNsdWRlSW5zdGFuY2UgRGVwcmVjYXRlZC4gd2hldGhlciB0byBpbmNsdWRlIHRoZQogICAqICAgICBKU1BCIGluc3RhbmNlIGZvciB0cmFuc2l0aW9uYWwgc295IHByb3RvIHN1cHBvcnQ6CiAgICogICAgIGh0dHA6Ly9nb3RvL3NveS1wYXJhbS1taWdyYXRpb24KICAgKiBAcmV0dXJuIHshT2JqZWN0fQogICAqLwogIHByb3RvLnBiLk9ubGluZVJlY29yZC5wcm90b3R5cGUudG9PYmplY3QgPSBmdW5jdGlvbiAob3B0X2luY2x1ZGVJbnN0YW5jZSkgewogICAgcmV0dXJuIHByb3RvLnBiLk9ubGluZVJlY29yZC50b09iamVjdChvcHRfaW5jbHVkZUluc3RhbmNlLCB0aGlzKTsKICB9OwogIC8qKgogICAqIFN0YXRpYyB2ZXJzaW9uIG9mIHRoZSB7QHNlZSB0b09iamVjdH0gbWV0aG9kLgogICAqIEBwYXJhbSB7Ym9vbGVhbnx1bmRlZmluZWR9IGluY2x1ZGVJbnN0YW5jZSBEZXByZWNhdGVkLiBXaGV0aGVyIHRvIGluY2x1ZGUKICAgKiAgICAgdGhlIEpTUEIgaW5zdGFuY2UgZm9yIHRyYW5zaXRpb25hbCBzb3kgcHJvdG8gc3VwcG9ydDoKICAgKiAgICAgaHR0cDovL2dvdG8vc295LXBhcmFtLW1pZ3JhdGlvbgogICAqIEBwYXJhbSB7IXByb3RvLnBiLk9ubGluZVJlY29yZH0gbXNnIFRoZSBtc2cgaW5zdGFuY2UgdG8gdHJhbnNmb3JtLgogICAqIEByZXR1cm4geyFPYmplY3R9CiAgICogQHN1cHByZXNzIHt1bnVzZWRMb2NhbFZhcmlhYmxlc30gZiBpcyBvbmx5IHVzZWQgZm9yIG5lc3RlZCBtZXNzYWdlcwogICAqLwoKCiAgcHJvdG8ucGIuT25saW5lUmVjb3JkLnRvT2JqZWN0ID0gZnVuY3Rpb24gKGluY2x1ZGVJbnN0YW5jZSwgbXNnKSB7CiAgICB2YXIgZiwKICAgICAgICBvYmogPSB7CiAgICAgIGlkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDEsIDApLAogICAgICBhcmVhSWQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMiwgMCksCiAgICAgIGFuY2hvcklkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDMsIDApLAogICAgICBvbmxpbmVBdDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCA0LCAwKSwKICAgICAgZHVyYXRpb246IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNSwgMCksCiAgICAgIG9mZmxpbmVBdDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCA2LCAwKSwKICAgICAgb25saW5lSXA6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNywgIiIpLAogICAgICB1cGRhdGVkQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMjAsIDApLAogICAgICBjcmVhdGVkQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMjEsIDApCiAgICB9OwoKICAgIGlmIChpbmNsdWRlSW5zdGFuY2UpIHsKICAgICAgb2JqLiRqc3BiTWVzc2FnZUluc3RhbmNlID0gbXNnOwogICAgfQoKICAgIHJldHVybiBvYmo7CiAgfTsKfQovKioKICogRGVzZXJpYWxpemVzIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlIGZvcm1hdCkuCiAqIEBwYXJhbSB7anNwYi5CeXRlU291cmNlfSBieXRlcyBUaGUgYnl0ZXMgdG8gZGVzZXJpYWxpemUuCiAqIEByZXR1cm4geyFwcm90by5wYi5PbmxpbmVSZWNvcmR9CiAqLwoKCnByb3RvLnBiLk9ubGluZVJlY29yZC5kZXNlcmlhbGl6ZUJpbmFyeSA9IGZ1bmN0aW9uIChieXRlcykgewogIHZhciByZWFkZXIgPSBuZXcganNwYi5CaW5hcnlSZWFkZXIoYnl0ZXMpOwogIHZhciBtc2cgPSBuZXcgcHJvdG8ucGIuT25saW5lUmVjb3JkKCk7CiAgcmV0dXJuIHByb3RvLnBiLk9ubGluZVJlY29yZC5kZXNlcmlhbGl6ZUJpbmFyeUZyb21SZWFkZXIobXNnLCByZWFkZXIpOwp9OwovKioKICogRGVzZXJpYWxpemVzIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlIGZvcm1hdCkgZnJvbSB0aGUKICogZ2l2ZW4gcmVhZGVyIGludG8gdGhlIGdpdmVuIG1lc3NhZ2Ugb2JqZWN0LgogKiBAcGFyYW0geyFwcm90by5wYi5PbmxpbmVSZWNvcmR9IG1zZyBUaGUgbWVzc2FnZSBvYmplY3QgdG8gZGVzZXJpYWxpemUgaW50by4KICogQHBhcmFtIHshanNwYi5CaW5hcnlSZWFkZXJ9IHJlYWRlciBUaGUgQmluYXJ5UmVhZGVyIHRvIHVzZS4KICogQHJldHVybiB7IXByb3RvLnBiLk9ubGluZVJlY29yZH0KICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLmRlc2VyaWFsaXplQmluYXJ5RnJvbVJlYWRlciA9IGZ1bmN0aW9uIChtc2csIHJlYWRlcikgewogIHdoaWxlIChyZWFkZXIubmV4dEZpZWxkKCkpIHsKICAgIGlmIChyZWFkZXIuaXNFbmRHcm91cCgpKSB7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIHZhciBmaWVsZCA9IHJlYWRlci5nZXRGaWVsZE51bWJlcigpOwoKICAgIHN3aXRjaCAoZmllbGQpIHsKICAgICAgY2FzZSAxOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50NjQoKTsKICAgICAgICBtc2cuc2V0SWQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0QXJlYUlkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEFuY2hvcklkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldE9ubGluZUF0KHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldER1cmF0aW9uKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNjoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldE9mZmxpbmVBdCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDc6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8KICAgICAgICByZWFkZXIucmVhZFN0cmluZygpOwogICAgICAgIG1zZy5zZXRPbmxpbmVJcCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDIwOgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0VXBkYXRlZEF0KHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjE6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRDcmVhdGVkQXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICByZWFkZXIuc2tpcEZpZWxkKCk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICByZXR1cm4gbXNnOwp9OwovKioKICogU2VyaWFsaXplcyB0aGUgbWVzc2FnZSB0byBiaW5hcnkgZGF0YSAoaW4gcHJvdG9idWYgd2lyZSBmb3JtYXQpLgogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5zZXJpYWxpemVCaW5hcnkgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIHdyaXRlciA9IG5ldyBqc3BiLkJpbmFyeVdyaXRlcigpOwogIHByb3RvLnBiLk9ubGluZVJlY29yZC5zZXJpYWxpemVCaW5hcnlUb1dyaXRlcih0aGlzLCB3cml0ZXIpOwogIHJldHVybiB3cml0ZXIuZ2V0UmVzdWx0QnVmZmVyKCk7Cn07Ci8qKgogKiBTZXJpYWxpemVzIHRoZSBnaXZlbiBtZXNzYWdlIHRvIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlCiAqIGZvcm1hdCksIHdyaXRpbmcgdG8gdGhlIGdpdmVuIEJpbmFyeVdyaXRlci4KICogQHBhcmFtIHshcHJvdG8ucGIuT25saW5lUmVjb3JkfSBtZXNzYWdlCiAqIEBwYXJhbSB7IWpzcGIuQmluYXJ5V3JpdGVyfSB3cml0ZXIKICogQHN1cHByZXNzIHt1bnVzZWRMb2NhbFZhcmlhYmxlc30gZiBpcyBvbmx5IHVzZWQgZm9yIG5lc3RlZCBtZXNzYWdlcwogKi8KCgpwcm90by5wYi5PbmxpbmVSZWNvcmQuc2VyaWFsaXplQmluYXJ5VG9Xcml0ZXIgPSBmdW5jdGlvbiAobWVzc2FnZSwgd3JpdGVyKSB7CiAgdmFyIGYgPSB1bmRlZmluZWQ7CiAgZiA9IG1lc3NhZ2UuZ2V0SWQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQ2NCgxLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEFyZWFJZCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDIsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0QW5jaG9ySWQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigzLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldE9ubGluZUF0KCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoNCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXREdXJhdGlvbigpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDUsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0T2ZmbGluZUF0KCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoNiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRPbmxpbmVJcCgpOwoKICBpZiAoZi5sZW5ndGggPiAwKSB7CiAgICB3cml0ZXIud3JpdGVTdHJpbmcoNywgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRVcGRhdGVkQXQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigyMCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRDcmVhdGVkQXQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigyMSwgZik7CiAgfQp9OwovKioKICogb3B0aW9uYWwgdWludDY0IGlkID0gMTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5PbmxpbmVSZWNvcmQucHJvdG90eXBlLmdldElkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDEsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuT25saW5lUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5zZXRJZCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGFyZWFfaWQgPSAyOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLk9ubGluZVJlY29yZC5wcm90b3R5cGUuZ2V0QXJlYUlkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDIsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuT25saW5lUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5zZXRBcmVhSWQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDIsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBhbmNob3JfaWQgPSAzOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLk9ubGluZVJlY29yZC5wcm90b3R5cGUuZ2V0QW5jaG9ySWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMywgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5PbmxpbmVSZWNvcmR9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5PbmxpbmVSZWNvcmQucHJvdG90eXBlLnNldEFuY2hvcklkID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAzLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgb25saW5lX2F0ID0gNDsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5PbmxpbmVSZWNvcmQucHJvdG90eXBlLmdldE9ubGluZUF0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDQsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuT25saW5lUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5zZXRPbmxpbmVBdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgNCwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGR1cmF0aW9uID0gNTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5PbmxpbmVSZWNvcmQucHJvdG90eXBlLmdldER1cmF0aW9uID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDUsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuT25saW5lUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5zZXREdXJhdGlvbiA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgNSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIG9mZmxpbmVfYXQgPSA2OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLk9ubGluZVJlY29yZC5wcm90b3R5cGUuZ2V0T2ZmbGluZUF0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDYsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuT25saW5lUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5zZXRPZmZsaW5lQXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDYsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHN0cmluZyBvbmxpbmVfaXAgPSA3OwogKiBAcmV0dXJuIHtzdHJpbmd9CiAqLwoKCnByb3RvLnBiLk9ubGluZVJlY29yZC5wcm90b3R5cGUuZ2V0T25saW5lSXAgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgNywgIiIpCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuT25saW5lUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5zZXRPbmxpbmVJcCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zU3RyaW5nRmllbGQodGhpcywgNywgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIHVwZGF0ZWRfYXQgPSAyMDsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5PbmxpbmVSZWNvcmQucHJvdG90eXBlLmdldFVwZGF0ZWRBdCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAyMCwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5PbmxpbmVSZWNvcmR9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5PbmxpbmVSZWNvcmQucHJvdG90eXBlLnNldFVwZGF0ZWRBdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMjAsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBjcmVhdGVkX2F0ID0gMjE7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5nZXRDcmVhdGVkQXQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMjEsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuT25saW5lUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuT25saW5lUmVjb3JkLnByb3RvdHlwZS5zZXRDcmVhdGVkQXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDIxLCB2YWx1ZSk7Cn07CgppZiAoanNwYi5NZXNzYWdlLkdFTkVSQVRFX1RPX09CSkVDVCkgewogIC8qKgogICAqIENyZWF0ZXMgYW4gb2JqZWN0IHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgcHJvdG8uCiAgICogRmllbGQgbmFtZXMgdGhhdCBhcmUgcmVzZXJ2ZWQgaW4gSmF2YVNjcmlwdCBhbmQgd2lsbCBiZSByZW5hbWVkIHRvIHBiX25hbWUuCiAgICogT3B0aW9uYWwgZmllbGRzIHRoYXQgYXJlIG5vdCBzZXQgd2lsbCBiZSBzZXQgdG8gdW5kZWZpbmVkLgogICAqIFRvIGFjY2VzcyBhIHJlc2VydmVkIGZpZWxkIHVzZSwgZm9vLnBiXzxuYW1lPiwgZWcsIGZvby5wYl9kZWZhdWx0LgogICAqIEZvciB0aGUgbGlzdCBvZiByZXNlcnZlZCBuYW1lcyBwbGVhc2Ugc2VlOgogICAqICAgICBuZXQvcHJvdG8yL2NvbXBpbGVyL2pzL2ludGVybmFsL2dlbmVyYXRvci5jYyNrS2V5d29yZC4KICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaW5jbHVkZUluc3RhbmNlIERlcHJlY2F0ZWQuIHdoZXRoZXIgdG8gaW5jbHVkZSB0aGUKICAgKiAgICAgSlNQQiBpbnN0YW5jZSBmb3IgdHJhbnNpdGlvbmFsIHNveSBwcm90byBzdXBwb3J0OgogICAqICAgICBodHRwOi8vZ290by9zb3ktcGFyYW0tbWlncmF0aW9uCiAgICogQHJldHVybiB7IU9iamVjdH0KICAgKi8KICBwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLnRvT2JqZWN0ID0gZnVuY3Rpb24gKG9wdF9pbmNsdWRlSW5zdGFuY2UpIHsKICAgIHJldHVybiBwcm90by5wYi5TZXR0bGVSZWNvcmQudG9PYmplY3Qob3B0X2luY2x1ZGVJbnN0YW5jZSwgdGhpcyk7CiAgfTsKICAvKioKICAgKiBTdGF0aWMgdmVyc2lvbiBvZiB0aGUge0BzZWUgdG9PYmplY3R9IG1ldGhvZC4KICAgKiBAcGFyYW0ge2Jvb2xlYW58dW5kZWZpbmVkfSBpbmNsdWRlSW5zdGFuY2UgRGVwcmVjYXRlZC4gV2hldGhlciB0byBpbmNsdWRlCiAgICogICAgIHRoZSBKU1BCIGluc3RhbmNlIGZvciB0cmFuc2l0aW9uYWwgc295IHByb3RvIHN1cHBvcnQ6CiAgICogICAgIGh0dHA6Ly9nb3RvL3NveS1wYXJhbS1taWdyYXRpb24KICAgKiBAcGFyYW0geyFwcm90by5wYi5TZXR0bGVSZWNvcmR9IG1zZyBUaGUgbXNnIGluc3RhbmNlIHRvIHRyYW5zZm9ybS4KICAgKiBAcmV0dXJuIHshT2JqZWN0fQogICAqIEBzdXBwcmVzcyB7dW51c2VkTG9jYWxWYXJpYWJsZXN9IGYgaXMgb25seSB1c2VkIGZvciBuZXN0ZWQgbWVzc2FnZXMKICAgKi8KCgogIHByb3RvLnBiLlNldHRsZVJlY29yZC50b09iamVjdCA9IGZ1bmN0aW9uIChpbmNsdWRlSW5zdGFuY2UsIG1zZykgewogICAgdmFyIGYsCiAgICAgICAgb2JqID0gewogICAgICBpZDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAxLCAwKSwKICAgICAgYXJlYUlkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDIsIDApLAogICAgICBndWlsZElkOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDMsIDApLAogICAgICBhbmNob3JJZDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCA0LCAwKSwKICAgICAgc3RhcnRBdDoganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCA1LCAwKSwKICAgICAgZW5kQXQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNiwgMCksCiAgICAgIGNhbGxJbmNvbWU6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgNywgMCksCiAgICAgIGdpZnRJbmNvbWU6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgOCwgMCksCiAgICAgIGNvbW1pc3Npb25JbmNvbWU6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgOSwgMCksCiAgICAgIGJvbnVzSW5jb21lOiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDEwLCAwKSwKICAgICAgcGVuYWx0eToganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQobXNnLCAxMSwgMCksCiAgICAgIHNldHRsZWQ6IGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KG1zZywgMTIsIDApLAogICAgICByb2xsYmFjazoganNwYi5NZXNzYWdlLmdldEJvb2xlYW5GaWVsZFdpdGhEZWZhdWx0KG1zZywgMTMsIGZhbHNlKSwKICAgICAgdXBkYXRlZEF0OiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDIwLCAwKSwKICAgICAgY3JlYXRlZEF0OiBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdChtc2csIDIxLCAwKQogICAgfTsKCiAgICBpZiAoaW5jbHVkZUluc3RhbmNlKSB7CiAgICAgIG9iai4kanNwYk1lc3NhZ2VJbnN0YW5jZSA9IG1zZzsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH07Cn0KLyoqCiAqIERlc2VyaWFsaXplcyBiaW5hcnkgZGF0YSAoaW4gcHJvdG9idWYgd2lyZSBmb3JtYXQpLgogKiBAcGFyYW0ge2pzcGIuQnl0ZVNvdXJjZX0gYnl0ZXMgVGhlIGJ5dGVzIHRvIGRlc2VyaWFsaXplLgogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQuZGVzZXJpYWxpemVCaW5hcnkgPSBmdW5jdGlvbiAoYnl0ZXMpIHsKICB2YXIgcmVhZGVyID0gbmV3IGpzcGIuQmluYXJ5UmVhZGVyKGJ5dGVzKTsKICB2YXIgbXNnID0gbmV3IHByb3RvLnBiLlNldHRsZVJlY29yZCgpOwogIHJldHVybiBwcm90by5wYi5TZXR0bGVSZWNvcmQuZGVzZXJpYWxpemVCaW5hcnlGcm9tUmVhZGVyKG1zZywgcmVhZGVyKTsKfTsKLyoqCiAqIERlc2VyaWFsaXplcyBiaW5hcnkgZGF0YSAoaW4gcHJvdG9idWYgd2lyZSBmb3JtYXQpIGZyb20gdGhlCiAqIGdpdmVuIHJlYWRlciBpbnRvIHRoZSBnaXZlbiBtZXNzYWdlIG9iamVjdC4KICogQHBhcmFtIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSBtc2cgVGhlIG1lc3NhZ2Ugb2JqZWN0IHRvIGRlc2VyaWFsaXplIGludG8uCiAqIEBwYXJhbSB7IWpzcGIuQmluYXJ5UmVhZGVyfSByZWFkZXIgVGhlIEJpbmFyeVJlYWRlciB0byB1c2UuCiAqIEByZXR1cm4geyFwcm90by5wYi5TZXR0bGVSZWNvcmR9CiAqLwoKCnByb3RvLnBiLlNldHRsZVJlY29yZC5kZXNlcmlhbGl6ZUJpbmFyeUZyb21SZWFkZXIgPSBmdW5jdGlvbiAobXNnLCByZWFkZXIpIHsKICB3aGlsZSAocmVhZGVyLm5leHRGaWVsZCgpKSB7CiAgICBpZiAocmVhZGVyLmlzRW5kR3JvdXAoKSkgewogICAgICBicmVhazsKICAgIH0KCiAgICB2YXIgZmllbGQgPSByZWFkZXIuZ2V0RmllbGROdW1iZXIoKTsKCiAgICBzd2l0Y2ggKGZpZWxkKSB7CiAgICAgIGNhc2UgMToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDY0KCk7CiAgICAgICAgbXNnLnNldElkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEFyZWFJZCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDM6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRHdWlsZElkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEFuY2hvcklkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldFN0YXJ0QXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA2OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0RW5kQXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA3OgogICAgICAgIHZhciB2YWx1ZSA9CiAgICAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICAgICAgcmVhZGVyLnJlYWRVaW50MzIoKTsKICAgICAgICBtc2cuc2V0Q2FsbEluY29tZSh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDg6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRHaWZ0SW5jb21lKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgOToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldENvbW1pc3Npb25JbmNvbWUodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxMDoKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldEJvbnVzSW5jb21lKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTE6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRQZW5hbHR5KHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTI6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRTZXR0bGVkKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTM6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge2Jvb2xlYW59ICovCiAgICAgICAgcmVhZGVyLnJlYWRCb29sKCk7CiAgICAgICAgbXNnLnNldFJvbGxiYWNrKHZhbHVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjA6CiAgICAgICAgdmFyIHZhbHVlID0KICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgICAgICByZWFkZXIucmVhZFVpbnQzMigpOwogICAgICAgIG1zZy5zZXRVcGRhdGVkQXQodmFsdWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyMToKICAgICAgICB2YXIgdmFsdWUgPQogICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAgICAgIHJlYWRlci5yZWFkVWludDMyKCk7CiAgICAgICAgbXNnLnNldENyZWF0ZWRBdCh2YWx1ZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHJlYWRlci5za2lwRmllbGQoKTsKICAgICAgICBicmVhazsKICAgIH0KICB9CgogIHJldHVybiBtc2c7Cn07Ci8qKgogKiBTZXJpYWxpemVzIHRoZSBtZXNzYWdlIHRvIGJpbmFyeSBkYXRhIChpbiBwcm90b2J1ZiB3aXJlIGZvcm1hdCkuCiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLnNlcmlhbGl6ZUJpbmFyeSA9IGZ1bmN0aW9uICgpIHsKICB2YXIgd3JpdGVyID0gbmV3IGpzcGIuQmluYXJ5V3JpdGVyKCk7CiAgcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnNlcmlhbGl6ZUJpbmFyeVRvV3JpdGVyKHRoaXMsIHdyaXRlcik7CiAgcmV0dXJuIHdyaXRlci5nZXRSZXN1bHRCdWZmZXIoKTsKfTsKLyoqCiAqIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIG1lc3NhZ2UgdG8gYmluYXJ5IGRhdGEgKGluIHByb3RvYnVmIHdpcmUKICogZm9ybWF0KSwgd3JpdGluZyB0byB0aGUgZ2l2ZW4gQmluYXJ5V3JpdGVyLgogKiBAcGFyYW0geyFwcm90by5wYi5TZXR0bGVSZWNvcmR9IG1lc3NhZ2UKICogQHBhcmFtIHshanNwYi5CaW5hcnlXcml0ZXJ9IHdyaXRlcgogKiBAc3VwcHJlc3Mge3VudXNlZExvY2FsVmFyaWFibGVzfSBmIGlzIG9ubHkgdXNlZCBmb3IgbmVzdGVkIG1lc3NhZ2VzCiAqLwoKCnByb3RvLnBiLlNldHRsZVJlY29yZC5zZXJpYWxpemVCaW5hcnlUb1dyaXRlciA9IGZ1bmN0aW9uIChtZXNzYWdlLCB3cml0ZXIpIHsKICB2YXIgZiA9IHVuZGVmaW5lZDsKICBmID0gbWVzc2FnZS5nZXRJZCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDY0KDEsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0QXJlYUlkKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRHdWlsZElkKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMywgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRBbmNob3JJZCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDQsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0U3RhcnRBdCgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDUsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0RW5kQXQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMig2LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldENhbGxJbmNvbWUoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMig3LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEdpZnRJbmNvbWUoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMig4LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldENvbW1pc3Npb25JbmNvbWUoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMig5LCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldEJvbnVzSW5jb21lKCk7CgogIGlmIChmICE9PSAwKSB7CiAgICB3cml0ZXIud3JpdGVVaW50MzIoMTAsIGYpOwogIH0KCiAgZiA9IG1lc3NhZ2UuZ2V0UGVuYWx0eSgpOwoKICBpZiAoZiAhPT0gMCkgewogICAgd3JpdGVyLndyaXRlVWludDMyKDExLCBmKTsKICB9CgogIGYgPSBtZXNzYWdlLmdldFNldHRsZWQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigxMiwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRSb2xsYmFjaygpOwoKICBpZiAoZikgewogICAgd3JpdGVyLndyaXRlQm9vbCgxMywgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRVcGRhdGVkQXQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigyMCwgZik7CiAgfQoKICBmID0gbWVzc2FnZS5nZXRDcmVhdGVkQXQoKTsKCiAgaWYgKGYgIT09IDApIHsKICAgIHdyaXRlci53cml0ZVVpbnQzMigyMSwgZik7CiAgfQp9OwovKioKICogb3B0aW9uYWwgdWludDY0IGlkID0gMTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLmdldElkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDEsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5zZXRJZCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgMSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGFyZWFfaWQgPSAyOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLlNldHRsZVJlY29yZC5wcm90b3R5cGUuZ2V0QXJlYUlkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDIsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5zZXRBcmVhSWQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDIsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBndWlsZF9pZCA9IDM7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5nZXRHdWlsZElkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDMsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5zZXRHdWlsZElkID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAzLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgYW5jaG9yX2lkID0gNDsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLmdldEFuY2hvcklkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDQsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5zZXRBbmNob3JJZCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgNCwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIHN0YXJ0X2F0ID0gNTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLmdldFN0YXJ0QXQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgNSwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5TZXR0bGVSZWNvcmR9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLnNldFN0YXJ0QXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDUsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBlbmRfYXQgPSA2OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLlNldHRsZVJlY29yZC5wcm90b3R5cGUuZ2V0RW5kQXQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgNiwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5TZXR0bGVSZWNvcmR9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLnNldEVuZEF0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCA2LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgY2FsbF9pbmNvbWUgPSA3OwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLlNldHRsZVJlY29yZC5wcm90b3R5cGUuZ2V0Q2FsbEluY29tZSA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCA3LCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLlNldHRsZVJlY29yZH0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLlNldHRsZVJlY29yZC5wcm90b3R5cGUuc2V0Q2FsbEluY29tZSA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiBqc3BiLk1lc3NhZ2Uuc2V0UHJvdG8zSW50RmllbGQodGhpcywgNywgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIGdpZnRfaW5jb21lID0gODsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLmdldEdpZnRJbmNvbWUgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgOCwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5TZXR0bGVSZWNvcmR9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLnNldEdpZnRJbmNvbWUgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDgsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiBjb21taXNzaW9uX2luY29tZSA9IDk7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5nZXRDb21taXNzaW9uSW5jb21lID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDksIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5zZXRDb21taXNzaW9uSW5jb21lID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCA5LCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgYm9udXNfaW5jb21lID0gMTA7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5nZXRCb251c0luY29tZSA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gKAogICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0RmllbGRXaXRoRGVmYXVsdCh0aGlzLCAxMCwgMCkKICApOwp9OwovKioKICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5TZXR0bGVSZWNvcmR9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLnNldEJvbnVzSW5jb21lID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAxMCwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIHBlbmFsdHkgPSAxMTsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLmdldFBlbmFsdHkgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTEsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5zZXRQZW5hbHR5ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAxMSwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgdWludDMyIHNldHRsZWQgPSAxMjsKICogQHJldHVybiB7bnVtYmVyfQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLmdldFNldHRsZWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMTIsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5zZXRTZXR0bGVkID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAxMiwgdmFsdWUpOwp9OwovKioKICogb3B0aW9uYWwgYm9vbCByb2xsYmFjayA9IDEzOwogKiBAcmV0dXJuIHtib29sZWFufQogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLmdldFJvbGxiYWNrID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge2Jvb2xlYW59ICovCiAgICBqc3BiLk1lc3NhZ2UuZ2V0Qm9vbGVhbkZpZWxkV2l0aERlZmF1bHQodGhpcywgMTMsIGZhbHNlKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge2Jvb2xlYW59IHZhbHVlCiAqIEByZXR1cm4geyFwcm90by5wYi5TZXR0bGVSZWNvcmR9IHJldHVybnMgdGhpcwogKi8KCgpwcm90by5wYi5TZXR0bGVSZWNvcmQucHJvdG90eXBlLnNldFJvbGxiYWNrID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNCb29sZWFuRmllbGQodGhpcywgMTMsIHZhbHVlKTsKfTsKLyoqCiAqIG9wdGlvbmFsIHVpbnQzMiB1cGRhdGVkX2F0ID0gMjA7CiAqIEByZXR1cm4ge251bWJlcn0KICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5nZXRVcGRhdGVkQXQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogICAganNwYi5NZXNzYWdlLmdldEZpZWxkV2l0aERlZmF1bHQodGhpcywgMjAsIDApCiAgKTsKfTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZQogKiBAcmV0dXJuIHshcHJvdG8ucGIuU2V0dGxlUmVjb3JkfSByZXR1cm5zIHRoaXMKICovCgoKcHJvdG8ucGIuU2V0dGxlUmVjb3JkLnByb3RvdHlwZS5zZXRVcGRhdGVkQXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4ganNwYi5NZXNzYWdlLnNldFByb3RvM0ludEZpZWxkKHRoaXMsIDIwLCB2YWx1ZSk7Cn07Ci8qKgogKiBvcHRpb25hbCB1aW50MzIgY3JlYXRlZF9hdCA9IDIxOwogKiBAcmV0dXJuIHtudW1iZXJ9CiAqLwoKCnByb3RvLnBiLlNldHRsZVJlY29yZC5wcm90b3R5cGUuZ2V0Q3JlYXRlZEF0ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiAoCiAgICAvKiogQHR5cGUge251bWJlcn0gKi8KICAgIGpzcGIuTWVzc2FnZS5nZXRGaWVsZFdpdGhEZWZhdWx0KHRoaXMsIDIxLCAwKQogICk7Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0gdmFsdWUKICogQHJldHVybiB7IXByb3RvLnBiLlNldHRsZVJlY29yZH0gcmV0dXJucyB0aGlzCiAqLwoKCnByb3RvLnBiLlNldHRsZVJlY29yZC5wcm90b3R5cGUuc2V0Q3JlYXRlZEF0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgcmV0dXJuIGpzcGIuTWVzc2FnZS5zZXRQcm90bzNJbnRGaWVsZCh0aGlzLCAyMSwgdmFsdWUpOwp9OwoKZ29vZy5vYmplY3QuZXh0ZW5kKGV4cG9ydHMsIHByb3RvLnBiKTs="},null]}