{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/thread-loader/dist/cjs.js!/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js!/home/mengy/develop/iwork/kafo/vue-admin/src/proto/js/cms_grpc_web_pb.js","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-admin/src/proto/js/cms_grpc_web_pb.js","mtime":1633759276472},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoqCiAqIEBmaWxlb3ZlcnZpZXcgZ1JQQy1XZWIgZ2VuZXJhdGVkIGNsaWVudCBzdHViIGZvciBwYi5jbXMKICogQGVuaGFuY2VhYmxlCiAqIEBwdWJsaWMKICovCi8vIEdFTkVSQVRFRCBDT0RFIC0tIERPIE5PVCBFRElUIQoKLyogZXNsaW50LWRpc2FibGUgKi8KLy8gQHRzLW5vY2hlY2sKdmFyIGdycGMgPSB7fTsKZ3JwYy53ZWIgPSByZXF1aXJlKCdncnBjLXdlYicpOwoKdmFyIHVzZXJ0eXBlX3BiID0gcmVxdWlyZSgnLi91c2VydHlwZV9wYi5qcycpOwoKdmFyIGFuY2hvcnR5cGVfcGIgPSByZXF1aXJlKCcuL2FuY2hvcnR5cGVfcGIuanMnKTsKCnZhciBjbXN0eXBlX3BiID0gcmVxdWlyZSgnLi9jbXN0eXBlX3BiLmpzJyk7Cgp2YXIgcHJvdG8gPSB7fTsKcHJvdG8ucGIgPSB7fTsKcHJvdG8ucGIuY21zID0gcmVxdWlyZSgnLi9jbXNfcGIuanMnKTsKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSBob3N0bmFtZQogKiBAcGFyYW0gez9PYmplY3R9IGNyZWRlbnRpYWxzCiAqIEBwYXJhbSB7P09iamVjdH0gb3B0aW9ucwogKiBAY29uc3RydWN0b3IKICogQHN0cnVjdAogKiBAZmluYWwKICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50ID0gZnVuY3Rpb24gKGhvc3RuYW1lLCBjcmVkZW50aWFscywgb3B0aW9ucykgewogIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IHt9OwogIG9wdGlvbnNbJ2Zvcm1hdCddID0gJ3RleHQnOwogIC8qKgogICAqIEBwcml2YXRlIEBjb25zdCB7IWdycGMud2ViLkdycGNXZWJDbGllbnRCYXNlfSBUaGUgY2xpZW50CiAgICovCgogIHRoaXMuY2xpZW50XyA9IG5ldyBncnBjLndlYi5HcnBjV2ViQ2xpZW50QmFzZShvcHRpb25zKTsKICAvKioKICAgKiBAcHJpdmF0ZSBAY29uc3Qge3N0cmluZ30gVGhlIGhvc3RuYW1lCiAgICovCgogIHRoaXMuaG9zdG5hbWVfID0gaG9zdG5hbWU7Cn07Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gaG9zdG5hbWUKICogQHBhcmFtIHs/T2JqZWN0fSBjcmVkZW50aWFscwogKiBAcGFyYW0gez9PYmplY3R9IG9wdGlvbnMKICogQGNvbnN0cnVjdG9yCiAqIEBzdHJ1Y3QKICogQGZpbmFsCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50ID0gZnVuY3Rpb24gKGhvc3RuYW1lLCBjcmVkZW50aWFscywgb3B0aW9ucykgewogIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IHt9OwogIG9wdGlvbnNbJ2Zvcm1hdCddID0gJ3RleHQnOwogIC8qKgogICAqIEBwcml2YXRlIEBjb25zdCB7IWdycGMud2ViLkdycGNXZWJDbGllbnRCYXNlfSBUaGUgY2xpZW50CiAgICovCgogIHRoaXMuY2xpZW50XyA9IG5ldyBncnBjLndlYi5HcnBjV2ViQ2xpZW50QmFzZShvcHRpb25zKTsKICAvKioKICAgKiBAcHJpdmF0ZSBAY29uc3Qge3N0cmluZ30gVGhlIGhvc3RuYW1lCiAgICovCgogIHRoaXMuaG9zdG5hbWVfID0gaG9zdG5hbWU7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXJlYUxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0QXJlYUxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCB1c2VydHlwZV9wYi5FbXB0eSwgcHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BcmVhTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRBcmVhTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQXJlYUxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRW1wdHl9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BcmVhTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRBcmVhTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXJlYUxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXJlYUxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5BcmVhTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEFyZWFMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXJlYUxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXJlYUxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkxvZ2luUmVxdWVzdCwKICogICAhcHJvdG8ucGIuQWRtaW4+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfTG9naW4gPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvTG9naW4nLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuTG9naW5SZXF1ZXN0LCBjbXN0eXBlX3BiLkFkbWluLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkxvZ2luUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQWRtaW4uZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5Mb2dpblJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkFkbWluPn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfTG9naW4gPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5BZG1pbiwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Mb2dpblJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLkFkbWluLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Mb2dpblJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFkbWluKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQWRtaW4+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvTG9naW4nLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfTG9naW4sIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Mb2dpblJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuQWRtaW4+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9Mb2dpbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19Mb2dpbik7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuQWRtaW4+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QWRtaW5JbmZvID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldEFkbWluSW5mbycsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHVzZXJ0eXBlX3BiLkVtcHR5LCBjbXN0eXBlX3BiLkFkbWluLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRW1wdHl9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLkFkbWluLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuQWRtaW4+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRBZG1pbkluZm8gPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5BZG1pbiwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5BZG1pbi5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuQWRtaW4pfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5BZG1pbj58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldEFkbWluSW5mbyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QWRtaW5JbmZvJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFkbWluSW5mbywgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRW1wdHl9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuQWRtaW4+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0QWRtaW5JbmZvID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QWRtaW5JbmZvJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFkbWluSW5mbyk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRPdmVydmlldyA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRPdmVydmlldycsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5PdmVydmlld1JlcXVlc3QsIHByb3RvLnBiLmNtcy5PdmVydmlld1JlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5PdmVydmlld1JlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXBseT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0dldE92ZXJ2aWV3ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5PdmVydmlld1JlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5PdmVydmlld1JlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5PdmVydmlld1JlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5PdmVydmlld1JlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRPdmVydmlldyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0T3ZlcnZpZXcnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0T3ZlcnZpZXcsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5PdmVydmlld1JlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0T3ZlcnZpZXcgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRPdmVydmlldycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRPdmVydmlldyk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuSG9tZVN0YXRSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuSG9tZVN0YXRSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRIb21lU3RhdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRIb21lU3RhdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuSG9tZVN0YXRSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuSG9tZVN0YXRSZXBseT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0dldEhvbWVTdGF0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRIb21lU3RhdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0SG9tZVN0YXQnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0SG9tZVN0YXQsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0SG9tZVN0YXQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRIb21lU3RhdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRIb21lU3RhdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcmVhU3RhdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBcmVhU3RhdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFyZWFTdGF0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXBseT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0dldEFyZWFTdGF0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFyZWFTdGF0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BcmVhU3RhdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkFyZWFTdGF0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRBcmVhU3RhdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXJlYVN0YXQnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXJlYVN0YXQsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkFyZWFTdGF0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0QXJlYVN0YXQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBcmVhU3RhdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcmVhU3RhdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5BbmNob3JTdGF0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QW5jaG9yU3RhdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JTdGF0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXF1ZXN0LCBwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0QW5jaG9yU3RhdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BbmNob3JTdGF0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QW5jaG9yU3RhdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QW5jaG9yU3RhdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBbmNob3JTdGF0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRBbmNob3JTdGF0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QW5jaG9yU3RhdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBbmNob3JTdGF0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLkFkbWluLAogKiAgICFwcm90by5wYi5BZG1pbj59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQWRtaW4gPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZUFkbWluJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgY21zdHlwZV9wYi5BZG1pbiwgY21zdHlwZV9wYi5BZG1pbiwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFkbWlufSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5BZG1pbi5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuQWRtaW4sCiAqICAgIXByb3RvLnBiLkFkbWluPn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfU2F2ZUFkbWluID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGNtc3R5cGVfcGIuQWRtaW4sCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BZG1pbn0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQWRtaW4uZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQWRtaW59IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFkbWluKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQWRtaW4+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zYXZlQWRtaW4gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBZG1pbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQWRtaW4sIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFkbWlufSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkFkbWluPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVBZG1pbiA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBZG1pbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQWRtaW4pOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuRW1wdHksCiAqICAgIXByb3RvLnBiLmNtcy5BZG1pbkxpc3RSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBZG1pbkxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0QWRtaW5MaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgdXNlcnR5cGVfcGIuRW1wdHksIHByb3RvLnBiLmNtcy5BZG1pbkxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFkbWluTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuY21zLkFkbWluTGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0QWRtaW5MaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5BZG1pbkxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFkbWluTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQWRtaW5MaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuQWRtaW5MaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRBZG1pbkxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEFkbWluTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBZG1pbkxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5BZG1pbkxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRBZG1pbkxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBZG1pbkxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QWRtaW5MaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLkd1aWxkLAogKiAgICFwcm90by5wYi5HdWlsZD59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlR3VpbGQgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZUd1aWxkJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgY21zdHlwZV9wYi5HdWlsZCwgY21zdHlwZV9wYi5HdWlsZCwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkd1aWxkfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5HdWlsZC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuR3VpbGQsCiAqICAgIXByb3RvLnBiLkd1aWxkPn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfU2F2ZUd1aWxkID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGNtc3R5cGVfcGIuR3VpbGQsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5HdWlsZH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuR3VpbGQuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuR3VpbGR9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkd1aWxkKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuR3VpbGQ+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zYXZlR3VpbGQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVHdWlsZCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlR3VpbGQsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkd1aWxkfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkd1aWxkPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVHdWlsZCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVHdWlsZCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlR3VpbGQpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuRW1wdHksCiAqICAgIXByb3RvLnBiLmNtcy5HdWlsZExpc3RSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRHdWlsZExpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0R3VpbGRMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgdXNlcnR5cGVfcGIuRW1wdHksIHByb3RvLnBiLmNtcy5HdWlsZExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkd1aWxkTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuY21zLkd1aWxkTGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0R3VpbGRMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5HdWlsZExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkd1aWxkTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuR3VpbGRMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuR3VpbGRMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRHdWlsZExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEd1aWxkTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRHdWlsZExpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5HdWlsZExpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRHdWlsZExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRHdWlsZExpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0R3VpbGRMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvckxpc3RSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBbmNob3JMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldEFuY2hvckxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRBbmNob3JMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLkFuY2hvckxpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRBbmNob3JMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFuY2hvckxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEFuY2hvckxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFuY2hvckxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0VXNlckxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0VXNlckxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuVXNlckxpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuVXNlckxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuVXNlckxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRVc2VyTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuVXNlckxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuVXNlckxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVXNlckxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuVXNlckxpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0VXNlckxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFVzZXJMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFVzZXJMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVXNlckxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldFVzZXJMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0VXNlckxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0VXNlckxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQWRqdXN0QmFsYW5jZVJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0FkanVzdEJhbGFuY2UgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvQWRqdXN0QmFsYW5jZScsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVxdWVzdCwgcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXBseT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0FkanVzdEJhbGFuY2UgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQWRqdXN0QmFsYW5jZVJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmFkanVzdEJhbGFuY2UgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0FkanVzdEJhbGFuY2UnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfQWRqdXN0QmFsYW5jZSwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuYWRqdXN0QmFsYW5jZSA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0FkanVzdEJhbGFuY2UnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfQWRqdXN0QmFsYW5jZSk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5Vc2VyLAogKiAgICFwcm90by5wYi5Vc2VyPn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1VwZGF0ZVVzZXIgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvVXBkYXRlVXNlcicsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHVzZXJ0eXBlX3BiLlVzZXIsIHVzZXJ0eXBlX3BiLlVzZXIsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Vc2VyfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuVXNlci5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuVXNlciwKICogICAhcHJvdG8ucGIuVXNlcj59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1VwZGF0ZVVzZXIgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuVXNlciwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLlVzZXJ9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5Vc2VyLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLlVzZXJ9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLlVzZXIpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5Vc2VyPnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUudXBkYXRlVXNlciA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvVXBkYXRlVXNlcicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19VcGRhdGVVc2VyLCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Vc2VyfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLlVzZXI+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUudXBkYXRlVXNlciA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1VwZGF0ZVVzZXInLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVXBkYXRlVXNlcik7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuRGVsZXRlVXNlclJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkVtcHR5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0RlbGV0ZVVzZXIgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvRGVsZXRlVXNlcicsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5EZWxldGVVc2VyUmVxdWVzdCwgdXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuRGVsZXRlVXNlclJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkRlbGV0ZVVzZXJSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0RlbGV0ZVVzZXIgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuRGVsZXRlVXNlclJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuRGVsZXRlVXNlclJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkVtcHR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuRW1wdHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5kZWxldGVVc2VyID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9EZWxldGVVc2VyJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0RlbGV0ZVVzZXIsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5EZWxldGVVc2VyUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5FbXB0eT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5kZWxldGVVc2VyID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvRGVsZXRlVXNlcicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19EZWxldGVVc2VyKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLkFuY2hvckJhc2ljLAogKiAgICFwcm90by5wYi5BbmNob3JCYXNpYz59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19VcGRhdGVBbmNob3JCYXNpYyA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9VcGRhdGVBbmNob3JCYXNpYycsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIGFuY2hvcnR5cGVfcGIuQW5jaG9yQmFzaWMsIGFuY2hvcnR5cGVfcGIuQW5jaG9yQmFzaWMsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGFuY2hvcnR5cGVfcGIuQW5jaG9yQmFzaWMuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLkFuY2hvckJhc2ljLAogKiAgICFwcm90by5wYi5BbmNob3JCYXNpYz59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1VwZGF0ZUFuY2hvckJhc2ljID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGFuY2hvcnR5cGVfcGIuQW5jaG9yQmFzaWMsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGFuY2hvcnR5cGVfcGIuQW5jaG9yQmFzaWMuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFuY2hvckJhc2ljKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQW5jaG9yQmFzaWM+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS51cGRhdGVBbmNob3JCYXNpYyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvVXBkYXRlQW5jaG9yQmFzaWMnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVXBkYXRlQW5jaG9yQmFzaWMsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkFuY2hvckJhc2ljPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnVwZGF0ZUFuY2hvckJhc2ljID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvVXBkYXRlQW5jaG9yQmFzaWMnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVXBkYXRlQW5jaG9yQmFzaWMpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkJsb2NrUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfQmxvY2sgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvQmxvY2snLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQmxvY2tSZXF1ZXN0LCB1c2VydHlwZV9wYi5FbXB0eSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5CbG9ja1JlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkJsb2NrUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19CbG9jayA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyh1c2VydHlwZV9wYi5FbXB0eSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5CbG9ja1JlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQmxvY2tSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5FbXB0eSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLkVtcHR5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuYmxvY2sgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0Jsb2NrJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0Jsb2NrLCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQmxvY2tSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkVtcHR5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmJsb2NrID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvQmxvY2snLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfQmxvY2spOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlVuYmxvY2tSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19VbmJsb2NrID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1VuYmxvY2snLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuVW5ibG9ja1JlcXVlc3QsIHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlVuYmxvY2tSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5VbmJsb2NrUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19VbmJsb2NrID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlVuYmxvY2tSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlVuYmxvY2tSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5FbXB0eSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLkVtcHR5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUudW5ibG9jayA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvVW5ibG9jaycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19VbmJsb2NrLCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVW5ibG9ja1JlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuRW1wdHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUudW5ibG9jayA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1VuYmxvY2snLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVW5ibG9jayk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuTWlncmF0ZVJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkVtcHR5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX01pZ3JhdGUgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvTWlncmF0ZScsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5NaWdyYXRlUmVxdWVzdCwgdXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTWlncmF0ZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLk1pZ3JhdGVSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX01pZ3JhdGUgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTWlncmF0ZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTWlncmF0ZVJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkVtcHR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuRW1wdHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5taWdyYXRlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9NaWdyYXRlJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX01pZ3JhdGUsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5NaWdyYXRlUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5FbXB0eT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5taWdyYXRlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvTWlncmF0ZScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19NaWdyYXRlKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5BdXRob3JpemVBbmNob3JSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19BdXRob3JpemVBbmNob3IgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvQXV0aG9yaXplQW5jaG9yJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkF1dGhvcml6ZUFuY2hvclJlcXVlc3QsIHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dGhvcml6ZUFuY2hvclJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkF1dGhvcml6ZUFuY2hvclJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkVtcHR5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfQXV0aG9yaXplQW5jaG9yID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dGhvcml6ZUFuY2hvclJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXV0aG9yaXplQW5jaG9yUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuRW1wdHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5FbXB0eT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmF1dGhvcml6ZUFuY2hvciA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvQXV0aG9yaXplQW5jaG9yJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0F1dGhvcml6ZUFuY2hvciwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dGhvcml6ZUFuY2hvclJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuRW1wdHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuYXV0aG9yaXplQW5jaG9yID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvQXV0aG9yaXplQW5jaG9yJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0F1dGhvcml6ZUFuY2hvcik7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5BbmNob3JGdWxsUmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QW5jaG9yRnVsbCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JGdWxsJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXF1ZXN0LCBwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0QW5jaG9yRnVsbCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BbmNob3JGdWxsUmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QW5jaG9yRnVsbCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QW5jaG9yRnVsbCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBbmNob3JGdWxsLCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRBbmNob3JGdWxsID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QW5jaG9yRnVsbCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBbmNob3JGdWxsKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5Qcm9maWxlTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Qcm9maWxlTGlzdFJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFByb2ZpbGVMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldFByb2ZpbGVMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5Qcm9maWxlTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Qcm9maWxlTGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0UHJvZmlsZUxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldFByb2ZpbGVMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRQcm9maWxlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRQcm9maWxlTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRQcm9maWxlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFByb2ZpbGVMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFByb2ZpbGVMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5Qcm9jZXNzUHJvZmlsZVJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkFuY2hvclByb2ZpbGU+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfUHJvY2Vzc1Byb2ZpbGUgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvUHJvY2Vzc1Byb2ZpbGUnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuUHJvY2Vzc1Byb2ZpbGVSZXF1ZXN0LCBhbmNob3J0eXBlX3BiLkFuY2hvclByb2ZpbGUsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUHJvY2Vzc1Byb2ZpbGVSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgYW5jaG9ydHlwZV9wYi5BbmNob3JQcm9maWxlLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuUHJvY2Vzc1Byb2ZpbGVSZXF1ZXN0LAogKiAgICFwcm90by5wYi5BbmNob3JQcm9maWxlPn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfUHJvY2Vzc1Byb2ZpbGUgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oYW5jaG9ydHlwZV9wYi5BbmNob3JQcm9maWxlLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2Nlc3NQcm9maWxlUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGFuY2hvcnR5cGVfcGIuQW5jaG9yUHJvZmlsZS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUHJvY2Vzc1Byb2ZpbGVSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5BbmNob3JQcm9maWxlKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQW5jaG9yUHJvZmlsZT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnByb2Nlc3NQcm9maWxlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9Qcm9jZXNzUHJvZmlsZScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19Qcm9jZXNzUHJvZmlsZSwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2Nlc3NQcm9maWxlUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5BbmNob3JQcm9maWxlPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnByb2Nlc3NQcm9maWxlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvUHJvY2Vzc1Byb2ZpbGUnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfUHJvY2Vzc1Byb2ZpbGUpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuVmlvbGF0aW9uTGlzdFJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFZpb2xhdGlvbkxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0VmlvbGF0aW9uTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0dldFZpb2xhdGlvbkxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuVmlvbGF0aW9uTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldFZpb2xhdGlvbkxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFZpb2xhdGlvbkxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0VmlvbGF0aW9uTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0VmlvbGF0aW9uTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFZpb2xhdGlvbkxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0VmlvbGF0aW9uTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuUHJvY2Vzc1Zpb2xhdGlvblJlcXVlc3QsCiAqICAgIXByb3RvLnBiLlZpb2xhdGlvblJlY29yZD59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19Qcm9jZXNzVmlvbGF0aW9uID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1Byb2Nlc3NWaW9sYXRpb24nLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuUHJvY2Vzc1Zpb2xhdGlvblJlcXVlc3QsIHVzZXJ0eXBlX3BiLlZpb2xhdGlvblJlY29yZCwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Qcm9jZXNzVmlvbGF0aW9uUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLlZpb2xhdGlvblJlY29yZC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlByb2Nlc3NWaW9sYXRpb25SZXF1ZXN0LAogKiAgICFwcm90by5wYi5WaW9sYXRpb25SZWNvcmQ+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19Qcm9jZXNzVmlvbGF0aW9uID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLlZpb2xhdGlvblJlY29yZCwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Qcm9jZXNzVmlvbGF0aW9uUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLlZpb2xhdGlvblJlY29yZC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUHJvY2Vzc1Zpb2xhdGlvblJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLlZpb2xhdGlvblJlY29yZCl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLlZpb2xhdGlvblJlY29yZD58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnByb2Nlc3NWaW9sYXRpb24gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1Byb2Nlc3NWaW9sYXRpb24nLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfUHJvY2Vzc1Zpb2xhdGlvbiwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2Nlc3NWaW9sYXRpb25SZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLlZpb2xhdGlvblJlY29yZD59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5wcm9jZXNzVmlvbGF0aW9uID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvUHJvY2Vzc1Zpb2xhdGlvbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19Qcm9jZXNzVmlvbGF0aW9uKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldExpdmVMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldExpdmVMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTGl2ZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0TGl2ZUxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLkxpdmVMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTGl2ZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLkxpdmVMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuTGl2ZUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldExpdmVMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRMaXZlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRMaXZlTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuTGl2ZUxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRMaXZlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldExpdmVMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldExpdmVMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5QYXlMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlBheUxpc3RSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRQYXlMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldFBheUxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuUGF5TGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUGF5TGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuUGF5TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuUGF5TGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRQYXlMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUGF5TGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuUGF5TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLlBheUxpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRQYXlMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRQYXlMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFBheUxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuUGF5TGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldFBheUxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRQYXlMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFBheUxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlJvYm90TGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRSb2JvdExpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0Um9ib3RMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLlJvYm90TGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlJvYm90TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuUm9ib3RMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlJvYm90TGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0Um9ib3RMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlJvYm90TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuUm9ib3RMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuUm9ib3RMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRSb2JvdExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFJvYm90TGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRSb2JvdExpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRSb2JvdExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRSb2JvdExpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Um9ib3RMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLkFuY2hvclByb2ZpbGUsCiAqICAgIXByb3RvLnBiLkFuY2hvclByb2ZpbGU+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVJvYm90ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVSb2JvdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIGFuY2hvcnR5cGVfcGIuQW5jaG9yUHJvZmlsZSwgYW5jaG9ydHlwZV9wYi5BbmNob3JQcm9maWxlLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGFuY2hvcnR5cGVfcGIuQW5jaG9yUHJvZmlsZS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuQW5jaG9yUHJvZmlsZSwKICogICAhcHJvdG8ucGIuQW5jaG9yUHJvZmlsZT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1NhdmVSb2JvdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhhbmNob3J0eXBlX3BiLkFuY2hvclByb2ZpbGUsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgYW5jaG9ydHlwZV9wYi5BbmNob3JQcm9maWxlLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFuY2hvclByb2ZpbGV9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFuY2hvclByb2ZpbGUpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5BbmNob3JQcm9maWxlPnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuc2F2ZVJvYm90ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlUm9ib3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVJvYm90LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkFuY2hvclByb2ZpbGU+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuc2F2ZVJvYm90ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZVJvYm90JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVSb2JvdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Sb2JvdE1lc3NhZ2VMaXN0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Um9ib3RNZXNzYWdlTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRSb2JvdE1lc3NhZ2VMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0Um9ib3RNZXNzYWdlTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5Sb2JvdE1lc3NhZ2VMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0Um9ib3RNZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Um9ib3RNZXNzYWdlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRSb2JvdE1lc3NhZ2VMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRSb2JvdE1lc3NhZ2VMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Um9ib3RNZXNzYWdlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRSb2JvdE1lc3NhZ2VMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLlJvYm90TWVzc2FnZSwKICogICAhcHJvdG8ucGIuUm9ib3RNZXNzYWdlPn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVSb2JvdE1lc3NhZ2UgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZVJvYm90TWVzc2FnZScsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIGNtc3R5cGVfcGIuUm9ib3RNZXNzYWdlLCBjbXN0eXBlX3BiLlJvYm90TWVzc2FnZSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLlJvYm90TWVzc2FnZX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuUm9ib3RNZXNzYWdlLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5Sb2JvdE1lc3NhZ2UsCiAqICAgIXByb3RvLnBiLlJvYm90TWVzc2FnZT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1NhdmVSb2JvdE1lc3NhZ2UgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5Sb2JvdE1lc3NhZ2UsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Sb2JvdE1lc3NhZ2V9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLlJvYm90TWVzc2FnZS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Sb2JvdE1lc3NhZ2V9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLlJvYm90TWVzc2FnZSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLlJvYm90TWVzc2FnZT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVSb2JvdE1lc3NhZ2UgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVSb2JvdE1lc3NhZ2UnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVJvYm90TWVzc2FnZSwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuUm9ib3RNZXNzYWdlfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLlJvYm90TWVzc2FnZT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5zYXZlUm9ib3RNZXNzYWdlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZVJvYm90TWVzc2FnZScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUm9ib3RNZXNzYWdlKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLk1vbWVudExpc3RSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRNb21lbnRMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldE1vbWVudExpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRNb21lbnRMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLk1vbWVudExpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRNb21lbnRMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRNb21lbnRMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldE1vbWVudExpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldE1vbWVudExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRNb21lbnRMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldE1vbWVudExpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuTW9tZW50LAogKiAgICFwcm90by5wYi5Nb21lbnQ+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZU1vbWVudCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9TYXZlTW9tZW50JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgdXNlcnR5cGVfcGIuTW9tZW50LCB1c2VydHlwZV9wYi5Nb21lbnQsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Nb21lbnR9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5Nb21lbnQuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLk1vbWVudCwKICogICAhcHJvdG8ucGIuTW9tZW50Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfU2F2ZU1vbWVudCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyh1c2VydHlwZV9wYi5Nb21lbnQsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Nb21lbnR9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5Nb21lbnQuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuTW9tZW50fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5Nb21lbnQpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5Nb21lbnQ+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zYXZlTW9tZW50ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlTW9tZW50JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVNb21lbnQsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLk1vbWVudH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5Nb21lbnQ+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuc2F2ZU1vbWVudCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVNb21lbnQnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZU1vbWVudCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQXV0b01lc3NhZ2VMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEF1dG9NZXNzYWdlTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBdXRvTWVzc2FnZUxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQXV0b01lc3NhZ2VMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQXV0b01lc3NhZ2VMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5BdXRvTWVzc2FnZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXV0b01lc3NhZ2VMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRBdXRvTWVzc2FnZUxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQXV0b01lc3NhZ2VMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BdXRvTWVzc2FnZUxpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5BdXRvTWVzc2FnZUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldEF1dG9NZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXV0b01lc3NhZ2VMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEF1dG9NZXNzYWdlTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEF1dG9NZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEF1dG9NZXNzYWdlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBdXRvTWVzc2FnZUxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuQXV0b01lc3NhZ2UsCiAqICAgIXByb3RvLnBiLkF1dG9NZXNzYWdlPn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVBdXRvTWVzc2FnZSA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9TYXZlQXV0b01lc3NhZ2UnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBjbXN0eXBlX3BiLkF1dG9NZXNzYWdlLCBjbXN0eXBlX3BiLkF1dG9NZXNzYWdlLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXV0b01lc3NhZ2V9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLkF1dG9NZXNzYWdlLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5BdXRvTWVzc2FnZSwKICogICAhcHJvdG8ucGIuQXV0b01lc3NhZ2U+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19TYXZlQXV0b01lc3NhZ2UgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5BdXRvTWVzc2FnZSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkF1dG9NZXNzYWdlfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5BdXRvTWVzc2FnZS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BdXRvTWVzc2FnZX0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuQXV0b01lc3NhZ2UpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5BdXRvTWVzc2FnZT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVBdXRvTWVzc2FnZSA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUF1dG9NZXNzYWdlJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVBdXRvTWVzc2FnZSwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXV0b01lc3NhZ2V9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuQXV0b01lc3NhZ2U+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuc2F2ZUF1dG9NZXNzYWdlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUF1dG9NZXNzYWdlJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVBdXRvTWVzc2FnZSk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENoYXRNZXNzYWdlTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRDaGF0TWVzc2FnZUxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5DaGF0TWVzc2FnZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRDaGF0TWVzc2FnZUxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5DaGF0TWVzc2FnZUxpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5DaGF0TWVzc2FnZUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldENoYXRNZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Q2hhdE1lc3NhZ2VMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENoYXRNZXNzYWdlTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldENoYXRNZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldENoYXRNZXNzYWdlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRDaGF0TWVzc2FnZUxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkNhbGxMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkNhbGxMaXN0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q2FsbExpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0Q2FsbExpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQ2FsbExpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkNhbGxMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkNhbGxMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRDYWxsTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ2FsbExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0Q2FsbExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldENhbGxMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENhbGxMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ2FsbExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldENhbGxMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Q2FsbExpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q2FsbExpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRUcmFuc2FjdGlvbkxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0VHJhbnNhY3Rpb25MaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0VHJhbnNhY3Rpb25MaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRUcmFuc2FjdGlvbkxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFRyYW5zYWN0aW9uTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRUcmFuc2FjdGlvbkxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRUcmFuc2FjdGlvbkxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRUcmFuc2FjdGlvbkxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0VHJhbnNhY3Rpb25MaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5DcmVhdGVTZXR0bGVSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19DcmVhdGVTZXR0bGVSZWNvcmQgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvQ3JlYXRlU2V0dGxlUmVjb3JkJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkNyZWF0ZVNldHRsZVJlcXVlc3QsIHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNyZWF0ZVNldHRsZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkNyZWF0ZVNldHRsZVJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkVtcHR5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfQ3JlYXRlU2V0dGxlUmVjb3JkID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNyZWF0ZVNldHRsZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ3JlYXRlU2V0dGxlUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuRW1wdHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5FbXB0eT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmNyZWF0ZVNldHRsZVJlY29yZCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvQ3JlYXRlU2V0dGxlUmVjb3JkJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0NyZWF0ZVNldHRsZVJlY29yZCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNyZWF0ZVNldHRsZVJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuRW1wdHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuY3JlYXRlU2V0dGxlUmVjb3JkID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvQ3JlYXRlU2V0dGxlUmVjb3JkJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0NyZWF0ZVNldHRsZVJlY29yZCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuU3VibWl0U2V0dGxlUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU3VibWl0U2V0dGxlUmVjb3JkID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1N1Ym1pdFNldHRsZVJlY29yZCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5TdWJtaXRTZXR0bGVSZXF1ZXN0LCB1c2VydHlwZV9wYi5FbXB0eSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TdWJtaXRTZXR0bGVSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5TdWJtaXRTZXR0bGVSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1N1Ym1pdFNldHRsZVJlY29yZCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyh1c2VydHlwZV9wYi5FbXB0eSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TdWJtaXRTZXR0bGVSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlN1Ym1pdFNldHRsZVJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkVtcHR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuRW1wdHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zdWJtaXRTZXR0bGVSZWNvcmQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1N1Ym1pdFNldHRsZVJlY29yZCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TdWJtaXRTZXR0bGVSZWNvcmQsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TdWJtaXRTZXR0bGVSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkVtcHR5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnN1Ym1pdFNldHRsZVJlY29yZCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1N1Ym1pdFNldHRsZVJlY29yZCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TdWJtaXRTZXR0bGVSZWNvcmQpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfUXVlcnlTZXR0bGVQcm9ncmVzcyA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9RdWVyeVNldHRsZVByb2dyZXNzJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVxdWVzdCwgcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5TZXR0bGVQcm9ncmVzc1JlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5TZXR0bGVQcm9ncmVzc1JlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfUXVlcnlTZXR0bGVQcm9ncmVzcyA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TZXR0bGVQcm9ncmVzc1JlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5TZXR0bGVQcm9ncmVzc1JlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUucXVlcnlTZXR0bGVQcm9ncmVzcyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvUXVlcnlTZXR0bGVQcm9ncmVzcycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19RdWVyeVNldHRsZVByb2dyZXNzLCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5TZXR0bGVQcm9ncmVzc1JlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnF1ZXJ5U2V0dGxlUHJvZ3Jlc3MgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9RdWVyeVNldHRsZVByb2dyZXNzJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1F1ZXJ5U2V0dGxlUHJvZ3Jlc3MpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuU2V0dGxlTGlzdFJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFNldHRsZUxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0U2V0dGxlTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0dldFNldHRsZUxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuU2V0dGxlTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldFNldHRsZUxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFNldHRsZUxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0U2V0dGxlTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0U2V0dGxlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFNldHRsZUxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0U2V0dGxlTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQXBwTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5BcHBMaXN0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXBwTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBcHBMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkFwcExpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuQXBwTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFwcExpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFwcExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkFwcExpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXBwTGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0QXBwTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQXBwTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFwcExpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFwcExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXBwTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BcHBMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuQXBwTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QXBwTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXBwTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcHBMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXBwTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkFwcExpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRBcHBMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXBwTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcHBMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLkFwcCwKICogICAhcHJvdG8ucGIuQXBwPn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVBcHAgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZUFwcCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIGNtc3R5cGVfcGIuQXBwLCBjbXN0eXBlX3BiLkFwcCwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFwcH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQXBwLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5BcHAsCiAqICAgIXByb3RvLnBiLkFwcD59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1NhdmVBcHAgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5BcHAsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BcHB9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLkFwcC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BcHB9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFwcCl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLkFwcD58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVBcHAgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBcHAnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZUFwcCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXBwfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkFwcD59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5zYXZlQXBwID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUFwcCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQXBwKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5WZXJzaW9uTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5WZXJzaW9uTGlzdFJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFZlcnNpb25MaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldFZlcnNpb25MaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLlZlcnNpb25MaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLlZlcnNpb25MaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVmVyc2lvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlZlcnNpb25MaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5WZXJzaW9uTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5WZXJzaW9uTGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0VmVyc2lvbkxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLlZlcnNpb25MaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVmVyc2lvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlZlcnNpb25MaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlZlcnNpb25MaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLlZlcnNpb25MaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuVmVyc2lvbkxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldFZlcnNpb25MaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRWZXJzaW9uTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRWZXJzaW9uTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlZlcnNpb25MaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuVmVyc2lvbkxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRWZXJzaW9uTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFZlcnNpb25MaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFZlcnNpb25MaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLlZlcnNpb24sCiAqICAgIXByb3RvLnBiLlZlcnNpb24+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVZlcnNpb24gPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZVZlcnNpb24nLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBjbXN0eXBlX3BiLlZlcnNpb24sIGNtc3R5cGVfcGIuVmVyc2lvbiwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLlZlcnNpb259IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLlZlcnNpb24uZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLlZlcnNpb24sCiAqICAgIXByb3RvLnBiLlZlcnNpb24+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19TYXZlVmVyc2lvbiA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhjbXN0eXBlX3BiLlZlcnNpb24sCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5WZXJzaW9ufSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5WZXJzaW9uLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLlZlcnNpb259IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLlZlcnNpb24pfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5WZXJzaW9uPnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuc2F2ZVZlcnNpb24gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVWZXJzaW9uJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVWZXJzaW9uLCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5WZXJzaW9ufSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLlZlcnNpb24+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuc2F2ZVZlcnNpb24gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlVmVyc2lvbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlVmVyc2lvbik7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXBseT59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcmVhQ29uZmlnTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBcmVhQ29uZmlnTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFyZWFDb25maWdMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXBseT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0dldEFyZWFDb25maWdMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFyZWFDb25maWdMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkFyZWFDb25maWdMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRBcmVhQ29uZmlnTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXJlYUNvbmZpZ0xpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXJlYUNvbmZpZ0xpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkFyZWFDb25maWdMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0QXJlYUNvbmZpZ0xpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBcmVhQ29uZmlnTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcmVhQ29uZmlnTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5BcmVhQ29uZmlnLAogKiAgICFwcm90by5wYi5BcmVhQ29uZmlnPn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVBcmVhQ29uZmlnID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVBcmVhQ29uZmlnJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgY21zdHlwZV9wYi5BcmVhQ29uZmlnLCBjbXN0eXBlX3BiLkFyZWFDb25maWcsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BcmVhQ29uZmlnfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5BcmVhQ29uZmlnLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5BcmVhQ29uZmlnLAogKiAgICFwcm90by5wYi5BcmVhQ29uZmlnPn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfU2F2ZUFyZWFDb25maWcgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5BcmVhQ29uZmlnLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXJlYUNvbmZpZ30gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQXJlYUNvbmZpZy5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BcmVhQ29uZmlnfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5BcmVhQ29uZmlnKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQXJlYUNvbmZpZz58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVBcmVhQ29uZmlnID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlQXJlYUNvbmZpZycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQXJlYUNvbmZpZywgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXJlYUNvbmZpZ30gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5BcmVhQ29uZmlnPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVBcmVhQ29uZmlnID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUFyZWFDb25maWcnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZUFyZWFDb25maWcpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkNvdW50cnlDb25maWdMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkNvdW50cnlDb25maWdMaXN0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q291bnRyeUNvbmZpZ0xpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0Q291bnRyeUNvbmZpZ0xpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkNvdW50cnlDb25maWdMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkNvdW50cnlDb25maWdMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRDb3VudHJ5Q29uZmlnTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0Q291bnRyeUNvbmZpZ0xpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldENvdW50cnlDb25maWdMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENvdW50cnlDb25maWdMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldENvdW50cnlDb25maWdMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Q291bnRyeUNvbmZpZ0xpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q291bnRyeUNvbmZpZ0xpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuQ291bnRyeUNvbmZpZywKICogICAhcHJvdG8ucGIuQ291bnRyeUNvbmZpZz59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQ291bnRyeUNvbmZpZyA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9TYXZlQ291bnRyeUNvbmZpZycsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHVzZXJ0eXBlX3BiLkNvdW50cnlDb25maWcsIHVzZXJ0eXBlX3BiLkNvdW50cnlDb25maWcsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Db3VudHJ5Q29uZmlnfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuQ291bnRyeUNvbmZpZy5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuQ291bnRyeUNvbmZpZywKICogICAhcHJvdG8ucGIuQ291bnRyeUNvbmZpZz59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1NhdmVDb3VudHJ5Q29uZmlnID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLkNvdW50cnlDb25maWcsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Db3VudHJ5Q29uZmlnfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuQ291bnRyeUNvbmZpZy5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Db3VudHJ5Q29uZmlnfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5Db3VudHJ5Q29uZmlnKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQ291bnRyeUNvbmZpZz58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVDb3VudHJ5Q29uZmlnID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlQ291bnRyeUNvbmZpZycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQ291bnRyeUNvbmZpZywgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQ291bnRyeUNvbmZpZ30gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5Db3VudHJ5Q29uZmlnPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVDb3VudHJ5Q29uZmlnID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUNvdW50cnlDb25maWcnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZUNvdW50cnlDb25maWcpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0UGF5Q2hhbm5lbExpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0UGF5Q2hhbm5lbExpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRQYXlDaGFubmVsTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0UGF5Q2hhbm5lbExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFBheUNoYW5uZWxMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFBheUNoYW5uZWxMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldFBheUNoYW5uZWxMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0UGF5Q2hhbm5lbExpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0UGF5Q2hhbm5lbExpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuUGF5Q2hhbm5lbCwKICogICAhcHJvdG8ucGIuUGF5Q2hhbm5lbD59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUGF5Q2hhbm5lbCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9TYXZlUGF5Q2hhbm5lbCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHVzZXJ0eXBlX3BiLlBheUNoYW5uZWwsIHVzZXJ0eXBlX3BiLlBheUNoYW5uZWwsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5QYXlDaGFubmVsfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuUGF5Q2hhbm5lbC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuUGF5Q2hhbm5lbCwKICogICAhcHJvdG8ucGIuUGF5Q2hhbm5lbD59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1NhdmVQYXlDaGFubmVsID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLlBheUNoYW5uZWwsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5QYXlDaGFubmVsfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuUGF5Q2hhbm5lbC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5QYXlDaGFubmVsfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5QYXlDaGFubmVsKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuUGF5Q2hhbm5lbD58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVQYXlDaGFubmVsID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlUGF5Q2hhbm5lbCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUGF5Q2hhbm5lbCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuUGF5Q2hhbm5lbH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5QYXlDaGFubmVsPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVQYXlDaGFubmVsID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZVBheUNoYW5uZWwnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVBheUNoYW5uZWwpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlBheUNvbmZpZ0xpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuUGF5Q29uZmlnTGlzdFJlcGx5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFBheUNvbmZpZ0xpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0UGF5Q29uZmlnTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5QYXlDb25maWdMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLlBheUNvbmZpZ0xpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlDb25maWdMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5QYXlDb25maWdMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5QYXlDb25maWdMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlBheUNvbmZpZ0xpc3RSZXBseT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX0dldFBheUNvbmZpZ0xpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLlBheUNvbmZpZ0xpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlDb25maWdMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5QYXlDb25maWdMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlBheUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuUGF5Q29uZmlnTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLlBheUNvbmZpZ0xpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldFBheUNvbmZpZ0xpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFBheUNvbmZpZ0xpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0UGF5Q29uZmlnTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlBheUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5QYXlDb25maWdMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0UGF5Q29uZmlnTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFBheUNvbmZpZ0xpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0UGF5Q29uZmlnTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5QYXlDb25maWcsCiAqICAgIXByb3RvLnBiLlBheUNvbmZpZz59CiAqLwoKCnZhciBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUGF5Q29uZmlnID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVQYXlDb25maWcnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBjbXN0eXBlX3BiLlBheUNvbmZpZywgY21zdHlwZV9wYi5QYXlDb25maWcsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5QYXlDb25maWd9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLlBheUNvbmZpZy5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuUGF5Q29uZmlnLAogKiAgICFwcm90by5wYi5QYXlDb25maWc+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19TYXZlUGF5Q29uZmlnID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGNtc3R5cGVfcGIuUGF5Q29uZmlnLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuUGF5Q29uZmlnfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5QYXlDb25maWcuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuUGF5Q29uZmlnfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5QYXlDb25maWcpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5QYXlDb25maWc+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zYXZlUGF5Q29uZmlnID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlUGF5Q29uZmlnJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVQYXlDb25maWcsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLlBheUNvbmZpZ30gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5QYXlDb25maWc+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuc2F2ZVBheUNvbmZpZyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVQYXlDb25maWcnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVBheUNvbmZpZyk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Db21tb2RpdHlMaXN0UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q29tbW9kaXR5TGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRDb21tb2RpdHlMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5Pn0KICovCgp2YXIgbWV0aG9kSW5mb19DbXNTZGtfR2V0Q29tbW9kaXR5TGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5Db21tb2RpdHlMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0Q29tbW9kaXR5TGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Q29tbW9kaXR5TGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRDb21tb2RpdHlMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRDb21tb2RpdHlMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Q29tbW9kaXR5TGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRDb21tb2RpdHlMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLkNvbW1vZGl0eSwKICogICAhcHJvdG8ucGIuQ29tbW9kaXR5Pn0KICovCgoKdmFyIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVDb21tb2RpdHkgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZUNvbW1vZGl0eScsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHVzZXJ0eXBlX3BiLkNvbW1vZGl0eSwgdXNlcnR5cGVfcGIuQ29tbW9kaXR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQ29tbW9kaXR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuQ29tbW9kaXR5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5Db21tb2RpdHksCiAqICAgIXByb3RvLnBiLkNvbW1vZGl0eT59CiAqLwoKdmFyIG1ldGhvZEluZm9fQ21zU2RrX1NhdmVDb21tb2RpdHkgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuQ29tbW9kaXR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQ29tbW9kaXR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuQ29tbW9kaXR5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkNvbW1vZGl0eX0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuQ29tbW9kaXR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQ29tbW9kaXR5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuc2F2ZUNvbW1vZGl0eSA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUNvbW1vZGl0eScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQ29tbW9kaXR5LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Db21tb2RpdHl9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuQ29tbW9kaXR5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVDb21tb2RpdHkgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlQ29tbW9kaXR5JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVDb21tb2RpdHkpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkFnb3JhS2V5UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkFnb3JhS2V5UmVwbHk+fQogKi8KCgp2YXIgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QWdvcmFLZXkgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0QWdvcmFLZXknLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQWdvcmFLZXlSZXF1ZXN0LCBwcm90by5wYi5jbXMuQWdvcmFLZXlSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BZ29yYUtleVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQWdvcmFLZXlSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkFnb3JhS2V5UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkFnb3JhS2V5UmVwbHk+fQogKi8KCnZhciBtZXRob2RJbmZvX0Ntc1Nka19HZXRBZ29yYUtleSA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQWdvcmFLZXlSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BZ29yYUtleVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQWdvcmFLZXlSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQWdvcmFLZXlSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQWdvcmFLZXlSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5BZ29yYUtleVJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QWdvcmFLZXkgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEFnb3JhS2V5JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFnb3JhS2V5LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQWdvcmFLZXlSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5BZ29yYUtleVJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEFnb3JhS2V5ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QWdvcmFLZXknLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QWdvcmFLZXkpOwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBwcm90by5wYi5jbXM7"},null]}