{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js!/home/mengy/develop/iwork/kafo/vue-admin/src/proto/js/cms_grpc_web_pb.js","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-admin/src/proto/js/cms_grpc_web_pb.js","mtime":1631850766824},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoqCiAqIEBmaWxlb3ZlcnZpZXcgZ1JQQy1XZWIgZ2VuZXJhdGVkIGNsaWVudCBzdHViIGZvciBwYi5jbXMKICogQGVuaGFuY2VhYmxlCiAqIEBwdWJsaWMKICovCi8vIEdFTkVSQVRFRCBDT0RFIC0tIERPIE5PVCBFRElUIQoKLyogZXNsaW50LWRpc2FibGUgKi8KLy8gQHRzLW5vY2hlY2sKY29uc3QgZ3JwYyA9IHt9OwpncnBjLndlYiA9IHJlcXVpcmUoJ2dycGMtd2ViJyk7Cgp2YXIgdXNlcnR5cGVfcGIgPSByZXF1aXJlKCcuL3VzZXJ0eXBlX3BiLmpzJyk7Cgp2YXIgYW5jaG9ydHlwZV9wYiA9IHJlcXVpcmUoJy4vYW5jaG9ydHlwZV9wYi5qcycpOwoKdmFyIGNtc3R5cGVfcGIgPSByZXF1aXJlKCcuL2Ntc3R5cGVfcGIuanMnKTsKCmNvbnN0IHByb3RvID0ge307CnByb3RvLnBiID0ge307CnByb3RvLnBiLmNtcyA9IHJlcXVpcmUoJy4vY21zX3BiLmpzJyk7Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gaG9zdG5hbWUKICogQHBhcmFtIHs/T2JqZWN0fSBjcmVkZW50aWFscwogKiBAcGFyYW0gez9PYmplY3R9IG9wdGlvbnMKICogQGNvbnN0cnVjdG9yCiAqIEBzdHJ1Y3QKICogQGZpbmFsCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudCA9IGZ1bmN0aW9uIChob3N0bmFtZSwgY3JlZGVudGlhbHMsIG9wdGlvbnMpIHsKICBpZiAoIW9wdGlvbnMpIG9wdGlvbnMgPSB7fTsKICBvcHRpb25zWydmb3JtYXQnXSA9ICd0ZXh0JzsKICAvKioKICAgKiBAcHJpdmF0ZSBAY29uc3QgeyFncnBjLndlYi5HcnBjV2ViQ2xpZW50QmFzZX0gVGhlIGNsaWVudAogICAqLwoKICB0aGlzLmNsaWVudF8gPSBuZXcgZ3JwYy53ZWIuR3JwY1dlYkNsaWVudEJhc2Uob3B0aW9ucyk7CiAgLyoqCiAgICogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9IFRoZSBob3N0bmFtZQogICAqLwoKICB0aGlzLmhvc3RuYW1lXyA9IGhvc3RuYW1lOwp9OwovKioKICogQHBhcmFtIHtzdHJpbmd9IGhvc3RuYW1lCiAqIEBwYXJhbSB7P09iamVjdH0gY3JlZGVudGlhbHMKICogQHBhcmFtIHs/T2JqZWN0fSBvcHRpb25zCiAqIEBjb25zdHJ1Y3RvcgogKiBAc3RydWN0CiAqIEBmaW5hbAogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudCA9IGZ1bmN0aW9uIChob3N0bmFtZSwgY3JlZGVudGlhbHMsIG9wdGlvbnMpIHsKICBpZiAoIW9wdGlvbnMpIG9wdGlvbnMgPSB7fTsKICBvcHRpb25zWydmb3JtYXQnXSA9ICd0ZXh0JzsKICAvKioKICAgKiBAcHJpdmF0ZSBAY29uc3QgeyFncnBjLndlYi5HcnBjV2ViQ2xpZW50QmFzZX0gVGhlIGNsaWVudAogICAqLwoKICB0aGlzLmNsaWVudF8gPSBuZXcgZ3JwYy53ZWIuR3JwY1dlYkNsaWVudEJhc2Uob3B0aW9ucyk7CiAgLyoqCiAgICogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9IFRoZSBob3N0bmFtZQogICAqLwoKICB0aGlzLmhvc3RuYW1lXyA9IGhvc3RuYW1lOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuRW1wdHksCiAqICAgIXByb3RvLnBiLmNtcy5BcmVhTGlzdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXJlYUxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0QXJlYUxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCB1c2VydHlwZV9wYi5FbXB0eSwgcHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BcmVhTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldEFyZWFMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5BcmVhTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRW1wdHl9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQXJlYUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuQXJlYUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldEFyZWFMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBcmVhTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcmVhTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRW1wdHl9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkFyZWFMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0QXJlYUxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBcmVhTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcmVhTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuTG9naW5SZXF1ZXN0LAogKiAgICFwcm90by5wYi5BZG1pbj59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0xvZ2luID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0xvZ2luJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkxvZ2luUmVxdWVzdCwgY21zdHlwZV9wYi5BZG1pbiwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Mb2dpblJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLkFkbWluLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuTG9naW5SZXF1ZXN0LAogKiAgICFwcm90by5wYi5BZG1pbj59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfTG9naW4gPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5BZG1pbiwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Mb2dpblJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLkFkbWluLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Mb2dpblJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFkbWluKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQWRtaW4+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvTG9naW4nLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfTG9naW4sIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Mb2dpblJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuQWRtaW4+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9Mb2dpbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19Mb2dpbik7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuQWRtaW4+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBZG1pbkluZm8gPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0QWRtaW5JbmZvJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgdXNlcnR5cGVfcGIuRW1wdHksIGNtc3R5cGVfcGIuQWRtaW4sCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQWRtaW4uZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLkVtcHR5LAogKiAgICFwcm90by5wYi5BZG1pbj59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0QWRtaW5JbmZvID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGNtc3R5cGVfcGIuQWRtaW4sCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQWRtaW4uZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRW1wdHl9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFkbWluKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQWRtaW4+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRBZG1pbkluZm8gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEFkbWluSW5mbycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBZG1pbkluZm8sIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkFkbWluPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEFkbWluSW5mbyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEFkbWluSW5mbycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBZG1pbkluZm8pOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVwbHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRPdmVydmlldyA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRPdmVydmlldycsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5PdmVydmlld1JlcXVlc3QsIHByb3RvLnBiLmNtcy5PdmVydmlld1JlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5PdmVydmlld1JlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0T3ZlcnZpZXcgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldE92ZXJ2aWV3ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRPdmVydmlldycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRPdmVydmlldywgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLk92ZXJ2aWV3UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuT3ZlcnZpZXdSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRPdmVydmlldyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldE92ZXJ2aWV3JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldE92ZXJ2aWV3KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0SG9tZVN0YXQgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0SG9tZVN0YXQnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuSG9tZVN0YXRSZXF1ZXN0LCBwcm90by5wYi5jbXMuSG9tZVN0YXRSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuSG9tZVN0YXRSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldEhvbWVTdGF0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5Ib21lU3RhdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRIb21lU3RhdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0SG9tZVN0YXQnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0SG9tZVN0YXQsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Ib21lU3RhdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkhvbWVTdGF0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0SG9tZVN0YXQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRIb21lU3RhdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRIb21lU3RhdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFyZWFTdGF0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldEFyZWFTdGF0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkFyZWFTdGF0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkFyZWFTdGF0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFyZWFTdGF0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRBcmVhU3RhdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQXJlYVN0YXRSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQXJlYVN0YXRSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQXJlYVN0YXRSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QXJlYVN0YXQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEFyZWFTdGF0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFyZWFTdGF0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXJlYVN0YXRSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5BcmVhU3RhdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEFyZWFTdGF0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXJlYVN0YXQnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXJlYVN0YXQpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QW5jaG9yU3RhdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JTdGF0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXF1ZXN0LCBwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRBbmNob3JTdGF0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5BbmNob3JTdGF0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BbmNob3JTdGF0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLkFuY2hvclN0YXRSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5BbmNob3JTdGF0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRBbmNob3JTdGF0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JTdGF0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFuY2hvclN0YXQsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BbmNob3JTdGF0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuQW5jaG9yU3RhdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEFuY2hvclN0YXQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JTdGF0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFuY2hvclN0YXQpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuQWRtaW4sCiAqICAgIXByb3RvLnBiLkFkbWluPn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZUFkbWluID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVBZG1pbicsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIGNtc3R5cGVfcGIuQWRtaW4sIGNtc3R5cGVfcGIuQWRtaW4sCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BZG1pbn0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQWRtaW4uZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLkFkbWluLAogKiAgICFwcm90by5wYi5BZG1pbj59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfU2F2ZUFkbWluID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGNtc3R5cGVfcGIuQWRtaW4sCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BZG1pbn0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQWRtaW4uZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQWRtaW59IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFkbWluKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQWRtaW4+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zYXZlQWRtaW4gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBZG1pbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQWRtaW4sIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFkbWlufSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkFkbWluPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVBZG1pbiA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBZG1pbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQWRtaW4pOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuRW1wdHksCiAqICAgIXByb3RvLnBiLmNtcy5BZG1pbkxpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFkbWluTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBZG1pbkxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCB1c2VydHlwZV9wYi5FbXB0eSwgcHJvdG8ucGIuY21zLkFkbWluTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuRW1wdHl9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQWRtaW5MaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLkVtcHR5LAogKiAgICFwcm90by5wYi5jbXMuQWRtaW5MaXN0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldEFkbWluTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQWRtaW5MaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BZG1pbkxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLkFkbWluTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkFkbWluTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QWRtaW5MaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBZG1pbkxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QWRtaW5MaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuQWRtaW5MaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0QWRtaW5MaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QWRtaW5MaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFkbWluTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5HdWlsZCwKICogICAhcHJvdG8ucGIuR3VpbGQ+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlR3VpbGQgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZUd1aWxkJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgY21zdHlwZV9wYi5HdWlsZCwgY21zdHlwZV9wYi5HdWlsZCwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkd1aWxkfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5HdWlsZC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuR3VpbGQsCiAqICAgIXByb3RvLnBiLkd1aWxkPn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19TYXZlR3VpbGQgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5HdWlsZCwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkd1aWxkfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5HdWlsZC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5HdWlsZH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuR3VpbGQpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5HdWlsZD58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVHdWlsZCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUd1aWxkJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVHdWlsZCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuR3VpbGR9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuR3VpbGQ+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuc2F2ZUd1aWxkID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUd1aWxkJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVHdWlsZCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5FbXB0eSwKICogICAhcHJvdG8ucGIuY21zLkd1aWxkTGlzdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0R3VpbGRMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldEd1aWxkTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHVzZXJ0eXBlX3BiLkVtcHR5LCBwcm90by5wYi5jbXMuR3VpbGRMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5FbXB0eX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5HdWlsZExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuRW1wdHksCiAqICAgIXByb3RvLnBiLmNtcy5HdWlsZExpc3RSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0R3VpbGRMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5HdWlsZExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkd1aWxkTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuR3VpbGRMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuR3VpbGRMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRHdWlsZExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEd1aWxkTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRHdWlsZExpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkVtcHR5fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5HdWlsZExpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRHdWlsZExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRHdWlsZExpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0R3VpbGRMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvckxpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFuY2hvckxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0QW5jaG9yTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkFuY2hvckxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvckxpc3RSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0QW5jaG9yTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFuY2hvckxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFuY2hvckxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BbmNob3JMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QW5jaG9yTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QW5jaG9yTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBbmNob3JMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkFuY2hvckxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRBbmNob3JMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QW5jaG9yTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBbmNob3JMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0VXNlckxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0VXNlckxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuVXNlckxpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuVXNlckxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuVXNlckxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldFVzZXJMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRVc2VyTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0VXNlckxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0VXNlckxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Vc2VyTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLlVzZXJMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0VXNlckxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRVc2VyTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRVc2VyTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQWRqdXN0QmFsYW5jZVJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVwbHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19BZGp1c3RCYWxhbmNlID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0FkanVzdEJhbGFuY2UnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQWRqdXN0QmFsYW5jZVJlcXVlc3QsIHByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQWRqdXN0QmFsYW5jZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQWRqdXN0QmFsYW5jZVJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuQWRqdXN0QmFsYW5jZVJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0FkanVzdEJhbGFuY2UgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQWRqdXN0QmFsYW5jZVJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmFkanVzdEJhbGFuY2UgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0FkanVzdEJhbGFuY2UnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfQWRqdXN0QmFsYW5jZSwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFkanVzdEJhbGFuY2VSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5BZGp1c3RCYWxhbmNlUmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuYWRqdXN0QmFsYW5jZSA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0FkanVzdEJhbGFuY2UnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfQWRqdXN0QmFsYW5jZSk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5Vc2VyLAogKiAgICFwcm90by5wYi5Vc2VyPn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVXBkYXRlVXNlciA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9VcGRhdGVVc2VyJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgdXNlcnR5cGVfcGIuVXNlciwgdXNlcnR5cGVfcGIuVXNlciwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLlVzZXJ9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5Vc2VyLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5Vc2VyLAogKiAgICFwcm90by5wYi5Vc2VyPn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19VcGRhdGVVc2VyID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLlVzZXIsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Vc2VyfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuVXNlci5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Vc2VyfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5Vc2VyKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuVXNlcj58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnVwZGF0ZVVzZXIgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1VwZGF0ZVVzZXInLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVXBkYXRlVXNlciwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuVXNlcn0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5Vc2VyPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnVwZGF0ZVVzZXIgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9VcGRhdGVVc2VyJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1VwZGF0ZVVzZXIpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuQW5jaG9yQmFzaWMsCiAqICAgIXByb3RvLnBiLkFuY2hvckJhc2ljPn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVXBkYXRlQW5jaG9yQmFzaWMgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvVXBkYXRlQW5jaG9yQmFzaWMnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBhbmNob3J0eXBlX3BiLkFuY2hvckJhc2ljLCBhbmNob3J0eXBlX3BiLkFuY2hvckJhc2ljLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBhbmNob3J0eXBlX3BiLkFuY2hvckJhc2ljLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5BbmNob3JCYXNpYywKICogICAhcHJvdG8ucGIuQW5jaG9yQmFzaWM+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX1VwZGF0ZUFuY2hvckJhc2ljID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGFuY2hvcnR5cGVfcGIuQW5jaG9yQmFzaWMsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JCYXNpY30gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGFuY2hvcnR5cGVfcGIuQW5jaG9yQmFzaWMuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQW5jaG9yQmFzaWN9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFuY2hvckJhc2ljKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQW5jaG9yQmFzaWM+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS51cGRhdGVBbmNob3JCYXNpYyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvVXBkYXRlQW5jaG9yQmFzaWMnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVXBkYXRlQW5jaG9yQmFzaWMsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFuY2hvckJhc2ljfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkFuY2hvckJhc2ljPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnVwZGF0ZUFuY2hvckJhc2ljID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvVXBkYXRlQW5jaG9yQmFzaWMnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfVXBkYXRlQW5jaG9yQmFzaWMpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkJsb2NrUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19CbG9jayA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9CbG9jaycsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5CbG9ja1JlcXVlc3QsIHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkJsb2NrUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLkVtcHR5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuQmxvY2tSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfQmxvY2sgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQmxvY2tSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkJsb2NrUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuRW1wdHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5FbXB0eT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmJsb2NrID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9CbG9jaycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19CbG9jaywgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkJsb2NrUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5FbXB0eT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5ibG9jayA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0Jsb2NrJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0Jsb2NrKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5VbmJsb2NrUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19VbmJsb2NrID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1VuYmxvY2snLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuVW5ibG9ja1JlcXVlc3QsIHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlVuYmxvY2tSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5VbmJsb2NrUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX1VuYmxvY2sgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVW5ibG9ja1JlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVW5ibG9ja1JlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkVtcHR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuRW1wdHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS51bmJsb2NrID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9VbmJsb2NrJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1VuYmxvY2ssIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5VbmJsb2NrUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5FbXB0eT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS51bmJsb2NrID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvVW5ibG9jaycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19VbmJsb2NrKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5NaWdyYXRlUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19NaWdyYXRlID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL01pZ3JhdGUnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuTWlncmF0ZVJlcXVlc3QsIHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLk1pZ3JhdGVSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5NaWdyYXRlUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX01pZ3JhdGUgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTWlncmF0ZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTWlncmF0ZVJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkVtcHR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuRW1wdHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5taWdyYXRlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9NaWdyYXRlJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX01pZ3JhdGUsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5NaWdyYXRlUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5FbXB0eT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5taWdyYXRlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvTWlncmF0ZScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19NaWdyYXRlKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5BdXRob3JpemVBbmNob3JSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0F1dGhvcml6ZUFuY2hvciA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9BdXRob3JpemVBbmNob3InLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQXV0aG9yaXplQW5jaG9yUmVxdWVzdCwgdXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXV0aG9yaXplQW5jaG9yUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLkVtcHR5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuQXV0aG9yaXplQW5jaG9yUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0F1dGhvcml6ZUFuY2hvciA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyh1c2VydHlwZV9wYi5FbXB0eSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BdXRob3JpemVBbmNob3JSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dGhvcml6ZUFuY2hvclJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkVtcHR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuRW1wdHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5hdXRob3JpemVBbmNob3IgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0F1dGhvcml6ZUFuY2hvcicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19BdXRob3JpemVBbmNob3IsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BdXRob3JpemVBbmNob3JSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkVtcHR5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmF1dGhvcml6ZUFuY2hvciA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0F1dGhvcml6ZUFuY2hvcicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19BdXRob3JpemVBbmNob3IpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QW5jaG9yRnVsbCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JGdWxsJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXF1ZXN0LCBwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRBbmNob3JGdWxsID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5BbmNob3JGdWxsUmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BbmNob3JGdWxsUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLkFuY2hvckZ1bGxSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5BbmNob3JGdWxsUmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRBbmNob3JGdWxsID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JGdWxsJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFuY2hvckZ1bGwsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BbmNob3JGdWxsUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuQW5jaG9yRnVsbFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEFuY2hvckZ1bGwgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRBbmNob3JGdWxsJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFuY2hvckZ1bGwpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRQcm9maWxlTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRQcm9maWxlTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5Qcm9maWxlTGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5Qcm9maWxlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5Qcm9maWxlTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0UHJvZmlsZUxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldFByb2ZpbGVMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRQcm9maWxlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRQcm9maWxlTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2ZpbGVMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuUHJvZmlsZUxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRQcm9maWxlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFByb2ZpbGVMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFByb2ZpbGVMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5Qcm9jZXNzUHJvZmlsZVJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkFuY2hvclByb2ZpbGU+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19Qcm9jZXNzUHJvZmlsZSA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9Qcm9jZXNzUHJvZmlsZScsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5Qcm9jZXNzUHJvZmlsZVJlcXVlc3QsIGFuY2hvcnR5cGVfcGIuQW5jaG9yUHJvZmlsZSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Qcm9jZXNzUHJvZmlsZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBhbmNob3J0eXBlX3BiLkFuY2hvclByb2ZpbGUuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5Qcm9jZXNzUHJvZmlsZVJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkFuY2hvclByb2ZpbGU+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX1Byb2Nlc3NQcm9maWxlID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGFuY2hvcnR5cGVfcGIuQW5jaG9yUHJvZmlsZSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Qcm9jZXNzUHJvZmlsZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBhbmNob3J0eXBlX3BiLkFuY2hvclByb2ZpbGUuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2Nlc3NQcm9maWxlUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuQW5jaG9yUHJvZmlsZSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLkFuY2hvclByb2ZpbGU+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5wcm9jZXNzUHJvZmlsZSA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvUHJvY2Vzc1Byb2ZpbGUnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfUHJvY2Vzc1Byb2ZpbGUsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Qcm9jZXNzUHJvZmlsZVJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuQW5jaG9yUHJvZmlsZT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5wcm9jZXNzUHJvZmlsZSA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1Byb2Nlc3NQcm9maWxlJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1Byb2Nlc3NQcm9maWxlKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFZpb2xhdGlvbkxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0VmlvbGF0aW9uTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0VmlvbGF0aW9uTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuVmlvbGF0aW9uTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVmlvbGF0aW9uTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5WaW9sYXRpb25MaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuVmlvbGF0aW9uTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0VmlvbGF0aW9uTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0VmlvbGF0aW9uTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRWaW9sYXRpb25MaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVmlvbGF0aW9uTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLlZpb2xhdGlvbkxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRWaW9sYXRpb25MaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0VmlvbGF0aW9uTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRWaW9sYXRpb25MaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5Qcm9jZXNzVmlvbGF0aW9uUmVxdWVzdCwKICogICAhcHJvdG8ucGIuVmlvbGF0aW9uUmVjb3JkPn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfUHJvY2Vzc1Zpb2xhdGlvbiA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9Qcm9jZXNzVmlvbGF0aW9uJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLlByb2Nlc3NWaW9sYXRpb25SZXF1ZXN0LCB1c2VydHlwZV9wYi5WaW9sYXRpb25SZWNvcmQsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUHJvY2Vzc1Zpb2xhdGlvblJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5WaW9sYXRpb25SZWNvcmQuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5Qcm9jZXNzVmlvbGF0aW9uUmVxdWVzdCwKICogICAhcHJvdG8ucGIuVmlvbGF0aW9uUmVjb3JkPn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19Qcm9jZXNzVmlvbGF0aW9uID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLlZpb2xhdGlvblJlY29yZCwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Qcm9jZXNzVmlvbGF0aW9uUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLlZpb2xhdGlvblJlY29yZC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUHJvY2Vzc1Zpb2xhdGlvblJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLlZpb2xhdGlvblJlY29yZCl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLlZpb2xhdGlvblJlY29yZD58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnByb2Nlc3NWaW9sYXRpb24gPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1Byb2Nlc3NWaW9sYXRpb24nLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfUHJvY2Vzc1Zpb2xhdGlvbiwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlByb2Nlc3NWaW9sYXRpb25SZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLlZpb2xhdGlvblJlY29yZD59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5wcm9jZXNzVmlvbGF0aW9uID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvUHJvY2Vzc1Zpb2xhdGlvbicsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19Qcm9jZXNzVmlvbGF0aW9uKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0TGl2ZUxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0TGl2ZUxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuTGl2ZUxpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuTGl2ZUxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuTGl2ZUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldExpdmVMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5MaXZlTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRMaXZlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0TGl2ZUxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0TGl2ZUxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5MaXZlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkxpdmVMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0TGl2ZUxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRMaXZlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRMaXZlTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuUGF5TGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRQYXlMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldFBheUxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuUGF5TGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUGF5TGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuUGF5TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuUGF5TGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldFBheUxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLlBheUxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlBheUxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuUGF5TGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLlBheUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldFBheUxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFBheUxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0UGF5TGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlBheUxpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5QYXlMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0UGF5TGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFBheUxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0UGF5TGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuUm9ib3RMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlJvYm90TGlzdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Um9ib3RMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldFJvYm90TGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuUm9ib3RMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUm9ib3RMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlJvYm90TGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0Um9ib3RMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlJvYm90TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuUm9ib3RMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuUm9ib3RMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRSb2JvdExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldFJvYm90TGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRSb2JvdExpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5Sb2JvdExpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRSb2JvdExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRSb2JvdExpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Um9ib3RMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLkFuY2hvclByb2ZpbGUsCiAqICAgIXByb3RvLnBiLkFuY2hvclByb2ZpbGU+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUm9ib3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZVJvYm90JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgYW5jaG9ydHlwZV9wYi5BbmNob3JQcm9maWxlLCBhbmNob3J0eXBlX3BiLkFuY2hvclByb2ZpbGUsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgYW5jaG9ydHlwZV9wYi5BbmNob3JQcm9maWxlLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5BbmNob3JQcm9maWxlLAogKiAgICFwcm90by5wYi5BbmNob3JQcm9maWxlPn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19TYXZlUm9ib3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oYW5jaG9ydHlwZV9wYi5BbmNob3JQcm9maWxlLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGFuY2hvcnR5cGVfcGIuQW5jaG9yUHJvZmlsZS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BbmNob3JQcm9maWxlfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5BbmNob3JQcm9maWxlKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQW5jaG9yUHJvZmlsZT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVSb2JvdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZVJvYm90JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVSb2JvdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQW5jaG9yUHJvZmlsZX0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5BbmNob3JQcm9maWxlPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVSb2JvdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVSb2JvdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUm9ib3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Um9ib3RNZXNzYWdlTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRSb2JvdE1lc3NhZ2VMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRSb2JvdE1lc3NhZ2VMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5Sb2JvdE1lc3NhZ2VMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdE1lc3NhZ2VMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLlJvYm90TWVzc2FnZUxpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5Sb2JvdE1lc3NhZ2VMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRSb2JvdE1lc3NhZ2VMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRSb2JvdE1lc3NhZ2VMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFJvYm90TWVzc2FnZUxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Sb2JvdE1lc3NhZ2VMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuUm9ib3RNZXNzYWdlTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldFJvYm90TWVzc2FnZUxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRSb2JvdE1lc3NhZ2VMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFJvYm90TWVzc2FnZUxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuUm9ib3RNZXNzYWdlLAogKiAgICFwcm90by5wYi5Sb2JvdE1lc3NhZ2U+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUm9ib3RNZXNzYWdlID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVSb2JvdE1lc3NhZ2UnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBjbXN0eXBlX3BiLlJvYm90TWVzc2FnZSwgY21zdHlwZV9wYi5Sb2JvdE1lc3NhZ2UsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Sb2JvdE1lc3NhZ2V9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLlJvYm90TWVzc2FnZS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuUm9ib3RNZXNzYWdlLAogKiAgICFwcm90by5wYi5Sb2JvdE1lc3NhZ2U+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX1NhdmVSb2JvdE1lc3NhZ2UgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8oY21zdHlwZV9wYi5Sb2JvdE1lc3NhZ2UsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Sb2JvdE1lc3NhZ2V9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBjbXN0eXBlX3BiLlJvYm90TWVzc2FnZS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Sb2JvdE1lc3NhZ2V9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLlJvYm90TWVzc2FnZSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLlJvYm90TWVzc2FnZT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVSb2JvdE1lc3NhZ2UgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVSb2JvdE1lc3NhZ2UnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVJvYm90TWVzc2FnZSwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuUm9ib3RNZXNzYWdlfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLlJvYm90TWVzc2FnZT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5zYXZlUm9ib3RNZXNzYWdlID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZVJvYm90TWVzc2FnZScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUm9ib3RNZXNzYWdlKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLk1vbWVudExpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldE1vbWVudExpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0TW9tZW50TGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLk1vbWVudExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLk1vbWVudExpc3RSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0TW9tZW50TGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLk1vbWVudExpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLk1vbWVudExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5Nb21lbnRMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0TW9tZW50TGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0TW9tZW50TGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRNb21lbnRMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuTW9tZW50TGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLk1vbWVudExpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRNb21lbnRMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0TW9tZW50TGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRNb21lbnRMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLk1vbWVudCwKICogICAhcHJvdG8ucGIuTW9tZW50Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZU1vbWVudCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9TYXZlTW9tZW50JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgdXNlcnR5cGVfcGIuTW9tZW50LCB1c2VydHlwZV9wYi5Nb21lbnQsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Nb21lbnR9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5Nb21lbnQuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLk1vbWVudCwKICogICAhcHJvdG8ucGIuTW9tZW50Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19TYXZlTW9tZW50ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLk1vbWVudCwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLk1vbWVudH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLk1vbWVudC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Nb21lbnR9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLk1vbWVudCl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLk1vbWVudD58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVNb21lbnQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVNb21lbnQnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZU1vbWVudCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuTW9tZW50fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLk1vbWVudD59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5zYXZlTW9tZW50ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZU1vbWVudCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlTW9tZW50KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5BdXRvTWVzc2FnZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXV0b01lc3NhZ2VMaXN0UmVwbHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBdXRvTWVzc2FnZUxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0QXV0b01lc3NhZ2VMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcXVlc3QsIHByb3RvLnBiLmNtcy5BdXRvTWVzc2FnZUxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BdXRvTWVzc2FnZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuQXV0b01lc3NhZ2VMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRBdXRvTWVzc2FnZUxpc3QgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQXV0b01lc3NhZ2VMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BdXRvTWVzc2FnZUxpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5BdXRvTWVzc2FnZUxpc3RSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLmdldEF1dG9NZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXV0b01lc3NhZ2VMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEF1dG9NZXNzYWdlTGlzdCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkF1dG9NZXNzYWdlTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEF1dG9NZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEF1dG9NZXNzYWdlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBdXRvTWVzc2FnZUxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuQXV0b01lc3NhZ2UsCiAqICAgIXByb3RvLnBiLkF1dG9NZXNzYWdlPn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZUF1dG9NZXNzYWdlID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVBdXRvTWVzc2FnZScsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIGNtc3R5cGVfcGIuQXV0b01lc3NhZ2UsIGNtc3R5cGVfcGIuQXV0b01lc3NhZ2UsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BdXRvTWVzc2FnZX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQXV0b01lc3NhZ2UuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLkF1dG9NZXNzYWdlLAogKiAgICFwcm90by5wYi5BdXRvTWVzc2FnZT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfU2F2ZUF1dG9NZXNzYWdlID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGNtc3R5cGVfcGIuQXV0b01lc3NhZ2UsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BdXRvTWVzc2FnZX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIGNtc3R5cGVfcGIuQXV0b01lc3NhZ2UuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXV0b01lc3NhZ2V9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkF1dG9NZXNzYWdlKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQXV0b01lc3NhZ2U+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zYXZlQXV0b01lc3NhZ2UgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBdXRvTWVzc2FnZScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQXV0b01lc3NhZ2UsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkF1dG9NZXNzYWdlfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkF1dG9NZXNzYWdlPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVBdXRvTWVzc2FnZSA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBdXRvTWVzc2FnZScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQXV0b01lc3NhZ2UpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5DaGF0TWVzc2FnZUxpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENoYXRNZXNzYWdlTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRDaGF0TWVzc2FnZUxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5DaGF0TWVzc2FnZUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldENoYXRNZXNzYWdlTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5DaGF0TWVzc2FnZUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLkNoYXRNZXNzYWdlTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0Q2hhdE1lc3NhZ2VMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRDaGF0TWVzc2FnZUxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q2hhdE1lc3NhZ2VMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuQ2hhdE1lc3NhZ2VMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0Q2hhdE1lc3NhZ2VMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Q2hhdE1lc3NhZ2VMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENoYXRNZXNzYWdlTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQ2FsbExpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENhbGxMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldENhbGxMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkNhbGxMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkNhbGxMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ2FsbExpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkNhbGxMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRDYWxsTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ2FsbExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQ2FsbExpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0Q2FsbExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldENhbGxMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENhbGxMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ2FsbExpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5DYWxsTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldENhbGxMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Q2FsbExpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q2FsbExpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFRyYW5zYWN0aW9uTGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRUcmFuc2FjdGlvbkxpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldFRyYW5zYWN0aW9uTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5UcmFuc2FjdGlvbkxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLlRyYW5zYWN0aW9uTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0VHJhbnNhY3Rpb25MaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRUcmFuc2FjdGlvbkxpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0VHJhbnNhY3Rpb25MaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuVHJhbnNhY3Rpb25MaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0VHJhbnNhY3Rpb25MaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0VHJhbnNhY3Rpb25MaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFRyYW5zYWN0aW9uTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQ3JlYXRlU2V0dGxlUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19DcmVhdGVTZXR0bGVSZWNvcmQgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvQ3JlYXRlU2V0dGxlUmVjb3JkJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkNyZWF0ZVNldHRsZVJlcXVlc3QsIHVzZXJ0eXBlX3BiLkVtcHR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNyZWF0ZVNldHRsZVJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5FbXB0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkNyZWF0ZVNldHRsZVJlcXVlc3QsCiAqICAgIXByb3RvLnBiLkVtcHR5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19DcmVhdGVTZXR0bGVSZWNvcmQgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ3JlYXRlU2V0dGxlUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLkVtcHR5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5DcmVhdGVTZXR0bGVSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5FbXB0eSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLkVtcHR5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuY3JlYXRlU2V0dGxlUmVjb3JkID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9DcmVhdGVTZXR0bGVSZWNvcmQnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfQ3JlYXRlU2V0dGxlUmVjb3JkLCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ3JlYXRlU2V0dGxlUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5FbXB0eT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5jcmVhdGVTZXR0bGVSZWNvcmQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9DcmVhdGVTZXR0bGVSZWNvcmQnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfQ3JlYXRlU2V0dGxlUmVjb3JkKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5TdWJtaXRTZXR0bGVSZXF1ZXN0LAogKiAgICFwcm90by5wYi5FbXB0eT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1N1Ym1pdFNldHRsZVJlY29yZCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9TdWJtaXRTZXR0bGVSZWNvcmQnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuU3VibWl0U2V0dGxlUmVxdWVzdCwgdXNlcnR5cGVfcGIuRW1wdHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuU3VibWl0U2V0dGxlUmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLkVtcHR5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5jbXMuU3VibWl0U2V0dGxlUmVxdWVzdCwKICogICAhcHJvdG8ucGIuRW1wdHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX1N1Ym1pdFNldHRsZVJlY29yZCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyh1c2VydHlwZV9wYi5FbXB0eSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TdWJtaXRTZXR0bGVSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuRW1wdHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlN1Ym1pdFNldHRsZVJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkVtcHR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuRW1wdHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zdWJtaXRTZXR0bGVSZWNvcmQgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1N1Ym1pdFNldHRsZVJlY29yZCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TdWJtaXRTZXR0bGVSZWNvcmQsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TdWJtaXRTZXR0bGVSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkVtcHR5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnN1Ym1pdFNldHRsZVJlY29yZCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1N1Ym1pdFNldHRsZVJlY29yZCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TdWJtaXRTZXR0bGVSZWNvcmQpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVwbHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19RdWVyeVNldHRsZVByb2dyZXNzID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1F1ZXJ5U2V0dGxlUHJvZ3Jlc3MnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXF1ZXN0LCBwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TZXR0bGVQcm9ncmVzc1JlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX1F1ZXJ5U2V0dGxlUHJvZ3Jlc3MgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8ocHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXBseT58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnF1ZXJ5U2V0dGxlUHJvZ3Jlc3MgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1F1ZXJ5U2V0dGxlUHJvZ3Jlc3MnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfUXVlcnlTZXR0bGVQcm9ncmVzcywgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlNldHRsZVByb2dyZXNzUmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuU2V0dGxlUHJvZ3Jlc3NSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5xdWVyeVNldHRsZVByb2dyZXNzID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvUXVlcnlTZXR0bGVQcm9ncmVzcycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19RdWVyeVNldHRsZVByb2dyZXNzKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldFNldHRsZUxpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0U2V0dGxlTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0U2V0dGxlTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuU2V0dGxlTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuU2V0dGxlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5TZXR0bGVMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuU2V0dGxlTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0U2V0dGxlTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0U2V0dGxlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRTZXR0bGVMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuU2V0dGxlTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLlNldHRsZUxpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRTZXR0bGVMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0U2V0dGxlTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRTZXR0bGVMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5BcHBMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkFwcExpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFwcExpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0QXBwTGlzdCcsIGdycGMud2ViLk1ldGhvZFR5cGUuVU5BUlksIHByb3RvLnBiLmNtcy5BcHBMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkFwcExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BcHBMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5BcHBMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5BcHBMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLkFwcExpc3RSZXBseT59CiAqLwoKY29uc3QgbWV0aG9kSW5mb19DbXNTZGtfR2V0QXBwTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQXBwTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkFwcExpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFwcExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXBwTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5BcHBMaXN0UmVwbHkpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5jbXMuQXBwTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QXBwTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXBwTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcHBMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXBwTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLkFwcExpc3RSZXBseT59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5nZXRBcHBMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXBwTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRBcHBMaXN0KTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLkFwcCwKICogICAhcHJvdG8ucGIuQXBwPn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZUFwcCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9TYXZlQXBwJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgY21zdHlwZV9wYi5BcHAsIGNtc3R5cGVfcGIuQXBwLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXBwfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5BcHAuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLkFwcCwKICogICAhcHJvdG8ucGIuQXBwPn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19TYXZlQXBwID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKGNtc3R5cGVfcGIuQXBwLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXBwfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5BcHAuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQXBwfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5BcHApfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5BcHA+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zYXZlQXBwID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlQXBwJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVBcHAsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFwcH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5BcHA+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuc2F2ZUFwcCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBcHAnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZUFwcCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFyZWFDb25maWdMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldEFyZWFDb25maWdMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkFyZWFDb25maWdMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkFyZWFDb25maWdMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkFyZWFDb25maWdMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRBcmVhQ29uZmlnTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0QXJlYUNvbmZpZ0xpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldEFyZWFDb25maWdMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldEFyZWFDb25maWdMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQXJlYUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5BcmVhQ29uZmlnTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldEFyZWFDb25maWdMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0QXJlYUNvbmZpZ0xpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0QXJlYUNvbmZpZ0xpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuQXJlYUNvbmZpZywKICogICAhcHJvdG8ucGIuQXJlYUNvbmZpZz59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVBcmVhQ29uZmlnID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVBcmVhQ29uZmlnJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgY21zdHlwZV9wYi5BcmVhQ29uZmlnLCBjbXN0eXBlX3BiLkFyZWFDb25maWcsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BcmVhQ29uZmlnfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5BcmVhQ29uZmlnLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5BcmVhQ29uZmlnLAogKiAgICFwcm90by5wYi5BcmVhQ29uZmlnPn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19TYXZlQXJlYUNvbmZpZyA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhjbXN0eXBlX3BiLkFyZWFDb25maWcsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BcmVhQ29uZmlnfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgY21zdHlwZV9wYi5BcmVhQ29uZmlnLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkFyZWFDb25maWd9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLkFyZWFDb25maWcpfQogKiAgICAgY2FsbGJhY2sgVGhlIGNhbGxiYWNrIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSkKICogQHJldHVybiB7IWdycGMud2ViLkNsaWVudFJlYWRhYmxlU3RyZWFtPCFwcm90by5wYi5BcmVhQ29uZmlnPnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuc2F2ZUFyZWFDb25maWcgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVBcmVhQ29uZmlnJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVBcmVhQ29uZmlnLCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5BcmVhQ29uZmlnfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLkFyZWFDb25maWc+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuc2F2ZUFyZWFDb25maWcgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlQXJlYUNvbmZpZycsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQXJlYUNvbmZpZyk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseT59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENvdW50cnlDb25maWdMaXN0ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL0dldENvdW50cnlDb25maWdMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkNvdW50cnlDb25maWdMaXN0UmVxdWVzdCwgcHJvdG8ucGIuY21zLkNvdW50cnlDb25maWdMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkNvdW50cnlDb25maWdMaXN0UmVwbHkuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRDb3VudHJ5Q29uZmlnTGlzdCA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyhwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcGx5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuZ2V0Q291bnRyeUNvbmZpZ0xpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEsIGNhbGxiYWNrKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy5ycGNDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL0dldENvdW50cnlDb25maWdMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENvdW50cnlDb25maWdMaXN0LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ291bnRyeUNvbmZpZ0xpc3RSZXF1ZXN0fSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHJldHVybiB7IVByb21pc2U8IXByb3RvLnBiLmNtcy5Db3VudHJ5Q29uZmlnTGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldENvdW50cnlDb25maWdMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0Q291bnRyeUNvbmZpZ0xpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q291bnRyeUNvbmZpZ0xpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuQ291bnRyeUNvbmZpZywKICogICAhcHJvdG8ucGIuQ291bnRyeUNvbmZpZz59CiAqLwoKCmNvbnN0IG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVDb3VudHJ5Q29uZmlnID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVDb3VudHJ5Q29uZmlnJywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgdXNlcnR5cGVfcGIuQ291bnRyeUNvbmZpZywgdXNlcnR5cGVfcGIuQ291bnRyeUNvbmZpZywKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkNvdW50cnlDb25maWd9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCB1c2VydHlwZV9wYi5Db3VudHJ5Q29uZmlnLmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvPAogKiAgICFwcm90by5wYi5Db3VudHJ5Q29uZmlnLAogKiAgICFwcm90by5wYi5Db3VudHJ5Q29uZmlnPn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19TYXZlQ291bnRyeUNvbmZpZyA9IG5ldyBncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbyh1c2VydHlwZV9wYi5Db3VudHJ5Q29uZmlnLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQ291bnRyeUNvbmZpZ30gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLkNvdW50cnlDb25maWcuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQ291bnRyeUNvbmZpZ30gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuQ291bnRyeUNvbmZpZyl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLkNvdW50cnlDb25maWc+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5zYXZlQ291bnRyeUNvbmZpZyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUNvdW50cnlDb25maWcnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZUNvdW50cnlDb25maWcsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkNvdW50cnlDb25maWd9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuQ291bnRyeUNvbmZpZz59CiAqICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlCiAqLwoKCnByb3RvLnBiLmNtcy5DbXNTZGtQcm9taXNlQ2xpZW50LnByb3RvdHlwZS5zYXZlQ291bnRyeUNvbmZpZyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSkgewogIHJldHVybiB0aGlzLmNsaWVudF8udW5hcnlDYWxsKHRoaXMuaG9zdG5hbWVfICsgJy9wYi5jbXMuQ21zU2RrL1NhdmVDb3VudHJ5Q29uZmlnJywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVDb3VudHJ5Q29uZmlnKTsKfTsKLyoqCiAqIEBjb25zdAogKiBAdHlwZSB7IWdycGMud2ViLk1ldGhvZERlc2NyaXB0b3I8CiAqICAgIXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcXVlc3QsCiAqICAgIXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0UGF5Q2hhbm5lbExpc3QgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvR2V0UGF5Q2hhbm5lbExpc3QnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCBwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXBseSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuUGF5Q2hhbm5lbExpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVxdWVzdCwKICogICAhcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVwbHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX0dldFBheUNoYW5uZWxMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVxdWVzdH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcGFyYW0ge2Z1bmN0aW9uKD9ncnBjLndlYi5FcnJvciwgP3Byb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcGx5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRQYXlDaGFubmVsTGlzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvR2V0UGF5Q2hhbm5lbExpc3QnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0UGF5Q2hhbm5lbExpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5QYXlDaGFubmVsTGlzdFJlcXVlc3R9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuY21zLlBheUNoYW5uZWxMaXN0UmVwbHk+fQogKiAgICAgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNwb25zZQogKi8KCgpwcm90by5wYi5jbXMuQ21zU2RrUHJvbWlzZUNsaWVudC5wcm90b3R5cGUuZ2V0UGF5Q2hhbm5lbExpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRQYXlDaGFubmVsTGlzdCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19HZXRQYXlDaGFubmVsTGlzdCk7Cn07Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5NZXRob2REZXNjcmlwdG9yPAogKiAgICFwcm90by5wYi5QYXlDaGFubmVsLAogKiAgICFwcm90by5wYi5QYXlDaGFubmVsPn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVBheUNoYW5uZWwgPSBuZXcgZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcignL3BiLmNtcy5DbXNTZGsvU2F2ZVBheUNoYW5uZWwnLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCB1c2VydHlwZV9wYi5QYXlDaGFubmVsLCB1c2VydHlwZV9wYi5QYXlDaGFubmVsLAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuUGF5Q2hhbm5lbH0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLlBheUNoYW5uZWwuZGVzZXJpYWxpemVCaW5hcnkpOwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm88CiAqICAgIXByb3RvLnBiLlBheUNoYW5uZWwsCiAqICAgIXByb3RvLnBiLlBheUNoYW5uZWw+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX1NhdmVQYXlDaGFubmVsID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHVzZXJ0eXBlX3BiLlBheUNoYW5uZWwsCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5QYXlDaGFubmVsfSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuUGF5Q2hhbm5lbC5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5QYXlDaGFubmVsfSByZXF1ZXN0IFRoZQogKiAgICAgcmVxdWVzdCBwcm90bwogKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBtZXRhZGF0YSBVc2VyIGRlZmluZWQKICogICAgIGNhbGwgbWV0YWRhdGEKICogQHBhcmFtIHtmdW5jdGlvbig/Z3JwYy53ZWIuRXJyb3IsID9wcm90by5wYi5QYXlDaGFubmVsKX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuUGF5Q2hhbm5lbD58dW5kZWZpbmVkfQogKiAgICAgVGhlIFhIUiBOb2RlIFJlYWRhYmxlIFN0cmVhbQogKi8KCnByb3RvLnBiLmNtcy5DbXNTZGtDbGllbnQucHJvdG90eXBlLnNhdmVQYXlDaGFubmVsID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlUGF5Q2hhbm5lbCcsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlUGF5Q2hhbm5lbCwgY2FsbGJhY2spOwp9OwovKioKICogQHBhcmFtIHshcHJvdG8ucGIuUGF5Q2hhbm5lbH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5QYXlDaGFubmVsPn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVQYXlDaGFubmVsID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhKSB7CiAgcmV0dXJuIHRoaXMuY2xpZW50Xy51bmFyeUNhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZVBheUNoYW5uZWwnLCByZXF1ZXN0LCBtZXRhZGF0YSB8fCB7fSwgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfU2F2ZVBheUNoYW5uZWwpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5Pn0KICovCgoKY29uc3QgbWV0aG9kRGVzY3JpcHRvcl9DbXNTZGtfR2V0Q29tbW9kaXR5TGlzdCA9IG5ldyBncnBjLndlYi5NZXRob2REZXNjcmlwdG9yKCcvcGIuY21zLkNtc1Nkay9HZXRDb21tb2RpdHlMaXN0JywgZ3JwYy53ZWIuTWV0aG9kVHlwZS5VTkFSWSwgcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXF1ZXN0LCBwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXF1ZXN0fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXBseS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXF1ZXN0LAogKiAgICFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5Pn0KICovCgpjb25zdCBtZXRob2RJbmZvX0Ntc1Nka19HZXRDb21tb2RpdHlMaXN0ID0gbmV3IGdycGMud2ViLkFic3RyYWN0Q2xpZW50QmFzZS5NZXRob2RJbmZvKHByb3RvLnBiLmNtcy5Db21tb2RpdHlMaXN0UmVwbHksCi8qKgogKiBAcGFyYW0geyFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcXVlc3R9IHJlcXVlc3QKICogQHJldHVybiB7IVVpbnQ4QXJyYXl9CiAqLwpmdW5jdGlvbiAocmVxdWVzdCkgewogIHJldHVybiByZXF1ZXN0LnNlcmlhbGl6ZUJpbmFyeSgpOwp9LCBwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Db21tb2RpdHlMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuY21zLkNvbW1vZGl0eUxpc3RSZXBseSl9CiAqICAgICBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlKQogKiBAcmV0dXJuIHshZ3JwYy53ZWIuQ2xpZW50UmVhZGFibGVTdHJlYW08IXByb3RvLnBiLmNtcy5Db21tb2RpdHlMaXN0UmVwbHk+fHVuZGVmaW5lZH0KICogICAgIFRoZSBYSFIgTm9kZSBSZWFkYWJsZSBTdHJlYW0KICovCgpwcm90by5wYi5jbXMuQ21zU2RrQ2xpZW50LnByb3RvdHlwZS5nZXRDb21tb2RpdHlMaXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIG1ldGFkYXRhLCBjYWxsYmFjaykgewogIHJldHVybiB0aGlzLmNsaWVudF8ucnBjQ2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRDb21tb2RpdHlMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENvbW1vZGl0eUxpc3QsIGNhbGxiYWNrKTsKfTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLmNtcy5Db21tb2RpdHlMaXN0UmVxdWVzdH0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEByZXR1cm4geyFQcm9taXNlPCFwcm90by5wYi5jbXMuQ29tbW9kaXR5TGlzdFJlcGx5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLmdldENvbW1vZGl0eUxpc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9HZXRDb21tb2RpdHlMaXN0JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX0dldENvbW1vZGl0eUxpc3QpOwp9OwovKioKICogQGNvbnN0CiAqIEB0eXBlIHshZ3JwYy53ZWIuTWV0aG9kRGVzY3JpcHRvcjwKICogICAhcHJvdG8ucGIuQ29tbW9kaXR5LAogKiAgICFwcm90by5wYi5Db21tb2RpdHk+fQogKi8KCgpjb25zdCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQ29tbW9kaXR5ID0gbmV3IGdycGMud2ViLk1ldGhvZERlc2NyaXB0b3IoJy9wYi5jbXMuQ21zU2RrL1NhdmVDb21tb2RpdHknLCBncnBjLndlYi5NZXRob2RUeXBlLlVOQVJZLCB1c2VydHlwZV9wYi5Db21tb2RpdHksIHVzZXJ0eXBlX3BiLkNvbW1vZGl0eSwKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkNvbW1vZGl0eX0gcmVxdWVzdAogKiBAcmV0dXJuIHshVWludDhBcnJheX0KICovCmZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgcmV0dXJuIHJlcXVlc3Quc2VyaWFsaXplQmluYXJ5KCk7Cn0sIHVzZXJ0eXBlX3BiLkNvbW1vZGl0eS5kZXNlcmlhbGl6ZUJpbmFyeSk7Ci8qKgogKiBAY29uc3QKICogQHR5cGUgeyFncnBjLndlYi5BYnN0cmFjdENsaWVudEJhc2UuTWV0aG9kSW5mbzwKICogICAhcHJvdG8ucGIuQ29tbW9kaXR5LAogKiAgICFwcm90by5wYi5Db21tb2RpdHk+fQogKi8KCmNvbnN0IG1ldGhvZEluZm9fQ21zU2RrX1NhdmVDb21tb2RpdHkgPSBuZXcgZ3JwYy53ZWIuQWJzdHJhY3RDbGllbnRCYXNlLk1ldGhvZEluZm8odXNlcnR5cGVfcGIuQ29tbW9kaXR5LAovKioKICogQHBhcmFtIHshcHJvdG8ucGIuQ29tbW9kaXR5fSByZXF1ZXN0CiAqIEByZXR1cm4geyFVaW50OEFycmF5fQogKi8KZnVuY3Rpb24gKHJlcXVlc3QpIHsKICByZXR1cm4gcmVxdWVzdC5zZXJpYWxpemVCaW5hcnkoKTsKfSwgdXNlcnR5cGVfcGIuQ29tbW9kaXR5LmRlc2VyaWFsaXplQmluYXJ5KTsKLyoqCiAqIEBwYXJhbSB7IXByb3RvLnBiLkNvbW1vZGl0eX0gcmVxdWVzdCBUaGUKICogICAgIHJlcXVlc3QgcHJvdG8KICogQHBhcmFtIHs/T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gbWV0YWRhdGEgVXNlciBkZWZpbmVkCiAqICAgICBjYWxsIG1ldGFkYXRhCiAqIEBwYXJhbSB7ZnVuY3Rpb24oP2dycGMud2ViLkVycm9yLCA/cHJvdG8ucGIuQ29tbW9kaXR5KX0KICogICAgIGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UpCiAqIEByZXR1cm4geyFncnBjLndlYi5DbGllbnRSZWFkYWJsZVN0cmVhbTwhcHJvdG8ucGIuQ29tbW9kaXR5Pnx1bmRlZmluZWR9CiAqICAgICBUaGUgWEhSIE5vZGUgUmVhZGFibGUgU3RyZWFtCiAqLwoKcHJvdG8ucGIuY21zLkNtc1Nka0NsaWVudC5wcm90b3R5cGUuc2F2ZUNvbW1vZGl0eSA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBtZXRhZGF0YSwgY2FsbGJhY2spIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnJwY0NhbGwodGhpcy5ob3N0bmFtZV8gKyAnL3BiLmNtcy5DbXNTZGsvU2F2ZUNvbW1vZGl0eScsIHJlcXVlc3QsIG1ldGFkYXRhIHx8IHt9LCBtZXRob2REZXNjcmlwdG9yX0Ntc1Nka19TYXZlQ29tbW9kaXR5LCBjYWxsYmFjayk7Cn07Ci8qKgogKiBAcGFyYW0geyFwcm90by5wYi5Db21tb2RpdHl9IHJlcXVlc3QgVGhlCiAqICAgICByZXF1ZXN0IHByb3RvCiAqIEBwYXJhbSB7P09iamVjdDxzdHJpbmcsIHN0cmluZz59IG1ldGFkYXRhIFVzZXIgZGVmaW5lZAogKiAgICAgY2FsbCBtZXRhZGF0YQogKiBAcmV0dXJuIHshUHJvbWlzZTwhcHJvdG8ucGIuQ29tbW9kaXR5Pn0KICogICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UKICovCgoKcHJvdG8ucGIuY21zLkNtc1Nka1Byb21pc2VDbGllbnQucHJvdG90eXBlLnNhdmVDb21tb2RpdHkgPSBmdW5jdGlvbiAocmVxdWVzdCwgbWV0YWRhdGEpIHsKICByZXR1cm4gdGhpcy5jbGllbnRfLnVuYXJ5Q2FsbCh0aGlzLmhvc3RuYW1lXyArICcvcGIuY21zLkNtc1Nkay9TYXZlQ29tbW9kaXR5JywgcmVxdWVzdCwgbWV0YWRhdGEgfHwge30sIG1ldGhvZERlc2NyaXB0b3JfQ21zU2RrX1NhdmVDb21tb2RpdHkpOwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBwcm90by5wYi5jbXM7"},null]}