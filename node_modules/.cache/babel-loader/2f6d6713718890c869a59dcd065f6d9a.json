{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js!/home/mengy/develop/iwork/kafo/vue-admin/node_modules/eslint-loader/index.js??ref--13-0!/home/mengy/develop/iwork/kafo/vue-admin/src/api/services/login.js","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-admin/src/api/services/login.js","mtime":1630312209141},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0iOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvaG9tZS9tZW5neS9kZXZlbG9wL2l3b3JrL2thZm8vdnVlLWFkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvaG9tZS9tZW5neS9kZXZlbG9wL2l3b3JrL2thZm8vdnVlLWFkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL2hvbWUvbWVuZ3kvZGV2ZWxvcC9pd29yay9rYWZvL3Z1ZS1hZG1pbi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgeyBzZXRUb2tlbiwgZ2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2Nvb2tpZSc7Cgp2YXIgX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIF9kZWZhdWx0KGRlcHMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfZGVmYXVsdCk7CgogICAgdGhpcy5wcm90byA9IGRlcHMucHJvdG87CiAgICB0aGlzLmNsaWVudCA9IG5ldyBkZXBzLnByb3RvLkNtc0NsaWVudChwcm9jZXNzLmVudi5WVUVfQVBQX0dSUENfUFJPWFlfVVJJLCBudWxsLCBudWxsKTsKICB9CgogIF9jcmVhdGVDbGFzcyhfZGVmYXVsdCwgW3sKICAgIGtleTogImxvZ2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfbG9naW4gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodXNlciwgY2FsbGJhY2spIHsKICAgICAgICB2YXIgcmVxOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHJlcSA9IG5ldyB0aGlzLnByb3RvLkxvZ2luUmVxdWVzdCgpOwogICAgICAgICAgICAgICAgcmVxLnNldEVtYWlsKHVzZXIuZW1haWwudHJpbSgpKTsKICAgICAgICAgICAgICAgIHJlcS5zZXRQYXNzd29yZCh1c2VyLnBhc3N3b3JkLnRyaW0oKSk7CiAgICAgICAgICAgICAgICB0aGlzLmNsaWVudC5sb2dpbihyZXEsIHt9LCBmdW5jdGlvbiAoZXJyLCByZXNwKSB7CiAgICAgICAgICAgICAgICAgIGlmICghZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0VG9rZW4ocmVzcC5nZXRBY2Nlc3NUb2tlbigpKTsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXNwLmdldEFjY2Vzc1Rva2VuKCkpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gbG9naW4oX3gsIF94MikgewogICAgICAgIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGxvZ2luOwogICAgfSgpCiAgfV0pOwoKICByZXR1cm4gX2RlZmF1bHQ7Cn0oKTsKCmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["/home/mengy/develop/iwork/kafo/vue-admin/src/api/services/login.js"],"names":["setToken","getToken","deps","proto","client","CmsClient","process","env","VUE_APP_GRPC_PROXY_URI","user","callback","req","LoginRequest","setEmail","email","trim","setPassword","password","login","err","resp","getAccessToken","console","log"],"mappings":";;;;;AAAA,SAAQA,QAAR,EAAkBC,QAAlB,QAAiC,gBAAjC;;;AAGI,oBAAaC,IAAb,EAAmB;AAAA;;AACf,SAAKC,KAAL,GAAaD,IAAI,CAACC,KAAlB;AACA,SAAKC,MAAL,GAAc,IAAIF,IAAI,CAACC,KAAL,CAAWE,SAAf,CAAyBC,OAAO,CAACC,GAAR,CAAYC,sBAArC,EAA6D,IAA7D,EAAmE,IAAnE,CAAd;AACH;;;;;4FAEYC,I,EAAMC,Q;;;;;;AACTC,gBAAAA,G,GAAM,IAAI,KAAKR,KAAL,CAAWS,YAAf,E;AACZD,gBAAAA,GAAG,CAACE,QAAJ,CAAaJ,IAAI,CAACK,KAAL,CAAWC,IAAX,EAAb;AACAJ,gBAAAA,GAAG,CAACK,WAAJ,CAAgBP,IAAI,CAACQ,QAAL,CAAcF,IAAd,EAAhB;AACA,qBAAKX,MAAL,CAAYc,KAAZ,CAAkBP,GAAlB,EAAuB,EAAvB,EAA2B,UAACQ,GAAD,EAAMC,IAAN,EAAe;AACtC,sBAAI,CAACD,GAAL,EAAU;AACNnB,oBAAAA,QAAQ,CAACoB,IAAI,CAACC,cAAL,EAAD,CAAR;AACAX,oBAAAA,QAAQ,CAACU,IAAI,CAACC,cAAL,EAAD,CAAR;AACH,mBAHD,MAGO;AACHC,oBAAAA,OAAO,CAACC,GAAR,CAAYJ,GAAZ;AACH;AACJ,iBAPD","sourcesContent":["import {setToken, getToken} from '@/utils/cookie'\n\nexport default class {\n    constructor (deps) {\n        this.proto = deps.proto\n        this.client = new deps.proto.CmsClient(process.env.VUE_APP_GRPC_PROXY_URI, null, null)\n    }\n\n    async login (user, callback) {\n        const req = new this.proto.LoginRequest()\n        req.setEmail(user.email.trim())\n        req.setPassword(user.password.trim())\n        this.client.login(req, {}, (err, resp) => {\n            if (!err) {\n                setToken(resp.getAccessToken())\n                callback(resp.getAccessToken())\n            } else {\n                console.log(err)\n            }\n        })\n    }\n\n\n}\n"]}]}