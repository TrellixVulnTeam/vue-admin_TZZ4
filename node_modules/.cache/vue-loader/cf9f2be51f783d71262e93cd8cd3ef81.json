{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mengy/develop/iwork/kafo/vue-admin/src/views/manage/message/dialog/push.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-admin/src/views/manage/message/dialog/push.vue","mtime":1635418744768},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgeyBib29sRGljdH0gZnJvbSAnQC9kaWN0L2luZGV4JwppbXBvcnQge2dldEFwcExpc3QsIGdldEFyZWFMaXN0LCBnZXRCb29sLCBnZXRDdXJyZW50VXNlckFyZWFJZCwgaW5pdEFyZWFzLCBpbml0R3VpbGRzfSBmcm9tICJAL3V0aWxzL2Rpc3QiOwppbXBvcnQge2dldFRva2VufSBmcm9tICJAL3V0aWxzL2Nvb2tpZSI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAnRm9ybScsCiAgICBjb21wb25lbnRzOiB7IGJvb2xEaWN0fSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZm9ybTogewogICAgICAgICAgICAgICAgYXJlYUlkOiB1bmRlZmluZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYXV0aEFyZWFJZDogZ2V0Q3VycmVudFVzZXJBcmVhSWQoKSwKICAgICAgICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIGltZ0FycjogW10sCiAgICAgICAgICAgIGltZ0RpYWxvZzogZmFsc2UsCiAgICAgICAgICAgIGltZ1VyaTogdW5kZWZpbmVkLAogICAgICAgICAgICBhcmVhRGF0YSA6IGdldEFyZWFMaXN0KGZhbHNlKSwKICAgICAgICAgICAgYXBwTGlzdDogZ2V0QXBwTGlzdCh0cnVlLCB0cnVlKSwKICAgICAgICAgICAgcnVsZXM6IHsKICAgICAgICAgICAgICAgIGFyZWFJZDogWwogICAgICAgICAgICAgICAgICAgIHtyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqScsIHRyaWdnZXI6ICdjaGFuZ2UnfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIG5hbWU6IFsKICAgICAgICAgICAgICAgICAgICB7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICflhoXlrrnkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cid9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgZW5hYmxlOiBbCiAgICAgICAgICAgICAgICAgICAge3JlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn5YaF5a655LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBpbml0KHJvdyl7CiAgICAgICAgICAgIHRoaXMuZm9ybS5hcmVhSWQgPSB0aGlzLmF1dGhBcmVhSWQgPT09IDAgPyB0aGlzLmFyZWFEYXRhWzBdLnZhbHVlIDogdGhpcy5hdXRoQXJlYUlkCiAgICAgICAgfSwKICAgICAgICBzdWJtaXRGb3JtKGZvcm1OYW1lKSB7CiAgICAgICAgICAgIGNvbnN0ICR0aGlzID0gdGhpcwogICAgICAgICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgICAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc2VydmljZS5ndWlsZC5zYXZlR3VpbGQodGhpcy5mb3JtLCBmdW5jdGlvbiAocmVzdWx0KXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5L+d5a2Y5oiQ5YqfISIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0R3VpbGRzKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmNsb3NlRGlhbG9nKCkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLiRtZXNzYWdlLmVycm9yKCLkv53lrZjlpLHotKUhIikKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBjbG9zZURpYWxvZygpIHsKICAgICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgdGhpcy5yZXNldEZvcm0oKQogICAgICAgICAgICB0aGlzLiRlbWl0KCdmZXRjaERhdGEnKTsKICAgICAgICB9LAogICAgICAgIHJlc2V0Rm9ybSgpIHsKICAgICAgICAgICAgdGhpcy4kcmVmcy5ydWxlRm9ybS5yZXNldEZpZWxkcygpCiAgICAgICAgfSwKICAgICAgICBpbWdQcmV2aWV3KGZpbGUpIHsKICAgICAgICAgICAgdGhpcy5pbWdEaWFsb2cgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmltZ1VyaSA9IGZpbGUudXJsCiAgICAgICAgfSwKICAgICAgICBzdWNjZXNzSW1nKGZpbGUpIHsKICAgICAgICAgICAgY29uc3QgJHRoaXMgPSB0aGlzCiAgICAgICAgICAgIHRoaXMuZm9ybUxvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgIHRoaXMuaW1nVXBsb2FkKGZpbGUucmF3LCAxLCBmdW5jdGlvbiAoZGF0YSl7CiAgICAgICAgICAgICAgICAkdGhpcy5mb3JtLmF2YXRhciA9IGRhdGEudXJpCiAgICAgICAgICAgICAgICAkdGhpcy5mb3JtTG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBpbWdVcGxvYWQoZmlsZSwgdHlwZSwgY2FsbGJhY2spewogICAgICAgICAgICBsZXQgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScsCiAgICAgICAgICAgICAgICAidG9rZW4iIDogZ2V0VG9rZW4oKSwKICAgICAgICAgICAgICAgICJhcmVhLWlkIiA6IDEsCiAgICAgICAgICAgICAgICAiZmlsZS10eXBlIiA6IHR5cGUKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGZpbGUpCiAgICAgICAgICAgIGF4aW9zKHsKICAgICAgICAgICAgICAgIHVybDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9VUExPQURfVVJJLAogICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICAgICAgICBkYXRhOiBmb3JtRGF0YSwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMKICAgICAgICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcy5kYXRhCiAgICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKQogICAgICAgICAgICB9KQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["push.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2FA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"push.vue","sourceRoot":"src/views/manage/message/dialog","sourcesContent":["<template>\n    <el-dialog title=\"创建消息\" :visible.sync=\"dialogVisible\" append-to-body width=\"50%\" :before-close=\"closeDialog\">\n        <div class=\"form-list-wrapper\">\n            <el-form ref=\"ruleForm\" :model=\"form\" :rules=\"rules\" label-width=\"150px\" class=\"form-list\">\n\n                <el-form-item label=\"目标APP\" prop=\"appId\">\n                    <el-select v-model=\"form.appId\" placeholder=\"请选择\">\n                        <el-option v-for=\"item in appList\"\n                                   :key=\"item.value\"\n                                   :label=\"item.label\"\n                                   :value=\"item.value\">\n                            <span style=\"float: left\">{{ item.label }}</span>\n                            <span v-if=\"item.os === 1\">\n                                <i class=\"icon-android-fill\" style=\"float: right\"></i>\n                            </span>\n                            <span v-else-if=\"item.os === 2\">\n                                <i class=\"icon-pingguo\" style=\"float: right\"></i>\n                            </span>\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"目标区域\" prop=\"areaId\">\n                    <el-select v-model=\"form.areaId\" :disabled=\"authAreaId !== 0\" placeholder=\"请选择\">\n                        <el-option\n                            v-for=\"item in areaData\"\n                            :key=\"item.value\"\n                            :label=\"item.label\"\n                            :value=\"item.value\">\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"目标对象\" prop=\"areaId\">\n\n                </el-form-item>\n                <el-form-item label=\"推送标题\" prop=\"name\">\n                    <el-input v-model=\"form.name\" placeholder=\"请输入\" />\n                </el-form-item>\n                <el-form-item label=\"推送封面\" prop=\"areaId\">\n                    <div class=\"img\">\n                        <el-upload\n                            :limit=\"1\"\n                            accept=\"image/*\"\n                            :on-preview=\"imgPreview\"\n                            :on-change=\"successImg\"\n                            list-type=\"picture-card\"\n                            :file-list=\"imgArr\"\n                            :auto-upload=\"false\"\n                        >\n                            <i class=\"el-icon-plus\"></i>\n                        </el-upload>\n                    </div>\n                    <div class=\"imgSpan2\">只能上传jpg/png文件，50X50px</div>\n                </el-form-item>\n                <el-form-item label=\"推送内容\" prop=\"areaId\">\n                    <el-input\n                        v-model=\"form.note\"\n                        type=\"textarea\"\n                        :autosize=\"{ minRows: 3, maxRows: 5 }\"\n                        placeholder=\"请输入内容\"\n                        maxlength=\"50\"\n                        show-word-limit\n                    />\n                </el-form-item>\n                <el-form-item label=\"跳转链接\" prop=\"areaId\">\n                    <el-input v-model=\"form.name\" placeholder=\"请输入\" />\n                </el-form-item>\n                <el-form-item label=\"是否定时推送\" prop=\"areaId\">\n                    <el-switch v-model=\"form.statusBool\"/>\n                </el-form-item>\n                <el-form-item label=\"定时时间\" prop=\"date\">\n                    <el-date-picker\n                        v-model=\"form.date\"\n                        type=\"datetime\"\n                        placeholder=\"选择日期时间\">\n                    </el-date-picker>\n                </el-form-item>\n\n                <el-form-item class=\"submit-box\">\n                    <el-button type=\"primary\" @click=\"submitForm\" style=\"margin-right: 50px\">提&nbsp;&nbsp;&nbsp;交</el-button>\n                    <el-button @click=\"resetForm\">重&nbsp;&nbsp;&nbsp;置</el-button>\n                </el-form-item>\n            </el-form>\n        </div>\n        <el-dialog :visible.sync=\"imgDialog\" :modal-append-to-body=\"true\" append-to-body>\n            <img width=\"100%\" :src=\"imgUri\" alt />\n        </el-dialog>\n    </el-dialog>\n</template>\n\n<script>\n\nimport { boolDict} from '@/dict/index'\nimport {getAppList, getAreaList, getBool, getCurrentUserAreaId, initAreas, initGuilds} from \"@/utils/dist\";\nimport {getToken} from \"@/utils/cookie\";\nimport axios from \"axios\";\n\nexport default {\n    name: 'Form',\n    components: { boolDict},\n    data() {\n        return {\n            form: {\n                areaId: undefined\n            },\n            authAreaId: getCurrentUserAreaId(),\n            dialogVisible: false,\n            imgArr: [],\n            imgDialog: false,\n            imgUri: undefined,\n            areaData : getAreaList(false),\n            appList: getAppList(true, true),\n            rules: {\n                areaId: [\n                    {required: true, message: '请选择', trigger: 'change'}\n                ],\n                name: [\n                    {required: true, message: '内容不能为空', trigger: 'blur'}\n                ],\n                enable: [\n                    {required: true, message: '内容不能为空', trigger: 'blur'}\n                ]\n            }\n        }\n    },\n    methods: {\n        init(row){\n            this.form.areaId = this.authAreaId === 0 ? this.areaData[0].value : this.authAreaId\n        },\n        submitForm(formName) {\n            const $this = this\n            this.$refs.ruleForm.validate((valid) => {\n                if (valid) {\n                    this.$service.guild.saveGuild(this.form, function (result){\n                        if (result) {\n                            $this.$message.success(\"保存成功!\")\n                            initGuilds()\n                            $this.closeDialog()\n                        } else {\n                            $this.$message.error(\"保存失败!\")\n                        }\n                    })\n                }\n            })\n        },\n        closeDialog() {\n            this.dialogVisible = false\n            this.resetForm()\n            this.$emit('fetchData');\n        },\n        resetForm() {\n            this.$refs.ruleForm.resetFields()\n        },\n        imgPreview(file) {\n            this.imgDialog = true;\n            this.imgUri = file.url\n        },\n        successImg(file) {\n            const $this = this\n            this.formLoading = true\n            this.imgUpload(file.raw, 1, function (data){\n                $this.form.avatar = data.uri\n                $this.formLoading = false\n            })\n        },\n        imgUpload(file, type, callback){\n            let headers = {\n                'Content-Type': 'multipart/form-data',\n                \"token\" : getToken(),\n                \"area-id\" : 1,\n                \"file-type\" : type\n            }\n            const formData = new FormData()\n            formData.append('file', file)\n            axios({\n                url: process.env.VUE_APP_UPLOAD_URI,\n                method: 'post',\n                data: formData,\n                headers: headers\n            }).then(res => {\n                const data = res.data\n                callback(data)\n            })\n        }\n    }\n}\n</script>\n\n<style lang=\"less\">\n.form-list-wrapper {\n\n    .form-list {\n        width: 80%;\n        margin: 0 auto;\n\n        .el-rate {\n            line-height: 2;\n        }\n\n        > .el-form-item {\n            margin-bottom: 22px;\n\n            .line {\n                text-align: center;\n            }\n\n            .tip-title {\n                text-align: right;\n                color: #606266;\n            }\n        }\n\n        .submit-box {\n            margin-top: 35px;\n            margin-left: 0;\n            text-align: center;\n        }\n    }\n}\n</style>\n"]}]}