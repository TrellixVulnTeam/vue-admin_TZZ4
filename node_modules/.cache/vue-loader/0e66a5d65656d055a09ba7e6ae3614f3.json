{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mengy/develop/iwork/kafo/vue-manage/src/components/VueDrr/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-manage/src/components/VueDrr/index.vue","mtime":1626074721475},{"path":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge21hdGNoZXNTZWxlY3RvclRvUGFyZW50RWxlbWVudHN9IGZyb20gJy4vdXRpbHMvZG9tJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogJ1Z1ZURycicsDQogICAgcHJvcHM6IHsNCiAgICAgICAgYWN0aXZlOiB7DQogICAgICAgICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UNCiAgICAgICAgfSwNCiAgICAgICAgZHJhZ2dhYmxlOiB7DQogICAgICAgICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZQ0KICAgICAgICB9LA0KICAgICAgICByZXNpemFibGU6IHsNCiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICAgICAgICBkZWZhdWx0OiB0cnVlDQogICAgICAgIH0sDQogICAgICAgIHJvdGF0YWJsZTogew0KICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUNCiAgICAgICAgfSwNCiAgICAgICAgY2FuRGVhY3RpdmU6IHsNCiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICAgICAgICBkZWZhdWx0OiB0cnVlDQogICAgICAgIH0sDQogICAgICAgIHc6IHsNCiAgICAgICAgICAgIHR5cGU6IFtOdW1iZXJdLA0KICAgICAgICAgICAgZGVmYXVsdDogMjAwDQogICAgICAgIH0sDQogICAgICAgIGg6IHsNCiAgICAgICAgICAgIHR5cGU6IFtOdW1iZXIsIFN0cmluZ10sDQogICAgICAgICAgICBkZWZhdWx0OiAyOCwNCiAgICAgICAgICAgIHZhbGlkYXRvcjogZnVuY3Rpb24gKHZhbCkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHZhbGlkID0gKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSA/IHZhbCA9PT0gJ2F1dG8nIDogdmFsID49IDANCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsaWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgcmF0aW86IHsNCiAgICAgICAgICAgIHR5cGU6IFtOdW1iZXIsIFN0cmluZ10NCiAgICAgICAgfSwNCiAgICAgICAgY29udGFpbnM6IHsNCiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICBtaW53OiB7DQogICAgICAgICAgICB0eXBlOiBOdW1iZXIsDQogICAgICAgICAgICBkZWZhdWx0OiAyOCwNCiAgICAgICAgICAgIHZhbGlkYXRvcih2YWwpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsID4gMA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBtaW5oOiB7DQogICAgICAgICAgICB0eXBlOiBOdW1iZXIsDQogICAgICAgICAgICBkZWZhdWx0OiAyOCwNCiAgICAgICAgICAgIHZhbGlkYXRvcih2YWwpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsID4gMA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBhbmdsZTogew0KICAgICAgICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgICAgICAgZGVmYXVsdDogMCwNCiAgICAgICAgICAgIHZhbGlkYXRvcih2YWwpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ251bWJlcicNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgeDogew0KICAgICAgICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgICAgICAgZGVmYXVsdDogMCwNCiAgICAgICAgICAgIHZhbGlkYXRvcih2YWwpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ251bWJlcicNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgeTogew0KICAgICAgICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgICAgICAgZGVmYXVsdDogMCwNCiAgICAgICAgICAgIHZhbGlkYXRvcih2YWwpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ251bWJlcicNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgejogew0KICAgICAgICAgICAgdHlwZTogW1N0cmluZywgTnVtYmVyXSwNCiAgICAgICAgICAgIGRlZmF1bHQ6ICdhdXRvJywNCiAgICAgICAgICAgIHZhbGlkYXRvcjogZnVuY3Rpb24gKHZhbCkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHZhbGlkID0gKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSA/IHZhbCA9PT0gJ2F1dG8nIDogdmFsID49IDANCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsaWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlczogew0KICAgICAgICAgICAgdHlwZTogQXJyYXksDQogICAgICAgICAgICBkZWZhdWx0KCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBbJ24nLCAnZScsICdzJywgJ3cnLCAnbncnLCAnbmUnLCAnc2UnLCAnc3cnXQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHZhbGlkYXRvcjogZnVuY3Rpb24gKHZhbCkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgU2V0KFsnbicsICdlJywgJ3MnLCAndycsICdudycsICduZScsICdzZScsICdzdyddKQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTZXQodmFsLmZpbHRlcihoID0+IHMuaGFzKGgpKSkuc2l6ZSA9PT0gdmFsLmxlbmd0aA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkcmFnSGFuZGxlOiB7DQogICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICBkZWZhdWx0OiBudWxsDQogICAgICAgIH0sDQogICAgICAgIGRyYWdDYW5jZWw6IHsNCiAgICAgICAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwNCiAgICAgICAgfSwNCiAgICAgICAgYXhpczogew0KICAgICAgICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgICAgICAgZGVmYXVsdDogJ2JvdGgnLA0KICAgICAgICAgICAgdmFsaWRhdG9yKHZhbCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBbJ3gnLCAneScsICdib3RoJ10uaW5kZXhPZih2YWwpICE9PSAtMQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBncmlkOiB7DQogICAgICAgICAgICB0eXBlOiBBcnJheSwNCiAgICAgICAgICAgIGRlZmF1bHQoKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIFsxLCAxXQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBwYXJlbnQ6IHsNCiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICBvdmVyZmxvd1k6IHsNCiAgICAgICAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgICAgICAgIGRlZmF1bHQ6ICcnDQogICAgICAgIH0NCiAgICB9LA0KICAgIGRhdGEoKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICB0b3A6IHRoaXMueSwNCiAgICAgICAgICAgIGxlZnQ6IHRoaXMueCwNCiAgICAgICAgICAgIHdpZHRoOiB0aGlzLncsDQogICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaCwNCiAgICAgICAgICAgIHJvdGF0ZUFuZ2xlOiB0aGlzLmFuZ2xlLA0KICAgICAgICAgICAgcmVzaXppbmc6IGZhbHNlLA0KICAgICAgICAgICAgZHJhZ2dpbmc6IGZhbHNlLA0KICAgICAgICAgICAgcm90YXRpbmc6IGZhbHNlLA0KICAgICAgICAgICAgZW5hYmxlZDogdGhpcy5hY3RpdmUsDQogICAgICAgICAgICBoYW5kbGU6IG51bGwsDQogICAgICAgICAgICB6SW5kZXg6IHRoaXMueiwNCiAgICAgICAgICAgIHBhcmVudFc6IDk5OTksDQogICAgICAgICAgICBwYXJlbnRIOiA5OTk5LA0KICAgICAgICAgICAgbW91c2VYOiAwLA0KICAgICAgICAgICAgbW91c2VZOiAwLA0KICAgICAgICAgICAgbGFzdE1vdXNlWDogMCwNCiAgICAgICAgICAgIGxhc3RNb3VzZVk6IDAsDQogICAgICAgICAgICBtb3VzZU9mZlg6IDAsDQogICAgICAgICAgICBtb3VzZU9mZlk6IDAsDQogICAgICAgICAgICBlbG1YOiAwLA0KICAgICAgICAgICAgZWxtWTogMCwNCiAgICAgICAgICAgIGVsbVc6IDAsDQogICAgICAgICAgICBlbG1IOiAwDQogICAgICAgIH0NCiAgICB9LA0KICAgIGNvbXB1dGVkOiB7DQogICAgICAgIHN0eWxlKCkgew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0b3A6IHRoaXMudG9wICsgJ3B4JywNCiAgICAgICAgICAgICAgICBsZWZ0OiB0aGlzLmxlZnQgKyAncHgnLA0KICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoICsgJ3B4JywNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0ICsgJ3B4JywNCiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06ICdyb3RhdGUoJyArIHRoaXMucm90YXRlQW5nbGUgKyAnZGVnKScsDQogICAgICAgICAgICAgICAgekluZGV4OiB0aGlzLnpJbmRleCwNCiAgICAgICAgICAgICAgICBvdmVyZmxvd1k6IHRoaXMub3ZlcmZsb3dZLA0KICAgICAgICAgICAgICAgIG92ZXJmbG93WDogJycNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0sDQogICAgd2F0Y2g6IHsNCiAgICAgICAgYWN0aXZlKHZhbCkgew0KICAgICAgICAgICAgdGhpcy5lbmFibGVkID0gdmFsDQogICAgICAgIH0sDQogICAgICAgIHgodmFsKSB7DQogICAgICAgICAgICB0aGlzLmxlZnQgPSB2YWwNCiAgICAgICAgICAgIHRoaXMuZWxtWCA9IHZhbA0KICAgICAgICB9LA0KICAgICAgICB5KHZhbCkgew0KICAgICAgICAgICAgdGhpcy50b3AgPSB2YWwNCiAgICAgICAgICAgIHRoaXMuZWxtWSA9IHZhbA0KICAgICAgICB9LA0KICAgICAgICB6OiBmdW5jdGlvbiAodmFsKSB7DQogICAgICAgICAgICBpZiAodmFsID49IDAgfHwgdmFsID09PSAnYXV0bycpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnpJbmRleCA9IHZhbA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICB3KHZhbCkgew0KICAgICAgICAgICAgdGhpcy53aWR0aCA9IHZhbA0KICAgICAgICAgICAgdGhpcy5lbG1XID0gdmFsDQogICAgICAgIH0sDQogICAgICAgIGgodmFsKSB7DQogICAgICAgICAgICB0aGlzLmhlaWdodCA9IHZhbA0KICAgICAgICAgICAgdGhpcy5lbG1IID0gdmFsDQogICAgICAgIH0sDQogICAgICAgIGFuZ2xlKHZhbCkgew0KICAgICAgICAgICAgdGhpcy5yb3RhdGVBbmdsZSA9IHZhbA0KICAgICAgICB9DQogICAgfSwNCiAgICBtb3VudGVkKCkgew0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWRpdG9yLW1hc2snKSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQNCiAgICAgICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuZGVzZWxlY3QsIGZhbHNlKQ0KICAgICAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5oYW5kbGVNb3ZlLCBmYWxzZSkNCiAgICAgICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmhhbmRsZVVwLCBmYWxzZSkNCg0KICAgICAgICAvLyB0b3VjaCBldmVudHMgYmluZGluZ3MNCiAgICAgICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuaGFuZGxlTW92ZSwgZmFsc2UpDQogICAgICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCB0b3VjaGNhbmNlbCcsIHRoaXMuZGVzZWxlY3QsIGZhbHNlKQ0KICAgICAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuaGFuZGxlVXAsIGZhbHNlKQ0KDQogICAgICAgIHRoaXMuZWxtWCA9IHBhcnNlSW50KHRoaXMuJGVsLnN0eWxlLmxlZnQpDQogICAgICAgIHRoaXMuZWxtWSA9IHBhcnNlSW50KHRoaXMuJGVsLnN0eWxlLnRvcCkNCiAgICAgICAgdGhpcy5lbG1XID0gdGhpcy4kZWwub2Zmc2V0V2lkdGggfHwgdGhpcy4kZWwuY2xpZW50V2lkdGgNCiAgICAgICAgdGhpcy5lbG1IID0gdGhpcy4kZWwub2Zmc2V0SGVpZ2h0IHx8IHRoaXMuJGVsLmNsaWVudEhlaWdodA0KDQogICAgICAgIHRoaXMucmV2aWV3RGltZW5zaW9ucygpDQogICAgfSwNCiAgICBiZWZvcmVEZXN0cm95KCkgew0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWRpdG9yLW1hc2snKSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQNCiAgICAgICAgY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuZGVzZWxlY3QsIGZhbHNlKQ0KICAgICAgICBjb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5oYW5kbGVNb3ZlLCBmYWxzZSkNCiAgICAgICAgY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmhhbmRsZVVwLCBmYWxzZSkNCg0KICAgICAgICAvLyB0b3VjaCBldmVudHMgYmluZGluZ3MgcmVtb3ZlZA0KICAgICAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5oYW5kbGVNb3ZlLCBmYWxzZSkNCiAgICAgICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kIHRvdWNoY2FuY2VsJywgdGhpcy5kZXNlbGVjdCwgZmFsc2UpDQogICAgICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy5oYW5kbGVVcCwgZmFsc2UpDQogICAgfSwNCiAgICBtZXRob2RzOiB7DQogICAgICAgIHJldmlld0RpbWVuc2lvbnMoKSB7DQogICAgICAgICAgICBpZiAodGhpcy5taW53ID4gdGhpcy53KSB7DQogICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IHRoaXMubWludw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAodGhpcy5taW5oID4gdGhpcy5oKSB7DQogICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLm1pbmgNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7DQogICAgICAgICAgICAgICAgY29uc3QgcGFyZW50VyA9IHBhcnNlSW50KHRoaXMuJGVsLnBhcmVudE5vZGUuY2xpZW50V2lkdGgsIDEwKQ0KICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEggPSBwYXJzZUludCh0aGlzLiRlbC5wYXJlbnROb2RlLmNsaWVudEhlaWdodCwgMTApDQoNCiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudFcgPSBwYXJlbnRXDQogICAgICAgICAgICAgICAgdGhpcy5wYXJlbnRIID0gcGFyZW50SA0KDQogICAgICAgICAgICAgICAgaWYgKHRoaXMudyA+IHRoaXMucGFyZW50Vykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gcGFyZW50Vw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmggPiB0aGlzLnBhcmVudEgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBwYXJlbnRIDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCh0aGlzLnggKyB0aGlzLncpID4gdGhpcy5wYXJlbnRXKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSBwYXJlbnRXIC0gdGhpcy54DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCh0aGlzLnkgKyB0aGlzLmgpID4gdGhpcy5wYXJlbnRIKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gcGFyZW50SCAtIHRoaXMueQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHRoaXMuZWxtVyA9IHRoaXMud2lkdGgNCiAgICAgICAgICAgICAgICB0aGlzLmVsbUggPSB0aGlzLmhlaWdodA0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLiRlbWl0KCdyZXNpemluZycsIHRoaXMubGVmdCwgdGhpcy50b3AsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KQ0KICAgICAgICB9LA0KICAgICAgICBlbG1Eb3duKGUpIHsNCiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudA0KICAgICAgICAgICAgaWYgKHRoaXMuJGVsLmNvbnRhaW5zKHRhcmdldCkpIHsNCiAgICAgICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgICAgICAgICh0aGlzLmRyYWdIYW5kbGUgJiYgIW1hdGNoZXNTZWxlY3RvclRvUGFyZW50RWxlbWVudHModGFyZ2V0LCB0aGlzLmRyYWdIYW5kbGUsIHRoaXMuJGVsKSkgfHwNCiAgICAgICAgICAgICAgICAgICAgKHRoaXMuZHJhZ0NhbmNlbCAmJiBtYXRjaGVzU2VsZWN0b3JUb1BhcmVudEVsZW1lbnRzKHRhcmdldCwgdGhpcy5kcmFnQ2FuY2VsLCB0aGlzLiRlbCkpKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLnJldmlld0RpbWVuc2lvbnMoKQ0KDQogICAgICAgICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmFibGVkID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdhY3RpdmF0ZWQnKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6YWN0aXZlJywgdHJ1ZSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dhYmxlKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhZ2dpbmcgPSB0cnVlDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkZXNlbGVjdChlKSB7DQogICAgICAgICAgICBpZiAoZS50eXBlLmluZGV4T2YoJ3RvdWNoJykgIT09IC0xKSB7DQogICAgICAgICAgICAgICAgdGhpcy5tb3VzZVggPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFgNCiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlWSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlWCA9IGUucGFnZVggfHwgZS5jbGllbnRYICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQNCiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlWSA9IGUucGFnZVkgfHwgZS5jbGllbnRZICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcA0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmxhc3RNb3VzZVggPSB0aGlzLm1vdXNlWA0KICAgICAgICAgICAgdGhpcy5sYXN0TW91c2VZID0gdGhpcy5tb3VzZVkNCg0KICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50DQogICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoJ3otaGFuZGxlLShbbmVzd117MSwgMn0pJywgJycpDQogICAgICAgICAgICAvLyDngrnlh7vlnKjlvZPliY3nu4Tku7blpJbvvIzlj5bmtohhY3RpdmXnirbmgIENCiAgICAgICAgICAgIGlmICghdGhpcy4kZWwuY29udGFpbnModGFyZ2V0KSAmJiAhcmVnZXgudGVzdCh0YXJnZXQuY2xhc3NOYW1lKSkgew0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FuRGVhY3RpdmUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdkZWFjdGl2YXRlZCcpDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6YWN0aXZlJywgZmFsc2UpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGhhbmRsZVJlc2l6ZVN0YXJ0KGhhbmRsZSwgZSkgew0KICAgICAgICAgICAgdGhpcy5oYW5kbGUgPSBoYW5kbGUNCg0KICAgICAgICAgICAgaWYgKGUuc3RvcFByb3BhZ2F0aW9uKSBlLnN0b3BQcm9wYWdhdGlvbigpDQogICAgICAgICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCkgZS5wcmV2ZW50RGVmYXVsdCgpDQoNCiAgICAgICAgICAgIHRoaXMucmVzaXppbmcgPSB0cnVlDQogICAgICAgIH0sDQoNCiAgICAgICAgaGFuZGxlRG93bjogZnVuY3Rpb24gKGhhbmRsZSwgZSkgew0KICAgICAgICAgICAgdGhpcy5oYW5kbGUgPSBoYW5kbGUNCg0KICAgICAgICAgICAgaWYgKGUuc3RvcFByb3BhZ2F0aW9uKSBlLnN0b3BQcm9wYWdhdGlvbigpDQogICAgICAgICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCkgZS5wcmV2ZW50RGVmYXVsdCgpDQoNCiAgICAgICAgICAgIHRoaXMucmVzaXppbmcgPSB0cnVlDQogICAgICAgIH0sDQogICAgICAgIGZpbGxQYXJlbnQ6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50IHx8ICF0aGlzLnJlc2l6YWJsZSB8fCAhdGhpcy5tYXhpbWl6ZSkgcmV0dXJuDQoNCiAgICAgICAgICAgIGxldCBkb25lID0gZmFsc2UNCg0KICAgICAgICAgICAgY29uc3QgYW5pbWF0ZSA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICBpZiAoIWRvbmUpIHsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmF4aXMgPT09ICd4Jykgew0KICAgICAgICAgICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID09PSB0aGlzLnBhcmVudFcgJiYgdGhpcy5sZWZ0ID09PSAwDQogICAgICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9uZSA9IHRydWUNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5heGlzID09PSAneScpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPT09IHRoaXMucGFyZW50SCAmJiB0aGlzLnRvcCA9PT0gMA0KICAgICAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXhpcyA9PT0gJ2JvdGgnKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPT09IHRoaXMucGFyZW50VyAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPT09IHRoaXMucGFyZW50SCAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b3AgPT09IDAgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGVmdCA9PT0gMA0KICAgICAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5heGlzID09PSAneCcgfHwgdGhpcy5heGlzID09PSAnYm90aCcpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud2lkdGggPCB0aGlzLnBhcmVudFcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGgrKw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbG1XKysNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmxlZnQgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxlZnQtLQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbG1YLS0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmF4aXMgPT09ICd5JyB8fCB0aGlzLmF4aXMgPT09ICdib3RoJykgew0KICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWlnaHQgPCB0aGlzLnBhcmVudEgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0KysNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxtSCsrDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50b3AgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvcC0tDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsbVktLQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncmVzaXppbmcnLCB0aGlzLmxlZnQsIHRoaXMudG9wLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKQ0KICAgICAgICB9LA0KICAgICAgICBnZXRPcmlnaW4oKSB7DQogICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgeDogKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwNCiAgICAgICAgICAgICAgICB5OiAocmVjdC5ib3R0b20gKyByZWN0LnRvcCkgLyAyDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGhhbmRsZU1vdmUoZSkgew0KICAgICAgICAgICAgY29uc3QgbGFzdE1vdXNlWCA9IHRoaXMubGFzdE1vdXNlWA0KICAgICAgICAgICAgY29uc3QgbGFzdE1vdXNlWSA9IHRoaXMubGFzdE1vdXNlWQ0KICAgICAgICAgICAgY29uc3QgaXNUb3VjaE1vdmUgPSBlLnR5cGUuaW5kZXhPZigndG91Y2htb3ZlJykgIT09IC0xDQogICAgICAgICAgICB0aGlzLm1vdXNlWCA9IGlzVG91Y2hNb3ZlDQogICAgICAgICAgICAgICAgPyBlLnRvdWNoZXNbMF0uY2xpZW50WA0KICAgICAgICAgICAgICAgIDogZS5wYWdlWCB8fCBlLmNsaWVudFggKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdA0KICAgICAgICAgICAgdGhpcy5tb3VzZVkgPSBpc1RvdWNoTW92ZQ0KICAgICAgICAgICAgICAgID8gZS50b3VjaGVzWzBdLmNsaWVudFkNCiAgICAgICAgICAgICAgICA6IGUucGFnZVkgfHwgZS5jbGllbnRZICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcA0KDQogICAgICAgICAgICBsZXQgZGlmZlggPSB0aGlzLm1vdXNlWCAtIHRoaXMubGFzdE1vdXNlWCArIHRoaXMubW91c2VPZmZYDQogICAgICAgICAgICBsZXQgZGlmZlkgPSB0aGlzLm1vdXNlWSAtIHRoaXMubGFzdE1vdXNlWSArIHRoaXMubW91c2VPZmZZDQoNCiAgICAgICAgICAgIHRoaXMubW91c2VPZmZYID0gdGhpcy5tb3VzZU9mZlkgPSAwDQoNCiAgICAgICAgICAgIHRoaXMubGFzdE1vdXNlWCA9IHRoaXMubW91c2VYDQogICAgICAgICAgICB0aGlzLmxhc3RNb3VzZVkgPSB0aGlzLm1vdXNlWQ0KDQogICAgICAgICAgICBjb25zdCBkWCA9IGRpZmZYDQogICAgICAgICAgICBjb25zdCBkWSA9IGRpZmZZDQoNCiAgICAgICAgICAgIGlmICh0aGlzLnJlc2l6aW5nKSB7DQogICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFuZGxlLmluZGV4T2YoJ24nKSA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsbUggLSBkWSA8IHRoaXMubWluaCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZU9mZlkgPSAoZFkgLSAoZGlmZlkgPSB0aGlzLmVsbUggLSB0aGlzLm1pbmgpKQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGFyZW50ICYmIHRoaXMuZWxtWSArIGRZIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZU9mZlkgPSBkWSAtIChkaWZmWSA9IC10aGlzLmVsbVkpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbG1ZICs9IGRpZmZZDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxtSCAtPSBkaWZmWQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZS5pbmRleE9mKCdzJykgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lbG1IICsgZFkgPCB0aGlzLm1pbmgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VPZmZZID0gKGRZIC0gKGRpZmZZID0gdGhpcy5taW5oIC0gdGhpcy5lbG1IKSkNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBhcmVudCAmJiB0aGlzLmVsbVkgKyB0aGlzLmVsbUggKyBkWSA+IHRoaXMucGFyZW50SCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZU9mZlkgPSAoZFkgLSAoZGlmZlkgPSB0aGlzLnBhcmVudEggLSB0aGlzLmVsbVkgLSB0aGlzLmVsbUgpKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxtSCArPSBkaWZmWQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZS5pbmRleE9mKCd3JykgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lbG1XIC0gZFggPCB0aGlzLm1pbncpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VPZmZYID0gKGRYIC0gKGRpZmZYID0gdGhpcy5lbG1XIC0gdGhpcy5taW53KSkNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBhcmVudCAmJiB0aGlzLmVsbVggKyBkWCA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VPZmZYID0gZFggLSAoZGlmZlggPSAtdGhpcy5lbG1YKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxtWCArPSBkaWZmWA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsbVcgLT0gZGlmZlgNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYW5kbGUuaW5kZXhPZignZScpID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZWxtVyArIGRYIDwgdGhpcy5taW53KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdXNlT2ZmWCA9IChkWCAtIChkaWZmWCA9IHRoaXMubWludyAtIHRoaXMuZWxtVykpDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wYXJlbnQgJiYgdGhpcy5lbG1YICsgdGhpcy5lbG1XICsgZFggPiB0aGlzLnBhcmVudFcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VPZmZYID0gKGRYIC0gKGRpZmZYID0gdGhpcy5wYXJlbnRXIC0gdGhpcy5lbG1YIC0gdGhpcy5lbG1XKSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsbVcgKz0gZGlmZlgNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLmxlZnQgPSAoTWF0aC5yb3VuZCh0aGlzLmVsbVggLyB0aGlzLmdyaWRbMF0pICogdGhpcy5ncmlkWzBdKQ0KICAgICAgICAgICAgICAgIHRoaXMudG9wID0gKE1hdGgucm91bmQodGhpcy5lbG1ZIC8gdGhpcy5ncmlkWzFdKSAqIHRoaXMuZ3JpZFsxXSkNCg0KICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSAoTWF0aC5yb3VuZCh0aGlzLmVsbVcgLyB0aGlzLmdyaWRbMF0pICogdGhpcy5ncmlkWzBdKQ0KICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gKE1hdGgucm91bmQodGhpcy5lbG1IIC8gdGhpcy5ncmlkWzFdKSAqIHRoaXMuZ3JpZFsxXSkNCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdyZXNpemluZycsIHRoaXMubGVmdCwgdGhpcy50b3AsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KQ0KICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmRyYWdnaW5nKSB7DQogICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsbVggKyBkWCA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VPZmZYID0gZFggLSAoZGlmZlggPSAtdGhpcy5lbG1YKQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZWxtWCArIHRoaXMuZWxtVyArIGRYID4gdGhpcy5wYXJlbnRXKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdXNlT2ZmWCA9IChkWCAtIChkaWZmWCA9IHRoaXMucGFyZW50VyAtIHRoaXMuZWxtWCAtIHRoaXMuZWxtVykpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZWxtWSArIGRZIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZU9mZlkgPSBkWSAtIChkaWZmWSA9IC10aGlzLmVsbVkpDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbG1ZICsgdGhpcy5lbG1IICsgZFkgPiB0aGlzLnBhcmVudEgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VPZmZZID0gZFkgLSAoZGlmZlkgPSB0aGlzLnBhcmVudEggLSB0aGlzLmVsbVkgLSB0aGlzLmVsbUgpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLmVsbVggKz0gZGlmZlgNCiAgICAgICAgICAgICAgICB0aGlzLmVsbVkgKz0gZGlmZlkNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5heGlzID09PSAneCcgfHwgdGhpcy5heGlzID09PSAnYm90aCcpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8g5Zub6IiN5LqU5YWl5Y+W5b6X5b2T5YmN5omA5Zyo5qC85a2Q5pWwICog5q+P5Liq5qC85a2Q55qE5Y2V5L2N5YOP57Sg77yM5L+d6K+B5q+P5LiA5Liq54K55a2Q5Zyo5qC85a2Q5LiKDQogICAgICAgICAgICAgICAgICAgIHRoaXMubGVmdCA9IChNYXRoLnJvdW5kKHRoaXMuZWxtWCAvIHRoaXMuZ3JpZFswXSkgKiB0aGlzLmdyaWRbMF0pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmF4aXMgPT09ICd5JyB8fCB0aGlzLmF4aXMgPT09ICdib3RoJykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRvcCA9IChNYXRoLnJvdW5kKHRoaXMuZWxtWSAvIHRoaXMuZ3JpZFsxXSkgKiB0aGlzLmdyaWRbMV0pDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnZHJhZ2dpbmcnLCB0aGlzLmxlZnQsIHRoaXMudG9wKQ0KICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJvdGF0aW5nKSB7DQogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luID0gdGhpcy5nZXRPcmlnaW4oKQ0KICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RBbmdsZSA9IE1hdGguYXRhbjIobGFzdE1vdXNlWSAtIG9yaWdpbi55LCBsYXN0TW91c2VYIC0gb3JpZ2luLngpDQogICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEFuZ2xlID0gTWF0aC5hdGFuMih0aGlzLm1vdXNlWSAtIG9yaWdpbi55LCB0aGlzLm1vdXNlWCAtIG9yaWdpbi54KQ0KICAgICAgICAgICAgICAgIHRoaXMucm90YXRlQW5nbGUgKz0gTWF0aC5yb3VuZCgoY3VycmVudEFuZ2xlIC0gbGFzdEFuZ2xlKSAqIDE4MCAvIE1hdGguUEkpDQogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm90YXRpbmcnLCB0aGlzLnJvdGF0ZUFuZ2xlKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVVcChlKSB7DQogICAgICAgICAgICBpZiAoZS50eXBlLmluZGV4T2YoJ3RvdWNoJykgIT09IC0xKSB7DQogICAgICAgICAgICAgICAgdGhpcy5sYXN0TW91c2VYID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRYDQogICAgICAgICAgICAgICAgdGhpcy5sYXN0TW91c2VZID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZDQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmhhbmRsZSA9IG51bGwNCiAgICAgICAgICAgIGlmICh0aGlzLnJlc2l6aW5nKSB7DQogICAgICAgICAgICAgICAgdGhpcy5yZXNpemluZyA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncmVzaXplc3RvcCcsIHRoaXMubGVmdCwgdGhpcy50b3AsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmRyYWdnaW5nID0gZmFsc2UNCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdkcmFnc3RvcCcsIHRoaXMubGVmdCwgdGhpcy50b3ApDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICh0aGlzLnJvdGF0aW5nKSB7DQogICAgICAgICAgICAgICAgdGhpcy5yb3RhdGluZyA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm90YXRlc3RvcCcsIHRoaXMucm90YXRlQW5nbGUpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuZWxtWCA9IHRoaXMubGVmdA0KICAgICAgICAgICAgdGhpcy5lbG1ZID0gdGhpcy50b3ANCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/VueDrr","sourcesContent":["<template>\r\n    <div\r\n        class=\"z-drr-container\"\r\n        :style=\"style\"\r\n        :class=\"{\r\n      'z-draggable': draggable,\r\n      'z-resizable': resizable,\r\n      'z-rotatable': rotatable,\r\n      'z-active': enabled,\r\n      'z-dragging': dragging,\r\n      'z-resizing': resizing,\r\n      'z-rotating': rotating\r\n    }\"\r\n        @mousedown=\"elmDown\"\r\n    >\r\n        <div\r\n            v-if=\"rotatable\"\r\n            class=\"z-rotateable-handle\"\r\n            :style=\"{ display: enabled ? 'block' : 'none'}\"\r\n            @touchstart.prevent.stop=\"elmDown\"\r\n            @mousedown.stop.prevent=\"rotating = true\"\r\n            @dblclick=\"fillParent\"\r\n        />\r\n        <div\r\n            v-for=\"handle in handles\"\r\n            v-if=\"resizable\"\r\n            :key=\"handle\"\r\n            class=\"z-resizeable-handle\"\r\n            :class=\"'z-handle-' + handle\"\r\n            :style=\"{ display: enabled ? 'block' : 'none'}\"\r\n            @touchstart.stop.prevent=\"handleDown(handle, $event)\"\r\n            @mousedown.stop.prevent=\"handleResizeStart(handle, $event)\"\r\n        />\r\n        <slot/>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {matchesSelectorToParentElements} from './utils/dom'\r\n\r\nexport default {\r\n    name: 'VueDrr',\r\n    props: {\r\n        active: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        draggable: {\r\n            type: Boolean,\r\n            default: true\r\n        },\r\n        resizable: {\r\n            type: Boolean,\r\n            default: true\r\n        },\r\n        rotatable: {\r\n            type: Boolean,\r\n            default: true\r\n        },\r\n        canDeactive: {\r\n            type: Boolean,\r\n            default: true\r\n        },\r\n        w: {\r\n            type: [Number],\r\n            default: 200\r\n        },\r\n        h: {\r\n            type: [Number, String],\r\n            default: 28,\r\n            validator: function (val) {\r\n                const valid = (typeof val === 'string') ? val === 'auto' : val >= 0\r\n                return valid\r\n            }\r\n        },\r\n        ratio: {\r\n            type: [Number, String]\r\n        },\r\n        contains: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        minw: {\r\n            type: Number,\r\n            default: 28,\r\n            validator(val) {\r\n                return val > 0\r\n            }\r\n        },\r\n        minh: {\r\n            type: Number,\r\n            default: 28,\r\n            validator(val) {\r\n                return val > 0\r\n            }\r\n        },\r\n        angle: {\r\n            type: Number,\r\n            default: 0,\r\n            validator(val) {\r\n                return typeof val === 'number'\r\n            }\r\n        },\r\n        x: {\r\n            type: Number,\r\n            default: 0,\r\n            validator(val) {\r\n                return typeof val === 'number'\r\n            }\r\n        },\r\n        y: {\r\n            type: Number,\r\n            default: 0,\r\n            validator(val) {\r\n                return typeof val === 'number'\r\n            }\r\n        },\r\n        z: {\r\n            type: [String, Number],\r\n            default: 'auto',\r\n            validator: function (val) {\r\n                const valid = (typeof val === 'string') ? val === 'auto' : val >= 0\r\n                return valid\r\n            }\r\n        },\r\n        handles: {\r\n            type: Array,\r\n            default() {\r\n                return ['n', 'e', 's', 'w', 'nw', 'ne', 'se', 'sw']\r\n            },\r\n            validator: function (val) {\r\n                const s = new Set(['n', 'e', 's', 'w', 'nw', 'ne', 'se', 'sw'])\r\n\r\n                return new Set(val.filter(h => s.has(h))).size === val.length\r\n            }\r\n        },\r\n        dragHandle: {\r\n            type: String,\r\n            default: null\r\n        },\r\n        dragCancel: {\r\n            type: String,\r\n            default: null\r\n        },\r\n        axis: {\r\n            type: String,\r\n            default: 'both',\r\n            validator(val) {\r\n                return ['x', 'y', 'both'].indexOf(val) !== -1\r\n            }\r\n        },\r\n        grid: {\r\n            type: Array,\r\n            default() {\r\n                return [1, 1]\r\n            }\r\n        },\r\n        parent: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        overflowY: {\r\n            type: String,\r\n            default: ''\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            top: this.y,\r\n            left: this.x,\r\n            width: this.w,\r\n            height: this.h,\r\n            rotateAngle: this.angle,\r\n            resizing: false,\r\n            dragging: false,\r\n            rotating: false,\r\n            enabled: this.active,\r\n            handle: null,\r\n            zIndex: this.z,\r\n            parentW: 9999,\r\n            parentH: 9999,\r\n            mouseX: 0,\r\n            mouseY: 0,\r\n            lastMouseX: 0,\r\n            lastMouseY: 0,\r\n            mouseOffX: 0,\r\n            mouseOffY: 0,\r\n            elmX: 0,\r\n            elmY: 0,\r\n            elmW: 0,\r\n            elmH: 0\r\n        }\r\n    },\r\n    computed: {\r\n        style() {\r\n            return {\r\n                top: this.top + 'px',\r\n                left: this.left + 'px',\r\n                width: this.width + 'px',\r\n                height: this.height + 'px',\r\n                transform: 'rotate(' + this.rotateAngle + 'deg)',\r\n                zIndex: this.zIndex,\r\n                overflowY: this.overflowY,\r\n                overflowX: ''\r\n            }\r\n        }\r\n    },\r\n    watch: {\r\n        active(val) {\r\n            this.enabled = val\r\n        },\r\n        x(val) {\r\n            this.left = val\r\n            this.elmX = val\r\n        },\r\n        y(val) {\r\n            this.top = val\r\n            this.elmY = val\r\n        },\r\n        z: function (val) {\r\n            if (val >= 0 || val === 'auto') {\r\n                this.zIndex = val\r\n            }\r\n        },\r\n        w(val) {\r\n            this.width = val\r\n            this.elmW = val\r\n        },\r\n        h(val) {\r\n            this.height = val\r\n            this.elmH = val\r\n        },\r\n        angle(val) {\r\n            this.rotateAngle = val\r\n        }\r\n    },\r\n    mounted() {\r\n        const container = document.querySelector('.editor-mask') || document.documentElement\r\n        container.addEventListener('mousedown', this.deselect, false)\r\n        container.addEventListener('mousemove', this.handleMove, false)\r\n        container.addEventListener('mouseup', this.handleUp, false)\r\n\r\n        // touch events bindings\r\n        container.addEventListener('touchmove', this.handleMove, false)\r\n        container.addEventListener('touchend touchcancel', this.deselect, false)\r\n        container.addEventListener('touchstart', this.handleUp, false)\r\n\r\n        this.elmX = parseInt(this.$el.style.left)\r\n        this.elmY = parseInt(this.$el.style.top)\r\n        this.elmW = this.$el.offsetWidth || this.$el.clientWidth\r\n        this.elmH = this.$el.offsetHeight || this.$el.clientHeight\r\n\r\n        this.reviewDimensions()\r\n    },\r\n    beforeDestroy() {\r\n        const container = document.querySelector('.editor-mask') || document.documentElement\r\n        container.removeEventListener('mousedown', this.deselect, false)\r\n        container.removeEventListener('mousemove', this.handleMove, false)\r\n        container.removeEventListener('mouseup', this.handleUp, false)\r\n\r\n        // touch events bindings removed\r\n        container.addEventListener('touchmove', this.handleMove, false)\r\n        container.addEventListener('touchend touchcancel', this.deselect, false)\r\n        container.addEventListener('touchstart', this.handleUp, false)\r\n    },\r\n    methods: {\r\n        reviewDimensions() {\r\n            if (this.minw > this.w) {\r\n                this.width = this.minw\r\n            }\r\n\r\n            if (this.minh > this.h) {\r\n                this.height = this.minh\r\n            }\r\n\r\n            if (this.parent) {\r\n                const parentW = parseInt(this.$el.parentNode.clientWidth, 10)\r\n                const parentH = parseInt(this.$el.parentNode.clientHeight, 10)\r\n\r\n                this.parentW = parentW\r\n                this.parentH = parentH\r\n\r\n                if (this.w > this.parentW) {\r\n                    this.width = parentW\r\n                }\r\n\r\n                if (this.h > this.parentH) {\r\n                    this.height = parentH\r\n                }\r\n\r\n                if ((this.x + this.w) > this.parentW) {\r\n                    this.width = parentW - this.x\r\n                }\r\n\r\n                if ((this.y + this.h) > this.parentH) {\r\n                    this.height = parentH - this.y\r\n                }\r\n\r\n                this.elmW = this.width\r\n                this.elmH = this.height\r\n            }\r\n\r\n            this.$emit('resizing', this.left, this.top, this.width, this.height)\r\n        },\r\n        elmDown(e) {\r\n            const target = e.target || e.srcElement\r\n            if (this.$el.contains(target)) {\r\n                if (\r\n                    (this.dragHandle && !matchesSelectorToParentElements(target, this.dragHandle, this.$el)) ||\r\n                    (this.dragCancel && matchesSelectorToParentElements(target, this.dragCancel, this.$el))) {\r\n                    return\r\n                }\r\n                this.reviewDimensions()\r\n\r\n                if (!this.enabled) {\r\n                    this.enabled = true\r\n                    this.$emit('activated')\r\n                    this.$emit('update:active', true)\r\n                }\r\n                if (this.draggable) {\r\n                    this.dragging = true\r\n                }\r\n            }\r\n        },\r\n        deselect(e) {\r\n            if (e.type.indexOf('touch') !== -1) {\r\n                this.mouseX = e.changedTouches[0].clientX\r\n                this.mouseY = e.changedTouches[0].clientY\r\n            } else {\r\n                this.mouseX = e.pageX || e.clientX + document.documentElement.scrollLeft\r\n                this.mouseY = e.pageY || e.clientY + document.documentElement.scrollTop\r\n            }\r\n\r\n            this.lastMouseX = this.mouseX\r\n            this.lastMouseY = this.mouseY\r\n\r\n            const target = e.target || e.srcElement\r\n            const regex = new RegExp('z-handle-([nesw]{1, 2})', '')\r\n            // 点击在当前组件外，取消active状态\r\n            if (!this.$el.contains(target) && !regex.test(target.className)) {\r\n                if (this.enabled) {\r\n                    if (this.canDeactive) {\r\n                        this.enabled = false\r\n                        this.$emit('deactivated')\r\n                        this.$emit('update:active', false)\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        handleResizeStart(handle, e) {\r\n            this.handle = handle\r\n\r\n            if (e.stopPropagation) e.stopPropagation()\r\n            if (e.preventDefault) e.preventDefault()\r\n\r\n            this.resizing = true\r\n        },\r\n\r\n        handleDown: function (handle, e) {\r\n            this.handle = handle\r\n\r\n            if (e.stopPropagation) e.stopPropagation()\r\n            if (e.preventDefault) e.preventDefault()\r\n\r\n            this.resizing = true\r\n        },\r\n        fillParent: function (e) {\r\n            if (!this.parent || !this.resizable || !this.maximize) return\r\n\r\n            let done = false\r\n\r\n            const animate = () => {\r\n                if (!done) {\r\n                    window.requestAnimationFrame(animate)\r\n                }\r\n\r\n                if (this.axis === 'x') {\r\n                    if (\r\n                        this.width === this.parentW && this.left === 0\r\n                    ) {\r\n                        done = true\r\n                    }\r\n                } else if (this.axis === 'y') {\r\n                    if (\r\n                        this.height === this.parentH && this.top === 0\r\n                    ) {\r\n                        done = true\r\n                    }\r\n                } else if (this.axis === 'both') {\r\n                    if (\r\n                        this.width === this.parentW &&\r\n                        this.height === this.parentH &&\r\n                        this.top === 0 &&\r\n                        this.left === 0\r\n                    ) {\r\n                        done = true\r\n                    }\r\n                }\r\n\r\n                if (this.axis === 'x' || this.axis === 'both') {\r\n                    if (this.width < this.parentW) {\r\n                        this.width++\r\n                        this.elmW++\r\n                    }\r\n\r\n                    if (this.left > 0) {\r\n                        this.left--\r\n                        this.elmX--\r\n                    }\r\n                }\r\n\r\n                if (this.axis === 'y' || this.axis === 'both') {\r\n                    if (this.height < this.parentH) {\r\n                        this.height++\r\n                        this.elmH++\r\n                    }\r\n\r\n                    if (this.top > 0) {\r\n                        this.top--\r\n                        this.elmY--\r\n                    }\r\n                }\r\n\r\n                this.$emit('resizing', this.left, this.top, this.width, this.height)\r\n            }\r\n\r\n            window.requestAnimationFrame(animate)\r\n        },\r\n        getOrigin() {\r\n            const rect = this.$el.getBoundingClientRect()\r\n            return {\r\n                x: (rect.left + rect.right) / 2,\r\n                y: (rect.bottom + rect.top) / 2\r\n            }\r\n        },\r\n        handleMove(e) {\r\n            const lastMouseX = this.lastMouseX\r\n            const lastMouseY = this.lastMouseY\r\n            const isTouchMove = e.type.indexOf('touchmove') !== -1\r\n            this.mouseX = isTouchMove\r\n                ? e.touches[0].clientX\r\n                : e.pageX || e.clientX + document.documentElement.scrollLeft\r\n            this.mouseY = isTouchMove\r\n                ? e.touches[0].clientY\r\n                : e.pageY || e.clientY + document.documentElement.scrollTop\r\n\r\n            let diffX = this.mouseX - this.lastMouseX + this.mouseOffX\r\n            let diffY = this.mouseY - this.lastMouseY + this.mouseOffY\r\n\r\n            this.mouseOffX = this.mouseOffY = 0\r\n\r\n            this.lastMouseX = this.mouseX\r\n            this.lastMouseY = this.mouseY\r\n\r\n            const dX = diffX\r\n            const dY = diffY\r\n\r\n            if (this.resizing) {\r\n                if (this.handle.indexOf('n') >= 0) {\r\n                    if (this.elmH - dY < this.minh) {\r\n                        this.mouseOffY = (dY - (diffY = this.elmH - this.minh))\r\n                    } else if (this.parent && this.elmY + dY < 0) {\r\n                        this.mouseOffY = dY - (diffY = -this.elmY)\r\n                    }\r\n                    this.elmY += diffY\r\n                    this.elmH -= diffY\r\n                }\r\n\r\n                if (this.handle.indexOf('s') >= 0) {\r\n                    if (this.elmH + dY < this.minh) {\r\n                        this.mouseOffY = (dY - (diffY = this.minh - this.elmH))\r\n                    } else if (this.parent && this.elmY + this.elmH + dY > this.parentH) {\r\n                        this.mouseOffY = (dY - (diffY = this.parentH - this.elmY - this.elmH))\r\n                    }\r\n                    this.elmH += diffY\r\n                }\r\n\r\n                if (this.handle.indexOf('w') >= 0) {\r\n                    if (this.elmW - dX < this.minw) {\r\n                        this.mouseOffX = (dX - (diffX = this.elmW - this.minw))\r\n                    } else if (this.parent && this.elmX + dX < 0) {\r\n                        this.mouseOffX = dX - (diffX = -this.elmX)\r\n                    }\r\n                    this.elmX += diffX\r\n                    this.elmW -= diffX\r\n                }\r\n\r\n                if (this.handle.indexOf('e') >= 0) {\r\n                    if (this.elmW + dX < this.minw) {\r\n                        this.mouseOffX = (dX - (diffX = this.minw - this.elmW))\r\n                    } else if (this.parent && this.elmX + this.elmW + dX > this.parentW) {\r\n                        this.mouseOffX = (dX - (diffX = this.parentW - this.elmX - this.elmW))\r\n                    }\r\n                    this.elmW += diffX\r\n                }\r\n\r\n                this.left = (Math.round(this.elmX / this.grid[0]) * this.grid[0])\r\n                this.top = (Math.round(this.elmY / this.grid[1]) * this.grid[1])\r\n\r\n                this.width = (Math.round(this.elmW / this.grid[0]) * this.grid[0])\r\n                this.height = (Math.round(this.elmH / this.grid[1]) * this.grid[1])\r\n                this.$emit('resizing', this.left, this.top, this.width, this.height)\r\n            } else if (this.dragging) {\r\n                if (this.parent) {\r\n                    if (this.elmX + dX < 0) {\r\n                        this.mouseOffX = dX - (diffX = -this.elmX)\r\n                    } else if (this.elmX + this.elmW + dX > this.parentW) {\r\n                        this.mouseOffX = (dX - (diffX = this.parentW - this.elmX - this.elmW))\r\n                    }\r\n                    if (this.elmY + dY < 0) {\r\n                        this.mouseOffY = dY - (diffY = -this.elmY)\r\n                    } else if (this.elmY + this.elmH + dY > this.parentH) {\r\n                        this.mouseOffY = dY - (diffY = this.parentH - this.elmY - this.elmH)\r\n                    }\r\n                }\r\n\r\n                this.elmX += diffX\r\n                this.elmY += diffY\r\n                if (this.axis === 'x' || this.axis === 'both') {\r\n                    // 四舍五入取得当前所在格子数 * 每个格子的单位像素，保证每一个点子在格子上\r\n                    this.left = (Math.round(this.elmX / this.grid[0]) * this.grid[0])\r\n                }\r\n                if (this.axis === 'y' || this.axis === 'both') {\r\n                    this.top = (Math.round(this.elmY / this.grid[1]) * this.grid[1])\r\n                }\r\n\r\n                this.$emit('dragging', this.left, this.top)\r\n            } else if (this.rotating) {\r\n                const origin = this.getOrigin()\r\n                const lastAngle = Math.atan2(lastMouseY - origin.y, lastMouseX - origin.x)\r\n                const currentAngle = Math.atan2(this.mouseY - origin.y, this.mouseX - origin.x)\r\n                this.rotateAngle += Math.round((currentAngle - lastAngle) * 180 / Math.PI)\r\n                this.$emit('rotating', this.rotateAngle)\r\n            }\r\n        },\r\n        handleUp(e) {\r\n            if (e.type.indexOf('touch') !== -1) {\r\n                this.lastMouseX = e.changedTouches[0].clientX\r\n                this.lastMouseY = e.changedTouches[0].clientY\r\n            }\r\n            this.handle = null\r\n            if (this.resizing) {\r\n                this.resizing = false\r\n                this.$emit('resizestop', this.left, this.top, this.width, this.height)\r\n            }\r\n            if (this.dragging) {\r\n                this.dragging = false\r\n                this.$emit('dragstop', this.left, this.top)\r\n            }\r\n\r\n            if (this.rotating) {\r\n                this.rotating = false\r\n                this.$emit('rotatestop', this.rotateAngle)\r\n            }\r\n\r\n            this.elmX = this.left\r\n            this.elmY = this.top\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../../assets/less/variables';\r\n\r\n@main-color: #2e95ff;\r\n@circle-size: 8px;\r\n\r\n.z-drr-container {\r\n    position: absolute;\r\n    border: 1px dashed transparent;\r\n\r\n    *, *:before, *:after {\r\n        padding: 0;\r\n        margin: 0;\r\n        box-sizing: border-box;\r\n        -moz-box-sizing: border-box;\r\n    }\r\n}\r\n\r\n.z-draggable:hover {\r\n    cursor: move;\r\n}\r\n\r\n.circle(@bgc: #fff) {\r\n    position: absolute;\r\n    width: @circle-size;\r\n    height: @circle-size;\r\n    border: 1px solid @main-color;\r\n    border-radius: 50%;\r\n    background: @bgc;\r\n}\r\n\r\n.z-rotateable-handle {\r\n    position: absolute;\r\n    left: 50%;\r\n    top: -@circle-size * 3;\r\n    width: 1px;\r\n    height: @circle-size * 3;\r\n    margin-left: -.5px;\r\n    background-color: @main-color;\r\n    cursor: url(../../assets/img/mouse-rotate.png) 8 8, default;\r\n\r\n    &:after {\r\n        content: ' ';\r\n        top: 0;\r\n        left: 0;\r\n        margin-left: -(@circle-size - 1)/2;\r\n        .circle(@main-color);\r\n    }\r\n}\r\n\r\n.z-resizeable-handle {\r\n    display: none;\r\n    position: absolute;\r\n}\r\n\r\n.z-handle-nw,\r\n.z-handle-ne,\r\n.z-handle-sw,\r\n.z-handle-se {\r\n    .circle;\r\n}\r\n\r\n.z-handle-nw {\r\n    top: -@circle-size/2;\r\n    left: -@circle-size/2;\r\n    cursor: nw-resize;\r\n}\r\n\r\n.z-handle-ne {\r\n    top: -@circle-size/2;\r\n    right: -@circle-size/2;\r\n    cursor: ne-resize;\r\n}\r\n\r\n.z-handle-sw {\r\n    bottom: -@circle-size/2;\r\n    left: -@circle-size/2;\r\n    cursor: sw-resize;\r\n}\r\n\r\n.z-handle-se {\r\n    bottom: -@circle-size/2;\r\n    right: -@circle-size/2;\r\n    cursor: se-resize;\r\n}\r\n\r\n.z-handle-n,\r\n.z-handle-w,\r\n.z-handle-e,\r\n.z-handle-s {\r\n    &:after {\r\n        content: ' ';\r\n        .circle;\r\n    }\r\n}\r\n\r\n.z-handle-n {\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: @circle-size/2;\r\n    cursor: n-resize;\r\n\r\n    &:after {\r\n        bottom: 0;\r\n        left: 50%;\r\n        margin-left: -@circle-size/2;\r\n    }\r\n}\r\n\r\n.z-handle-w {\r\n    top: 0;\r\n    left: 0;\r\n    width: @circle-size/2;\r\n    height: 100%;\r\n    cursor: w-resize;\r\n\r\n    &:after {\r\n        top: 50%;\r\n        right: 0;\r\n        margin-top: -@circle-size/2;\r\n    }\r\n}\r\n\r\n.z-handle-e {\r\n    top: 0;\r\n    right: 0;\r\n    width: @circle-size/2;\r\n    height: 100%;\r\n    cursor: e-resize;\r\n\r\n    &:after {\r\n        top: 50%;\r\n        left: 0;\r\n        margin-top: -@circle-size/2;\r\n    }\r\n}\r\n\r\n.z-handle-s {\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: @circle-size/2;\r\n    cursor: s-resize;\r\n\r\n    &:after {\r\n        top: 0;\r\n        left: 50%;\r\n        margin-left: -@circle-size/2;\r\n    }\r\n}\r\n\r\n.z-active {\r\n    border: 1px dashed @main-color;\r\n    z-index: 999;\r\n}\r\n</style>\r\n"]}]}