{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mengy/develop/iwork/kafo/vue-admin/src/views/manage/count/real-time.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-admin/src/views/manage/count/real-time.vue","mtime":1632974088273},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDb3VudFRvIGZyb20gJ3Z1ZS1jb3VudC10bycKaW1wb3J0IENoYXJ0c0JhckxpbmUgZnJvbSAnLi4vLi4vLi4vY29tcG9uZW50cy9DaGFydHMvQ2hhcnRzQmFyTGluZScKaW1wb3J0IENoYXJ0c0JhciBmcm9tICcuLi8uLi8uLi9jb21wb25lbnRzL0NoYXJ0cy9DaGFydHNCYXInCmltcG9ydCBDaGFydHNMaW5lIGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvQ2hhcnRzL0NoYXJ0c0xpbmUnCmltcG9ydCB7Z2V0QXJlYUxpc3QsIGdldEN1cnJlbnRVc2VyQXJlYUlkfSBmcm9tICJAL3V0aWxzL2Rpc3QiOwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ0hvbWUnLAogICAgY29tcG9uZW50czoge0NvdW50VG8sIENoYXJ0c0JhciwgQ2hhcnRzQmFyTGluZSwgQ2hhcnRzTGluZX0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNlYXJjaDogewogICAgICAgICAgICAgICAgYXJlYUlkOiBnZXRDdXJyZW50VXNlckFyZWFJZCgpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFyZWFMaXN0OiBnZXRBcmVhTGlzdCgpLAogICAgICAgICAgICB1c2VyRGF0YTogewogICAgICAgICAgICAgICAgdGl0bGU6ICflrp7ml7bnlKjmiLcnLAogICAgICAgICAgICAgICAgbGVnZW5kOiBbJ+WcqOe6v+eUqOaItycsICfmlrDnlKjmiLcnLCAn5LuY6LS555So5oi3JywgJ+epuumXsuS4u+aSrScsICfpgJror53kuLvmkq0nXSwKICAgICAgICAgICAgICAgIGtleXM6IFtdLAogICAgICAgICAgICAgICAgdmFsdWVzOiB1bmRlZmluZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2FsbGluZ0RhdGE6IHsKICAgICAgICAgICAgICAgIHRpdGxlOiAn5a6e5pe26YCa6K+dJywKICAgICAgICAgICAgICAgIGxlZ2VuZDogWydBSULlj5HotbcnLCAn55So5oi35Y+R6LW3JywgJ+S4u+aSreWPkei1tyddLAogICAgICAgICAgICAgICAga2V5czogW10sCiAgICAgICAgICAgICAgICB2YWx1ZXM6IHVuZGVmaW5lZAogICAgICAgICAgICB9LAogICAgICAgICAgICBjYWxsRGF0YTogewogICAgICAgICAgICAgICAgdGl0bGU6ICflrp7ml7blkbzlj6snLAogICAgICAgICAgICAgICAgbGVnZW5kOiBbJ+aVtOS9k+WRvOWPqycsICdBSULlkbzlj6snLCAn55So5oi35ZG85Y+rJywgJ+S4u+aSreWRvOWPqyddLAogICAgICAgICAgICAgICAga2V5czogW10sCiAgICAgICAgICAgICAgICB2YWx1ZXM6IHVuZGVmaW5lZAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgdGhpcy5pbml0RGF0YSgpCiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIG9uU2VhcmNoKCkgewogICAgICAgICAgICB0aGlzLmluaXREYXRhKCkKICAgICAgICB9LAogICAgICAgIGluaXREYXRhKCl7CiAgICAgICAgICAgIGNvbnN0ICR0aGlzID0gdGhpcwogICAgICAgICAgICBsZXQgcGFyYW0gPSB0aGlzLnNlYXJjaAogICAgICAgICAgICBwYXJhbS5zdGFydEF0ID0gdGhpcy5zdGFydFVuaXgobmV3IERhdGUoKSkKICAgICAgICAgICAgcGFyYW0uZW5kQXQgPSB0aGlzLmVuZFVuaXgobmV3IERhdGUoKSkKICAgICAgICAgICAgdGhpcy4kc2VydmljZS5ob21lLmdldEFyZWFTdGF0KHRoaXMuc2VhcmNoLCBmdW5jdGlvbiAocmVzdWx0KXsKICAgICAgICAgICAgICAgIGxldCBzdGF0TGlzdCA9IHJlc3VsdC5nZXRTdGF0c0xpc3QoKQogICAgICAgICAgICAgICAgJHRoaXMuaGFuZGxlVXNlckRhdGEoc3RhdExpc3QpCiAgICAgICAgICAgICAgICAkdGhpcy5oYW5kbGVDYWxsaW5nRGF0YShzdGF0TGlzdCkKICAgICAgICAgICAgICAgICR0aGlzLmhhbmRsZUNhbGxEYXRhKHN0YXRMaXN0KQogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZVVzZXJEYXRhKHN0YXRMaXN0KXsKICAgICAgICAgICAgbGV0IGtleXMgPSBbXQogICAgICAgICAgICBsZXQgdmFsdWVzID0gW10KICAgICAgICAgICAgbGV0IG9ubGluZVVzZXIgPSBbXQogICAgICAgICAgICBsZXQgbmV3VXNlciA9IFtdCiAgICAgICAgICAgIGxldCBwYXlVc2VyID0gW10KICAgICAgICAgICAgbGV0IGlkbGVBbmNob3IgPSBbXQogICAgICAgICAgICBsZXQgYnVzeUFuY2hvciA9IFtdCiAgICAgICAgICAgIHN0YXRMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgc3RhcnRBdCA9IGl0ZW0uZ2V0U3RhcnRBdCgpCiAgICAgICAgICAgICAgICBrZXlzLnB1c2gobmV3IERhdGUoc3RhcnRBdCAqIDEwMDApLmZvcm1hdCgiSEg6bW0iKSkKICAgICAgICAgICAgICAgIG9ubGluZVVzZXIucHVzaChpdGVtLmdldE9ubGluZVVzZXIoKSkKICAgICAgICAgICAgICAgIG5ld1VzZXIucHVzaChpdGVtLmdldE5ld1VzZXIoKSkKICAgICAgICAgICAgICAgIHBheVVzZXIucHVzaChpdGVtLmdldFBheVVzZXIoKSkKICAgICAgICAgICAgICAgIGlkbGVBbmNob3IucHVzaChpdGVtLmdldElkbGVBbmNob3IoKSkKICAgICAgICAgICAgICAgIGJ1c3lBbmNob3IucHVzaChpdGVtLmdldEJ1c3lBbmNob3IoKSkKICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIHZhbHVlcy5wdXNoKG9ubGluZVVzZXIpCiAgICAgICAgICAgIHZhbHVlcy5wdXNoKG5ld1VzZXIpCiAgICAgICAgICAgIHZhbHVlcy5wdXNoKHBheVVzZXIpCiAgICAgICAgICAgIHZhbHVlcy5wdXNoKGlkbGVBbmNob3IpCiAgICAgICAgICAgIHZhbHVlcy5wdXNoKGJ1c3lBbmNob3IpCgogICAgICAgICAgICB0aGlzLnVzZXJEYXRhLmtleXMgPSBrZXlzCiAgICAgICAgICAgIHRoaXMudXNlckRhdGEudmFsdWVzID0gdmFsdWVzCiAgICAgICAgfSwKICAgICAgICBoYW5kbGVDYWxsaW5nRGF0YShzdGF0TGlzdCl7CiAgICAgICAgICAgIGxldCBrZXlzID0gW10KICAgICAgICAgICAgbGV0IHZhbHVlcyA9IFtdCiAgICAgICAgICAgIGxldCBhaUNhbGxpbmcgPSBbXQogICAgICAgICAgICBsZXQgdXNlckNhbGxpbmcgPSBbXQogICAgICAgICAgICBsZXQgYW5jaG9yQ2FsbGluZyA9IFtdCiAgICAgICAgICAgIHN0YXRMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgc3RhcnRBdCA9IGl0ZW0uZ2V0U3RhcnRBdCgpCiAgICAgICAgICAgICAgICBrZXlzLnB1c2gobmV3IERhdGUoc3RhcnRBdCAqIDEwMDApLmZvcm1hdCgiSEg6bW0iKSkKICAgICAgICAgICAgICAgIGFpQ2FsbGluZy5wdXNoKGl0ZW0uZ2V0QWlDYWxsaW5nKCkpCiAgICAgICAgICAgICAgICB1c2VyQ2FsbGluZy5wdXNoKGl0ZW0uZ2V0VXNlckNhbGxpbmcoKSkKICAgICAgICAgICAgICAgIGFuY2hvckNhbGxpbmcucHVzaChpdGVtLmdldEFuY2hvckNhbGxpbmcoKSkKICAgICAgICAgICAgfSkKICAgICAgICAgICAgdmFsdWVzLnB1c2goYWlDYWxsaW5nKQogICAgICAgICAgICB2YWx1ZXMucHVzaCh1c2VyQ2FsbGluZykKICAgICAgICAgICAgdmFsdWVzLnB1c2goYW5jaG9yQ2FsbGluZykKCiAgICAgICAgICAgIHRoaXMuY2FsbGluZ0RhdGEua2V5cyA9IGtleXMKICAgICAgICAgICAgdGhpcy5jYWxsaW5nRGF0YS52YWx1ZXMgPSB2YWx1ZXMKICAgICAgICB9LAogICAgICAgIGhhbmRsZUNhbGxEYXRhKHN0YXRMaXN0KXsKICAgICAgICAgICAgbGV0IGtleXMgPSBbXQogICAgICAgICAgICBsZXQgdmFsdWVzID0gW10KICAgICAgICAgICAgbGV0IGFpQ2FsbCA9IFtdCiAgICAgICAgICAgIGxldCB1c2VyQ2FsbCA9IFtdCiAgICAgICAgICAgIGxldCBhbmNob3JDYWxsID0gW10KICAgICAgICAgICAgc3RhdExpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIGxldCBzdGFydEF0ID0gaXRlbS5nZXRTdGFydEF0KCkKICAgICAgICAgICAgICAgIGtleXMucHVzaChuZXcgRGF0ZShzdGFydEF0ICogMTAwMCkuZm9ybWF0KCJISDptbSIpKQogICAgICAgICAgICAgICAgYWlDYWxsLnB1c2goaXRlbS5nZXRBaUNhbGwoKSkKICAgICAgICAgICAgICAgIHVzZXJDYWxsLnB1c2goaXRlbS5nZXRVc2VyQ2FsbCgpKQogICAgICAgICAgICAgICAgYW5jaG9yQ2FsbC5wdXNoKGl0ZW0uZ2V0QW5jaG9yQ2FsbCgpKQogICAgICAgICAgICB9KQogICAgICAgICAgICB2YWx1ZXMucHVzaChhaUNhbGwpCiAgICAgICAgICAgIHZhbHVlcy5wdXNoKHVzZXJDYWxsKQogICAgICAgICAgICB2YWx1ZXMucHVzaChhbmNob3JDYWxsKQoKICAgICAgICAgICAgdGhpcy5jYWxsRGF0YS5rZXlzID0ga2V5cwogICAgICAgICAgICB0aGlzLmNhbGxEYXRhLnZhbHVlcyA9IHZhbHVlcwogICAgICAgIH0sCiAgICAgICAgc3RhcnRVbml4KCRkYXRlKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgkZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKSkuZ2V0VGltZSgpIC8gMTAwMAogICAgICAgIH0sCiAgICAgICAgZW5kVW5peCgkZGF0ZSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5zdGFydFVuaXgoJGRhdGUpICsgMjQgKiA2MCAqIDYwIC0gMQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["real-time.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"real-time.vue","sourceRoot":"src/views/manage/count","sourcesContent":["<template>\n    <div class=\"home-wrapper\">\n        <el-row class=\"date-box\" :gutter=\"20\">\n            <el-col :span=\"24\">\n                <el-card shadow=\"always\" :body-style=\"{padding: '10px', paddingTop:'20px'}\">\n                    <el-form\n                        ref=\"searchForm\"\n                        :inline=\"true\"\n                        :model=\"search\"\n                        label-width=\"90px\"\n                        class=\"search-form\"\n                    >\n                        <el-form-item label=\"区域\">\n                            <el-select v-model=\"search.areaId\" :disabled=\"authAreaId !== 0\" placeholder=\"请选择\">\n                                <el-option v-for=\"item in areaList\"\n                                           :key=\"item.value\"\n                                           :label=\"item.label\"\n                                           :value=\"item.value\">\n                                </el-option>\n                            </el-select>\n                        </el-form-item>\n                        <el-form-item>\n                            <el-button type=\"danger\" @click=\"onSearch\" icon=\"el-icon-refresh\">刷 新</el-button>\n                        </el-form-item>\n                    </el-form>\n                </el-card>\n            </el-col>\n        </el-row>\n        <el-row class=\"date-box\" :gutter=\"30\">\n            <el-col :span=\"24\">\n                <el-card shadow=\"always\" :body-style=\"{padding: '10px', paddingTop:'20px'}\">\n                    <ChartsLine :data=\"userData\" v-if=\"userData.values\" class=\"data-chart\"/>\n                </el-card>\n            </el-col>\n        </el-row>\n\n        <el-row class=\"date-box\" :gutter=\"30\">\n            <el-col :span=\"24\">\n                <el-card shadow=\"always\" :body-style=\"{padding: '10px', paddingTop:'20px'}\">\n                    <ChartsLine :data=\"callingData\" v-if=\"callingData.values\" class=\"data-chart\"/>\n                </el-card>\n            </el-col>\n        </el-row>\n\n        <el-row class=\"date-box\" :gutter=\"30\">\n            <el-col :span=\"24\">\n                <el-card shadow=\"always\" :body-style=\"{padding: '10px', paddingTop:'20px'}\">\n                    <ChartsLine :data=\"callData\" v-if=\"callData.values\" class=\"data-chart\"/>\n                </el-card>\n            </el-col>\n        </el-row>\n    </div>\n</template>\n\n<script>\nimport CountTo from 'vue-count-to'\nimport ChartsBarLine from '../../../components/Charts/ChartsBarLine'\nimport ChartsBar from '../../../components/Charts/ChartsBar'\nimport ChartsLine from '../../../components/Charts/ChartsLine'\nimport {getAreaList, getCurrentUserAreaId} from \"@/utils/dist\";\n\nexport default {\n    name: 'Home',\n    components: {CountTo, ChartsBar, ChartsBarLine, ChartsLine},\n    data() {\n        return {\n            search: {\n                areaId: getCurrentUserAreaId()\n            },\n            areaList: getAreaList(),\n            userData: {\n                title: '实时用户',\n                legend: ['在线用户', '新用户', '付费用户', '空闲主播', '通话主播'],\n                keys: [],\n                values: undefined\n            },\n            callingData: {\n                title: '实时通话',\n                legend: ['AIB发起', '用户发起', '主播发起'],\n                keys: [],\n                values: undefined\n            },\n            callData: {\n                title: '实时呼叫',\n                legend: ['整体呼叫', 'AIB呼叫', '用户呼叫', '主播呼叫'],\n                keys: [],\n                values: undefined\n            }\n        }\n    },\n    created() {\n        this.initData()\n    },\n    methods: {\n        onSearch() {\n            this.initData()\n        },\n        initData(){\n            const $this = this\n            let param = this.search\n            param.startAt = this.startUnix(new Date())\n            param.endAt = this.endUnix(new Date())\n            this.$service.home.getAreaStat(this.search, function (result){\n                let statList = result.getStatsList()\n                $this.handleUserData(statList)\n                $this.handleCallingData(statList)\n                $this.handleCallData(statList)\n            });\n        },\n        handleUserData(statList){\n            let keys = []\n            let values = []\n            let onlineUser = []\n            let newUser = []\n            let payUser = []\n            let idleAnchor = []\n            let busyAnchor = []\n            statList.forEach((item, index) => {\n                let startAt = item.getStartAt()\n                keys.push(new Date(startAt * 1000).format(\"HH:mm\"))\n                onlineUser.push(item.getOnlineUser())\n                newUser.push(item.getNewUser())\n                payUser.push(item.getPayUser())\n                idleAnchor.push(item.getIdleAnchor())\n                busyAnchor.push(item.getBusyAnchor())\n            })\n\n            values.push(onlineUser)\n            values.push(newUser)\n            values.push(payUser)\n            values.push(idleAnchor)\n            values.push(busyAnchor)\n\n            this.userData.keys = keys\n            this.userData.values = values\n        },\n        handleCallingData(statList){\n            let keys = []\n            let values = []\n            let aiCalling = []\n            let userCalling = []\n            let anchorCalling = []\n            statList.forEach((item, index) => {\n                let startAt = item.getStartAt()\n                keys.push(new Date(startAt * 1000).format(\"HH:mm\"))\n                aiCalling.push(item.getAiCalling())\n                userCalling.push(item.getUserCalling())\n                anchorCalling.push(item.getAnchorCalling())\n            })\n            values.push(aiCalling)\n            values.push(userCalling)\n            values.push(anchorCalling)\n\n            this.callingData.keys = keys\n            this.callingData.values = values\n        },\n        handleCallData(statList){\n            let keys = []\n            let values = []\n            let aiCall = []\n            let userCall = []\n            let anchorCall = []\n            statList.forEach((item, index) => {\n                let startAt = item.getStartAt()\n                keys.push(new Date(startAt * 1000).format(\"HH:mm\"))\n                aiCall.push(item.getAiCall())\n                userCall.push(item.getUserCall())\n                anchorCall.push(item.getAnchorCall())\n            })\n            values.push(aiCall)\n            values.push(userCall)\n            values.push(anchorCall)\n\n            this.callData.keys = keys\n            this.callData.values = values\n        },\n        startUnix($date) {\n            return new Date($date.toLocaleDateString()).getTime() / 1000\n        },\n        endUnix($date) {\n            return this.startUnix($date) + 24 * 60 * 60 - 1\n        }\n    }\n}\n</script>\n\n<style lang=\"less\">\n@import \"../../../assets/less/home\";\n</style>\n"]}]}