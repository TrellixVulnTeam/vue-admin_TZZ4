{"remainingRequest":"/home/mengy/Documents/iwork/kafo/vue-admin-design/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!/home/mengy/Documents/iwork/kafo/vue-admin-design/src/components/UploadImage/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/mengy/Documents/iwork/kafo/vue-admin-design/src/components/UploadImage/index.vue","mtime":1624500048821},{"path":"/home/mengy/Documents/iwork/kafo/vue-admin-design/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/Documents/iwork/kafo/vue-admin-design/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/mengy/Documents/iwork/kafo/vue-admin-design/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/Documents/iwork/kafo/vue-admin-design/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdVcGxvYWRJbWFnZScsDQogIHByb3BzOiB7DQogICAgYnRuTmFtZTogew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgZGVmYXVsdDogJ+mAieaLqeWbvueJhycNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBoYW5kbGVDaGFuZ2UoaW1hZ2UpIHsNCiAgICAgIGNvbnN0IHJhd0ltYWdlID0gaW1hZ2UucmF3DQogICAgICBpZiAoIXJhd0ltYWdlKSByZXR1cm4gZmFsc2UNCiAgICAgIGlmICghdGhpcy5pc0ltYWdlKHJhd0ltYWdlKSkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+WbvueJh+WPquaUr+aMgS5qcGcsIC5wbmcsIC5ibXAsIC5qcGVnLCAud2VicOagvOW8jyEnKQ0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLmlzTGltaXQ1TShyYXdJbWFnZSkpIHsNCiAgICAgICAgdGhpcy5yZWFkSW1hZ2UocmF3SW1hZ2UpDQogICAgICB9DQogICAgfSwNCiAgICBpc0xpbWl0NU0oaW1hZ2UpIHsNCiAgICAgIGNvbnN0IGlzTGltaXQ1TSA9IGltYWdlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDUNCiAgICAgIGlmIChpc0xpbWl0NU0pIHsNCiAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn5LiK5Lyg55qE5Zu+54mH5aSn5bCP5LiN6IO96LaF6L+HNU0hJykNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICB9DQogICAgfSwNCiAgICBpc0ltYWdlKGltYWdlKSB7DQogICAgICByZXR1cm4gL1wuKGpwZ3xwbmd8Ym1wfGpwZWd8d2VicCkkLy50ZXN0KGltYWdlLm5hbWUpDQogICAgfSwNCiAgICByZWFkSW1hZ2UoaW1hZ2UpIHsNCiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCkNCiAgICAgIHJlYWRlci5vbmxvYWQgPSBlID0+IHsNCiAgICAgICAgbGV0IGRhdGENCiAgICAgICAgaWYgKHR5cGVvZiBlLnRhcmdldC5yZXN1bHQgPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgLy8g5oqKQXJyYXkgQnVmZmVy6L2s5YyW5Li6YmxvYiDlpoLmnpzmmK9iYXNlNjTkuI3pnIDopoENCiAgICAgICAgICBkYXRhID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2UudGFyZ2V0LnJlc3VsdF0pKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGRhdGEgPSBlLnRhcmdldC5yZXN1bHQNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLiRlbWl0KCdvbi1zdWNjZXNzJywgZGF0YSkNCiAgICAgIH0NCiAgICAgIC8vIOi9rOWMluS4umJhc2U2NA0KICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW1hZ2UpDQogICAgICAvLyDovazljJbkuLpibG9iDQogICAgICAvLyByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoaW1hZ2UpDQogICAgICByZWFkZXIub25lcnJvciA9IGUgPT4gew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCflm77niYfor7vlj5blh7rplJkhJykNCiAgICAgIH0NCiAgICAgIHRoaXMuJHJlZnMudXBsb2FkSW1hZ2UuY2xlYXJGaWxlcygpDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/UploadImage","sourcesContent":["<template>\r\n  <el-upload\r\n    ref=\"uploadImage\"\r\n    class=\"upload-image-wrapper\"\r\n    action=\"\"\r\n    accept=\".jpg, .png, .bmp, .jpeg, .webp\"\r\n    :multiple=\"false\"\r\n    :show-file-list=\"false\"\r\n    :auto-upload=\"false\"\r\n    :on-change=\"handleChange\"\n  >\r\n    <el-button size=\"small\" type=\"primary\">{{ btnName }}</el-button>\r\n  </el-upload>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'UploadImage',\r\n  props: {\r\n    btnName: {\r\n      type: String,\r\n      default: '选择图片'\r\n    }\r\n  },\r\n  methods: {\r\n    handleChange(image) {\r\n      const rawImage = image.raw\r\n      if (!rawImage) return false\r\n      if (!this.isImage(rawImage)) {\r\n        this.$message.warning('图片只支持.jpg, .png, .bmp, .jpeg, .webp格式!')\r\n        return false\r\n      }\r\n      if (this.isLimit5M(rawImage)) {\r\n        this.readImage(rawImage)\r\n      }\r\n    },\r\n    isLimit5M(image) {\r\n      const isLimit5M = image.size / 1024 / 1024 < 5\r\n      if (isLimit5M) {\r\n        return true\r\n      } else {\r\n        this.$message.warning('上传的图片大小不能超过5M!')\r\n        return false\r\n      }\r\n    },\r\n    isImage(image) {\r\n      return /\\.(jpg|png|bmp|jpeg|webp)$/.test(image.name)\r\n    },\r\n    readImage(image) {\r\n      const reader = new FileReader()\r\n      reader.onload = e => {\r\n        let data\r\n        if (typeof e.target.result === 'object') {\r\n          // 把Array Buffer转化为blob 如果是base64不需要\r\n          data = window.URL.createObjectURL(new Blob([e.target.result]))\r\n        } else {\r\n          data = e.target.result\r\n        }\r\n        this.$emit('on-success', data)\r\n      }\r\n      // 转化为base64\r\n      reader.readAsDataURL(image)\r\n      // 转化为blob\r\n      // reader.readAsArrayBuffer(image)\r\n      reader.onerror = e => {\r\n        this.$message.error('图片读取出错!')\r\n      }\r\n      this.$refs.uploadImage.clearFiles()\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}