{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mengy/develop/iwork/kafo/vue-admin/src/components/UploadImage/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-admin/src/components/UploadImage/index.vue","mtime":1626074843763},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogJ1VwbG9hZEltYWdlJywNCiAgICBwcm9wczogew0KICAgICAgICBidG5OYW1lOiB7DQogICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICBkZWZhdWx0OiAn6YCJ5oup5Zu+54mHJw0KICAgICAgICB9DQogICAgfSwNCiAgICBtZXRob2RzOiB7DQogICAgICAgIGhhbmRsZUNoYW5nZShpbWFnZSkgew0KICAgICAgICAgICAgY29uc3QgcmF3SW1hZ2UgPSBpbWFnZS5yYXcNCiAgICAgICAgICAgIGlmICghcmF3SW1hZ2UpIHJldHVybiBmYWxzZQ0KICAgICAgICAgICAgaWYgKCF0aGlzLmlzSW1hZ2UocmF3SW1hZ2UpKSB7DQogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCflm77niYflj6rmlK/mjIEuanBnLCAucG5nLCAuYm1wLCAuanBlZywgLndlYnDmoLzlvI8hJykNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICh0aGlzLmlzTGltaXQ1TShyYXdJbWFnZSkpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnJlYWRJbWFnZShyYXdJbWFnZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgaXNMaW1pdDVNKGltYWdlKSB7DQogICAgICAgICAgICBjb25zdCBpc0xpbWl0NU0gPSBpbWFnZS5zaXplIC8gMTAyNCAvIDEwMjQgPCA1DQogICAgICAgICAgICBpZiAoaXNMaW1pdDVNKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfkuIrkvKDnmoTlm77niYflpKflsI/kuI3og73otoXov4c1TSEnKQ0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBpc0ltYWdlKGltYWdlKSB7DQogICAgICAgICAgICByZXR1cm4gL1wuKGpwZ3xwbmd8Ym1wfGpwZWd8d2VicCkkLy50ZXN0KGltYWdlLm5hbWUpDQogICAgICAgIH0sDQogICAgICAgIHJlYWRJbWFnZShpbWFnZSkgew0KICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKQ0KICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGUgPT4gew0KICAgICAgICAgICAgICAgIGxldCBkYXRhDQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlLnRhcmdldC5yZXN1bHQgPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIOaKikFycmF5IEJ1ZmZlcui9rOWMluS4umJsb2Ig5aaC5p6c5pivYmFzZTY05LiN6ZyA6KaBDQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbZS50YXJnZXQucmVzdWx0XSkpDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGUudGFyZ2V0LnJlc3VsdA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdvbi1zdWNjZXNzJywgZGF0YSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vIOi9rOWMluS4umJhc2U2NA0KICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW1hZ2UpDQogICAgICAgICAgICAvLyDovazljJbkuLpibG9iDQogICAgICAgICAgICAvLyByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoaW1hZ2UpDQogICAgICAgICAgICByZWFkZXIub25lcnJvciA9IGUgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WbvueJh+ivu+WPluWHuumUmSEnKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy4kcmVmcy51cGxvYWRJbWFnZS5jbGVhckZpbGVzKCkNCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/UploadImage","sourcesContent":["<template>\r\n    <el-upload\r\n        ref=\"uploadImage\"\r\n        class=\"upload-image-wrapper\"\r\n        action=\"\"\r\n        accept=\".jpg, .png, .bmp, .jpeg, .webp\"\r\n        :multiple=\"false\"\r\n        :show-file-list=\"false\"\r\n        :auto-upload=\"false\"\r\n        :on-change=\"handleChange\"\r\n    >\r\n        <el-button size=\"small\" type=\"primary\">{{ btnName }}</el-button>\r\n    </el-upload>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: 'UploadImage',\r\n    props: {\r\n        btnName: {\r\n            type: String,\r\n            default: '选择图片'\r\n        }\r\n    },\r\n    methods: {\r\n        handleChange(image) {\r\n            const rawImage = image.raw\r\n            if (!rawImage) return false\r\n            if (!this.isImage(rawImage)) {\r\n                this.$message.warning('图片只支持.jpg, .png, .bmp, .jpeg, .webp格式!')\r\n                return false\r\n            }\r\n            if (this.isLimit5M(rawImage)) {\r\n                this.readImage(rawImage)\r\n            }\r\n        },\r\n        isLimit5M(image) {\r\n            const isLimit5M = image.size / 1024 / 1024 < 5\r\n            if (isLimit5M) {\r\n                return true\r\n            } else {\r\n                this.$message.warning('上传的图片大小不能超过5M!')\r\n                return false\r\n            }\r\n        },\r\n        isImage(image) {\r\n            return /\\.(jpg|png|bmp|jpeg|webp)$/.test(image.name)\r\n        },\r\n        readImage(image) {\r\n            const reader = new FileReader()\r\n            reader.onload = e => {\r\n                let data\r\n                if (typeof e.target.result === 'object') {\r\n                    // 把Array Buffer转化为blob 如果是base64不需要\r\n                    data = window.URL.createObjectURL(new Blob([e.target.result]))\r\n                } else {\r\n                    data = e.target.result\r\n                }\r\n                this.$emit('on-success', data)\r\n            }\r\n            // 转化为base64\r\n            reader.readAsDataURL(image)\r\n            // 转化为blob\r\n            // reader.readAsArrayBuffer(image)\r\n            reader.onerror = e => {\r\n                this.$message.error('图片读取出错!')\r\n            }\r\n            this.$refs.uploadImage.clearFiles()\r\n        }\r\n    }\r\n}\r\n</script>\r\n"]}]}