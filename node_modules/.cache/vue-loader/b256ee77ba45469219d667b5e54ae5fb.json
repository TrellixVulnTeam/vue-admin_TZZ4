{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mengy/develop/iwork/kafo/vue-manage/src/components/ElementDrr/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-manage/src/components/ElementDrr/index.vue","mtime":1626074721542},{"path":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgVnVlRHJyIGZyb20gJy4uLy4uL2NvbXBvbmVudHMvVnVlRHJyJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogJ0VsZW1lbnREcnInLA0KICAgIGNvbXBvbmVudHM6IHtWdWVEcnJ9LA0KICAgIHByb3BzOiB7DQogICAgICAgIGVsZW1lbnQ6IHsNCiAgICAgICAgICAgIHR5cGU6IE9iamVjdCwNCiAgICAgICAgICAgIGRlZmF1bHQ6ICgpID0+IHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlczogew0KICAgICAgICAgICAgdHlwZTogQXJyYXksDQogICAgICAgICAgICBkZWZhdWx0OiAoKSA9PiBbJ24nLCAnZScsICdzJywgJ3cnLCAnbncnLCAnbmUnLCAnc2UnLCAnc3cnXQ0KICAgICAgICB9DQogICAgfSwNCiAgICB3YXRjaDogew0KICAgICAgICBlbGVtZW50OiB7DQogICAgICAgICAgICBoYW5kbGVyKHZhbCkgew0KICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVIZWlnaHQoKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZGVlcDogdHJ1ZQ0KICAgICAgICB9DQogICAgfSwNCiAgICBtZXRob2RzOiB7DQogICAgICAgIC8vIOWQjOatpeabtOaWsOWuueWZqOmrmOW6pg0KICAgICAgICB1cGRhdGVIZWlnaHQoKSB7DQogICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LnR5cGUgPT09ICd0ZXh0Jykgew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLiRlbA0KICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgdmlld0hlaWdodCA9IE1hdGguY2VpbChub2RlLnBhcmVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBoID0gTWF0aC5jZWlsKG5vZGUucXVlcnlTZWxlY3RvcignLmltYWdlLXJpY2gtdGV4dCcpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCkNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC55ICsgaCA+PSB2aWV3SGVpZ2h0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQueSA9IHZpZXdIZWlnaHQgLSBoDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBoICsgJ3B4Jw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuaCA9IGgNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvLyDlpITnkIbmi5bmlL4NCiAgICAgICAgaGFuZGxlRHJhZ1N0b3AoeCwgeSkgew0KICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC54ICE9PSB4IHx8IHRoaXMuZWxlbWVudC55ICE9PSB5KSB7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnggPSB4DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnkgPSB5DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8vIOe8qeaUvuaWh+acrOaXtuabtOaWsOmrmOW6pg0KICAgICAgICBoYW5kbGVSZXNpemluZygpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQudHlwZSA9PT0gJ3RleHQnKSB7DQogICAgICAgICAgICAgICAgdGhpcy51cGRhdGVIZWlnaHQoKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvLyDlpITnkIbnvKnmlL4NCiAgICAgICAgaGFuZGxlUmVzaXplU3RvcCh4LCB5LCB3LCBoKSB7DQogICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LnggIT09IHggfHwgdGhpcy5lbGVtZW50LnkgIT09IHkgfHwgdGhpcy5lbGVtZW50LncgIT09IHcgfHwgdGhpcy5lbGVtZW50LmggIT09IGgpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQueCA9IHgNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQueSA9IHkNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudyA9IHcNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LnR5cGUgPT09ICd0ZXh0Jykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUhlaWdodCgpDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmggPSBoDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvLyDlpITnkIblpLHnhKYNCiAgICAgICAgaGFuZGxlRGVhY3RpdmF0ZSgpIHsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hY3RpdmUgPSBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICAvLyDlpITnkIbogZrnhKYNCiAgICAgICAgaGFuZGxlQWN0aXZhdGVkKCkgew0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFjdGl2ZSA9IHRydWUNCiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZUFjdGl2ZUVsZScsIHRoaXMuZWxlbWVudCkNCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/ElementDrr","sourcesContent":["<template>\r\n    <VueDrr\r\n        class=\"element-drr-wrapper\"\r\n        :x=\"element.x\"\r\n        :y=\"element.y\"\r\n        :w=\"element.w\"\r\n        :h=\"element.h\"\r\n        :handles=\"handles\"\r\n        :active=\"element.active\"\r\n        :minw=\"80\"\r\n        :minh=\"18\"\r\n        :parent=\"true\"\r\n        :rotatable=\"false\"\r\n        @dragstop=\"handleDragStop\"\r\n        @resizing=\"handleResizing\"\r\n        @resizestop=\"handleResizeStop\"\r\n        @deactivated=\"handleDeactivate\"\r\n        @activated=\"handleActivated\"\r\n    >\r\n        <slot/>\r\n    </VueDrr>\r\n</template>\r\n\r\n<script>\r\nimport VueDrr from '../../components/VueDrr'\r\n\r\nexport default {\r\n    name: 'ElementDrr',\r\n    components: {VueDrr},\r\n    props: {\r\n        element: {\r\n            type: Object,\r\n            default: () => {\r\n            }\r\n        },\r\n        handles: {\r\n            type: Array,\r\n            default: () => ['n', 'e', 's', 'w', 'nw', 'ne', 'se', 'sw']\r\n        }\r\n    },\r\n    watch: {\r\n        element: {\r\n            handler(val) {\r\n                this.$nextTick(() => {\r\n                    this.updateHeight()\r\n                })\r\n            },\r\n            deep: true\r\n        }\r\n    },\r\n    methods: {\r\n        // 同步更新容器高度\r\n        updateHeight() {\r\n            if (this.element.type === 'text') {\r\n                const node = this.$el\r\n                this.$nextTick(() => {\r\n                    const viewHeight = Math.ceil(node.parentNode.getBoundingClientRect().height)\r\n                    const h = Math.ceil(node.querySelector('.image-rich-text').getBoundingClientRect().height)\r\n                    if (this.element.y + h >= viewHeight) {\r\n                        this.element.y = viewHeight - h\r\n                    }\r\n                    node.style.height = h + 'px'\r\n                    this.element.h = h\r\n                })\r\n            }\r\n        },\r\n        // 处理拖放\r\n        handleDragStop(x, y) {\r\n            if (this.element.x !== x || this.element.y !== y) {\r\n                this.element.x = x\r\n                this.element.y = y\r\n            }\r\n        },\r\n        // 缩放文本时更新高度\r\n        handleResizing() {\r\n            if (this.element.type === 'text') {\r\n                this.updateHeight()\r\n            }\r\n        },\r\n        // 处理缩放\r\n        handleResizeStop(x, y, w, h) {\r\n            if (this.element.x !== x || this.element.y !== y || this.element.w !== w || this.element.h !== h) {\r\n                this.element.x = x\r\n                this.element.y = y\r\n                this.element.w = w\r\n                if (this.element.type === 'text') {\r\n                    this.updateHeight()\r\n                } else {\r\n                    this.element.h = h\r\n                }\r\n            }\r\n        },\r\n        // 处理失焦\r\n        handleDeactivate() {\r\n            this.element.active = false\r\n        },\r\n        // 处理聚焦\r\n        handleActivated() {\r\n            this.element.active = true\r\n            this.$emit('updateActiveEle', this.element)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.element-drr-wrapper {\r\n    .z-handle-nw,\r\n    .z-handle-ne,\r\n    .z-handle-sw,\r\n    .z-handle-se,\r\n    .z-handle-n:after,\r\n    .z-handle-w:after,\r\n    .z-handle-e:after,\r\n    .z-handle-s:after {\r\n        width: 9px;\r\n        height: 9px;\r\n    }\r\n}\r\n</style>\r\n"]}]}