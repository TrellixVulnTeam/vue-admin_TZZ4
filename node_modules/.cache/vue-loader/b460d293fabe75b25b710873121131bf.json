{"remainingRequest":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mengy/develop/iwork/kafo/vue-admin/src/views/manage/audit/dialog/anchor-video-list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/mengy/develop/iwork/kafo/vue-admin/src/views/manage/audit/dialog/anchor-video-list.vue","mtime":1634633035770},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mengy/develop/iwork/kafo/vue-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQYWdpbmF0aW9uIGZyb20gJy4uLy4uLy4uLy4uL2NvbXBvbmVudHMvUGFnaW5hdGlvbicKaW1wb3J0IFZ1ZVZpZGVvUGxheWVyIGZyb20gJy4uLy4uLy4uLy4uL2NvbXBvbmVudHMvVnVlVmlkZW9QbGF5ZXInCmltcG9ydCB7Z2V0QXBwTGlzdCwgZ2V0QXBwTmFtZSwgZ2V0QXJlYUxpc3QsIGdldEFyck5hbWUsIGdldEZpbGVUeXBlLCBnZXRSZXZpZXdTdGF0dXN9IGZyb20gIkAvdXRpbHMvZGlzdCIKaW1wb3J0IHt0b1RpbWV9IGZyb20gIkAvdXRpbHMvZGF0ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAnVGFibGUnLAogICAgY29tcG9uZW50czogeyBQYWdpbmF0aW9uLCBWdWVWaWRlb1BsYXllciB9LAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAvLyDmlbDmja7liJfooajliqDovb3liqjnlLsKICAgICAgICAgICAgbGlzdExvYWRpbmc6IHRydWUsCiAgICAgICAgICAgIHNlYXJjaDogewogICAgICAgICAgICAgICAgYW5jaG9ySWQgOiB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICBzdGF0dXM6IDUsCiAgICAgICAgICAgICAgICBwYWdlOiB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhZ2U6IDEsCiAgICAgICAgICAgICAgICAgICAgcGFnZVNpemU6IDEwCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHZpZGVvTGlzdDogW10sCiAgICAgICAgICAgIGltZ0xpc3Q6IFtdLAogICAgICAgICAgICAvLyDmlbDmja7mgLvmnaHmlbAKICAgICAgICAgICAgdG90YWw6IDAsCiAgICAgICAgICAgIG11bHRpcGxlU2VsZWN0aW9uOiBbXSwKICAgICAgICAgICAgcGxheVZpc2libGU6IGZhbHNlLAogICAgICAgICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgYXBwTGlzdDogZ2V0QXBwTGlzdCgpLAogICAgICAgICAgICBhcmVhTGlzdDogZ2V0QXJlYUxpc3QodHJ1ZSksCiAgICAgICAgICAgIGZpbGVUeXBlTGlzdDogZ2V0RmlsZVR5cGUoKQogICAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMuZmV0Y2hEYXRhKCkKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgaW5pdChyb3cpewogICAgICAgICAgICB0aGlzLnNlYXJjaC5hbmNob3JJZCA9IHJvdy5vd25lcklkCiAgICAgICAgICAgIHRoaXMuZmV0Y2hEYXRhKCkKICAgICAgICB9LAogICAgICAgIGZldGNoRGF0YSgpIHsKICAgICAgICAgICAgY29uc3QgJHRoaXMgPSB0aGlzCiAgICAgICAgICAgIHRoaXMubGlzdExvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgIHRoaXMuJHNlcnZpY2UuYXVkaXQuZ2V0TGl2ZUxpc3QodGhpcy5zZWFyY2gsIGZ1bmN0aW9uIChyZXN1bHQpewogICAgICAgICAgICAgICAgY29uc3QgbGlzdCA9IHJlc3VsdC5nZXRSZWNvcmRzTGlzdCgpCiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gW10KICAgICAgICAgICAgICAgIGxpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpPT57CiAgICAgICAgICAgICAgICAgICAgY29uc3QganNvbiA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgImlkIiA6IGl0ZW0uZ2V0SWQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgImFwcCIgOiBnZXRBcHBOYW1lKCR0aGlzLmFwcExpc3QsIGl0ZW0uZ2V0QXBwSWQoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICJhcmVhU3RyIiA6IGdldEFyck5hbWUoJHRoaXMuYXJlYUxpc3QsIGl0ZW0uZ2V0QXJlYUlkKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSIgOiBnZXRBcnJOYW1lKCR0aGlzLmZpbGVUeXBlTGlzdCwgaXRlbS5nZXRUeXBlKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAib3duZXJJZCIgOiBpdGVtLmdldE93bmVySWQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgInRodW1iIiA6IGl0ZW0uZ2V0VGh1bWIoKSwKICAgICAgICAgICAgICAgICAgICAgICAgInVyaSIgOiBpdGVtLmdldFVyaSgpLAogICAgICAgICAgICAgICAgICAgICAgICAic3RhdHVzIiA6IGdldFJldmlld1N0YXR1cyhpdGVtLmdldFN0YXR1cygpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2goanNvbikKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAkdGhpcy50b3RhbCA9IHJlc3VsdC5nZXRUb3RhbENvdW50KCkKICAgICAgICAgICAgICAgICR0aGlzLnRhYmxlRGF0YSA9IGRhdGEKICAgICAgICAgICAgICAgICR0aGlzLmxpc3RMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBwbGF5KHJvdykgewogICAgICAgICAgICB0aGlzLnBsYXlWaXNpYmxlID0gdHJ1ZTsKICAgICAgICAgICAgbGV0IHNyYyA9IHJvdy51cmkKICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCk9PnsKICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMubXlWaWRlb1BsYXllci5pbml0U3JjKHNyYyk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICAvLyDlpJrpgInmk43kvZwKICAgICAgICBoYW5kbGVTZWxlY3Rpb25DaGFuZ2UodmFsKSB7CiAgICAgICAgICAgIHRoaXMubXVsdGlwbGVTZWxlY3Rpb24gPSB2YWwKICAgICAgICB9LAogICAgICAgIGNsb3NlVmlkZW8oKXsKICAgICAgICAgICAgdGhpcy5wbGF5VmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKT0+ewogICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5teVZpZGVvUGxheWVyLmVtcHR5U3JjKCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBjbG9zZURpYWxvZygpIHsKICAgICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgdGhpcy5yZXNldEZvcm0oKQogICAgICAgICAgICB0aGlzLiRlbWl0KCdmZXRjaERhdGEnKTsKICAgICAgICB9LAogICAgICAgIHBhc3NlZChyb3cpIHsKICAgICAgICAgICAgY29uc3QgJHRoaXMgPSB0aGlzCiAgICAgICAgICAgIGxldCBwYXJhbSA9IHsKICAgICAgICAgICAgICAgICJpZCIgOiByb3cuaWQsCiAgICAgICAgICAgICAgICAic3RhdHVzIiA6IDUKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLiRzZXJ2aWNlLmF1ZGl0LnByb2Nlc3NMaXZlKHBhcmFtLCBmdW5jdGlvbiAocmVzdWx0KXsKICAgICAgICAgICAgICAgIHJlc3VsdCA/ICR0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWuoeaguOmAmui/hyAhIikgOiAkdGhpcy4kbWVzc2FnZS5lcnJvcigi5a6h5qC45aSx6LSlICEiKQogICAgICAgICAgICAgICAgJHRoaXMuZmV0Y2hEYXRhKCkKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICAvLyDliKDpmaQKICAgICAgICBkZWxWaWRlbyhyb3cpIHsKICAgICAgICAgICAgY29uc3QgJHRoaXMgPSB0aGlzCiAgICAgICAgICAgIGxldCBwYXJhbSA9IHsKICAgICAgICAgICAgICAgICJpZCIgOiByb3cuaWQsCiAgICAgICAgICAgICAgICAic3RhdHVzIiA6IDQKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLiRzZXJ2aWNlLmF1ZGl0LnByb2Nlc3NMaXZlKHBhcmFtLCBmdW5jdGlvbiAocmVzdWx0KXsKICAgICAgICAgICAgICAgIHJlc3VsdCA/ICR0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuW3suWIoOmZpCAhIikgOiAkdGhpcy4kbWVzc2FnZS5lcnJvcigi5Yig6Zmk5aSx6LSlICEiKQogICAgICAgICAgICAgICAgJHRoaXMuZmV0Y2hEYXRhKCkKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBiYXRjaFBhc3NlZCgpewogICAgICAgICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnBhc3NlZChpdGVtKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYmF0Y2hEZWxlKCl7CiAgICAgICAgICAgIHRoaXMubXVsdGlwbGVTZWxlY3Rpb24uZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuZGVsVmlkZW8oaXRlbSkKICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["anchor-video-list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"anchor-video-list.vue","sourceRoot":"src/views/manage/audit/dialog","sourcesContent":["<template>\n    <el-dialog title=\"查看视频\" :visible.sync=\"dialogVisible\" append-to-body width=\"60%\" :before-close=\"handleClose\">\n        <div class=\"table-classic-wrapper dialog-list\">\n            <!-- 操作栏 -->\n            <div class=\"control-btns\">\n                <el-button type=\"primary\" icon=\"el-icon-check\" @click=\"batchPassed\">批量通过</el-button>\n                <el-button type=\"warning\" icon=\"el-icon-delete\" @click=\"batchDele\">批量删除</el-button>\n            </div>\n            <!-- 表格栏 -->\n            <el-table\n                ref=\"multipleTable\"\n                v-loading=\"listLoading\"\n                :data=\"tableData\"\n                tooltip-effect=\"dark\"\n                style=\"width: 100%\"\n                size=\"medium\"\n                @selection-change=\"handleSelectionChange\"\n            >\n                <el-table-column type=\"selection\" width=\"60\"/>\n                <el-table-column prop=\"id\" label=\"ID\" align=\"center\" width=\"150\" />\n                <el-table-column prop=\"ownerId\" label=\"所有者ID\" align=\"center\" width=\"150\"/>\n                <el-table-column prop=\"thumb\" label=\"视频\" align=\"center\" width=\"180\">\n                    <template scope=\"scope\">\n                        <el-image @click=\"play(scope.row)\" style=\"width: 50px; height: 50px\" :src=\"scope.row.thumb\" contain></el-image>\n                    </template>\n                </el-table-column>\n                <el-table-column prop=\"areaStr\" label=\"区域\" align=\"center\" width=\"180\"/>\n                <el-table-column prop=\"status\" label=\"审核状态\" align=\"center\" width=\"120\"/>\n                <el-table-column label=\"操作\" align=\"center\" fixed=\"right\">\n                    <template slot-scope=\"scope\">\n                        <el-button type=\"text\" @click=\"passed(scope.row)\">通过</el-button>\n                        <el-button type=\"text\" @click=\"delVideo(scope.row)\">删除</el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n            <!-- 分页栏 -->\n            <Pagination :total=\"total\" :page.sync=\"search.page.currentPage\" :limit.sync=\"search.page.pageSize\"\n                        @pagination=\"fetchData\"/>\n        </div>\n        <el-dialog\n            title=\"播放视频\"\n            :visible.sync=\"playVisible\"\n            :before-close=\"closeVideo\"\n            :append-to-body=\"true\">\n            <div class=\"content-item\">\n                <VueVideoPlayer ref=\"myVideoPlayer\"></VueVideoPlayer>\n            </div>\n        </el-dialog>\n    </el-dialog>\n</template>\n\n<script>\nimport Pagination from '../../../../components/Pagination'\nimport VueVideoPlayer from '../../../../components/VueVideoPlayer'\nimport {getAppList, getAppName, getAreaList, getArrName, getFileType, getReviewStatus} from \"@/utils/dist\"\nimport {toTime} from \"@/utils/date\";\n\nexport default {\n    name: 'Table',\n    components: { Pagination, VueVideoPlayer },\n    data() {\n        return {\n            // 数据列表加载动画\n            listLoading: true,\n            search: {\n                anchorId : undefined,\n                status: 5,\n                page: {\n                    currentPage: 1,\n                    pageSize: 10\n                }\n            },\n            videoList: [],\n            imgList: [],\n            // 数据总条数\n            total: 0,\n            multipleSelection: [],\n            playVisible: false,\n            dialogVisible: false,\n            appList: getAppList(),\n            areaList: getAreaList(true),\n            fileTypeList: getFileType()\n        }\n    },\n    created() {\n        this.fetchData()\n    },\n    methods: {\n        init(row){\n            this.search.anchorId = row.ownerId\n            this.fetchData()\n        },\n        fetchData() {\n            const $this = this\n            this.listLoading = true\n            this.$service.audit.getLiveList(this.search, function (result){\n                const list = result.getRecordsList()\n                const data = []\n                list.forEach((item, index)=>{\n                    const json = {\n                        \"id\" : item.getId(),\n                        \"app\" : getAppName($this.appList, item.getAppId()),\n                        \"areaStr\" : getArrName($this.areaList, item.getAreaId()),\n                        \"type\" : getArrName($this.fileTypeList, item.getType()),\n                        \"ownerId\" : item.getOwnerId(),\n                        \"thumb\" : item.getThumb(),\n                        \"uri\" : item.getUri(),\n                        \"status\" : getReviewStatus(item.getStatus())\n                    }\n                    data.push(json)\n                })\n                $this.total = result.getTotalCount()\n                $this.tableData = data\n                $this.listLoading = false\n            });\n        },\n        play(row) {\n            this.playVisible = true;\n            let src = row.uri\n            this.$nextTick(()=>{\n                this.$refs.myVideoPlayer.initSrc(src);\n            })\n        },\n        // 多选操作\n        handleSelectionChange(val) {\n            this.multipleSelection = val\n        },\n        closeVideo(){\n            this.playVisible = false;\n            this.$nextTick(()=>{\n                this.$refs.myVideoPlayer.emptySrc();\n            })\n        },\n        closeDialog() {\n            this.dialogVisible = false\n            this.resetForm()\n            this.$emit('fetchData');\n        },\n        passed(row) {\n            const $this = this\n            let param = {\n                \"id\" : row.id,\n                \"status\" : 5\n            }\n            this.$service.audit.processLive(param, function (result){\n                result ? $this.$message.success(\"审核通过 !\") : $this.$message.error(\"审核失败 !\")\n                $this.fetchData()\n            });\n        },\n        // 删除\n        delVideo(row) {\n            const $this = this\n            let param = {\n                \"id\" : row.id,\n                \"status\" : 4\n            }\n            this.$service.audit.processLive(param, function (result){\n                result ? $this.$message.success(\"已删除 !\") : $this.$message.error(\"删除失败 !\")\n                $this.fetchData()\n            });\n        },\n        batchPassed(){\n            this.multipleSelection.forEach(item => {\n                this.passed(item)\n            })\n        },\n        batchDele(){\n            this.multipleSelection.forEach(item => {\n                this.delVideo(item)\n            })\n        }\n    }\n}\n</script>\n\n<style lang=\"less\">\n.dialog-list{\n    padding-left: 20px;\n    padding-right: 20px;\n    padding-bottom:  20px;\n}\n</style>\n"]}]}