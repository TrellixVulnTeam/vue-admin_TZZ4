{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-8db3985e\"],{1:function(e,t){},\"1acb\":function(e,t,i){},\"206f\":function(e,t,i){\"use strict\";i(\"f678\")},\"333d\":function(e,t,i){\"use strict\";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"pagination-wrapper\"},[i(\"el-pagination\",{attrs:{background:e.background,\"current-page\":e.currentPage,\"page-sizes\":e.pageSizes,\"page-size\":e.pageSize,total:e.total,layout:e.layout},on:{\"update:currentPage\":function(t){e.currentPage=t},\"update:current-page\":function(t){e.currentPage=t},\"update:pageSize\":function(t){e.pageSize=t},\"update:page-size\":function(t){e.pageSize=t},\"size-change\":e.handleSizeChange,\"current-change\":e.handleCurrentChange}})],1)},o=[],r=(i(\"a9e3\"),{name:\"Pagination\",props:{page:{type:Number,default:1,required:!0},limit:{type:Number,default:10,required:!0},background:{type:Boolean,default:!0},pageSizes:{type:Array,default:function(){return[5,10,15,20,50,1e3]}},total:{type:Number,default:0,required:!0},layout:{type:String,default:\"total, prev, pager, next, sizes, jumper\"}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit(\"update:page\",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.emit(\"update:limit\",e)}}},methods:{handleSizeChange:function(e){this.$emit(\"changePageSize\",{page:this.currentPage,limit:e}),this.$emit(\"pagination\",{page:this.currentPage,limit:e})},handleCurrentChange:function(e){this.$emit(\"pagination\",{page:e,limit:this.pageSize})}}}),n=r,s=(i(\"206f\"),i(\"2877\")),l=Object(s[\"a\"])(n,a,o,!1,null,null,null);t[\"a\"]=l.exports},\"404b\":function(e,t,i){\"use strict\";i(\"de17\")},a55c:function(e,t,i){},b522:function(e,t,i){\"use strict\";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"hints-wrapper\"},[i(\"div\",{staticClass:\"hint-title\"},[i(\"i\",{staticClass:\"vue-dsn-icon-tishi\"}),i(\"span\",[e._t(\"hintName\")],2)]),i(\"div\",{staticClass:\"hint-info\"},[e._t(\"hintInfo\")],2)])},o=[],r={name:\"Hints\"},n=r,s=(i(\"404b\"),i(\"2877\")),l=Object(s[\"a\"])(n,a,o,!1,null,null,null);t[\"a\"]=l.exports},bab2:function(e,t,i){\"use strict\";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"table-classic-wrapper\"},[i(\"Hints\",{attrs:{hidden:e.isHints}},[i(\"template\",{slot:\"hintName\"},[e._v(\" 编辑 < \"+e._s(e.search.nickname)+\" > 话术\")])],2),i(\"el-card\",{attrs:{shadow:\"always\"}},[i(\"div\",{staticClass:\"control-btns\"},[i(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(t){return e.toDialog(\"addRobotMessage\",\"\")}}},[e._v(\"+ 新增话术\")])],1),i(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],ref:\"multipleTable\",staticStyle:{width:\"100%\"},attrs:{data:e.tableData,\"tooltip-effect\":\"dark\",size:\"medium\"},on:{\"selection-change\":e.handleSelectionChange}},[i(\"el-table-column\",{attrs:{type:\"selection\",width:\"60\"}}),i(\"el-table-column\",{attrs:{prop:\"robotId\",label:\"机器人ID\",align:\"center\",width:\"120\"}}),i(\"el-table-column\",{attrs:{prop:\"typeStr\",label:\"话术类型\",align:\"center\",width:\"100\"}}),i(\"el-table-column\",{attrs:{prop:\"actionStr\",label:\"动作类型\",align:\"center\",width:\"100\"}}),i(\"el-table-column\",{attrs:{prop:\"text\",label:\"内容\",align:\"center\",width:\"350\"}}),i(\"el-table-column\",{attrs:{prop:\"thumb\",label:\"文件\",align:\"center\",width:\"150\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[4===t.row.type?i(\"div\",[i(\"el-image\",{staticStyle:{width:\"50px\",height:\"50px\"},attrs:{fit:e.contain,src:t.row.uri,\"preview-src-list\":[t.row.uri]}})],1):e._e(),5===t.row.type||8===t.row.type?i(\"div\",[e._v(\"\\n                            \"+e._s(t.row.thumb)+\"\\n                            \"),i(\"el-image\",{staticStyle:{width:\"50px\",height:\"50px\"},attrs:{src:t.row.thumb,contain:\"\"},on:{click:function(i){return e.play(t.row)}}})],1):e._e(),6===t.row.type?i(\"div\",[t.row.uri?i(\"div\",[i(\"m-audio\",{attrs:{src:t.row.uri}})],1):e._e()]):e._e()]}}])}),i(\"el-table-column\",{attrs:{prop:\"sort\",label:\"排序\",align:\"center\",width:\"150\"}}),i(\"el-table-column\",{attrs:{prop:\"enable\",label:\"状态\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[i(\"el-switch\",{attrs:{disabled:\"\"},model:{value:t.row.enable,callback:function(i){e.$set(t.row,\"enable\",i)},expression:\"scope.row.enable\"}})]}}])}),i(\"el-table-column\",{attrs:{prop:\"interval\",label:\"间隔时间\",align:\"center\",width:\"150\"}}),i(\"el-table-column\",{attrs:{label:\"操作\",align:\"center\",width:\"150\",fixed:\"right\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[i(\"el-button\",{attrs:{type:\"text\"},on:{click:function(i){return e.toDialog(\"addRobotMessage\",t.row)}}},[e._v(\"更新\")]),i(\"el-button\",{attrs:{type:\"text\"},on:{click:function(i){return e.deleteRobotMessage(t.row)}}},[e._v(\"删除\")])]}}])})],1),i(\"addRobotMessage\",{ref:\"addRobotMessage\",on:{fetchData:e.fetchData}}),i(\"el-dialog\",{attrs:{title:\"播放视频\",visible:e.playVisible,\"before-close\":e.closeVideo,\"append-to-body\":!0},on:{\"update:visible\":function(t){e.playVisible=t}}},[i(\"div\",{staticClass:\"content-item\"},[i(\"VueVideoPlayer\",{ref:\"myVideoPlayer\"})],1)])],1)],1)},o=[],r=(i(\"ac1f\"),i(\"841c\"),i(\"159b\"),i(\"333d\")),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"el-dialog\",{attrs:{title:e.title,visible:e.dialogVisible,\"append-to-body\":\"\",width:\"50%\",\"before-close\":e.closeDialog},on:{\"update:visible\":function(t){e.dialogVisible=t}}},[i(\"div\",{staticClass:\"form-list-wrapper\"},[i(\"el-form\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.formLoading,expression:\"formLoading\"}],ref:\"ruleForm\",staticClass:\"form-list\",attrs:{model:e.form,\"label-width\":\"150px\"}},[i(\"el-form-item\",{attrs:{label:\"机器人Id\",prop:\"robotId\"}},[i(\"el-input\",{attrs:{placeholder:\"请输入\",disabled:e.isDisabled},model:{value:e.form.robotId,callback:function(t){e.$set(e.form,\"robotId\",t)},expression:\"form.robotId\"}})],1),i(\"el-form-item\",{attrs:{label:\"话术类型\",prop:\"type\"}},[i(\"el-select\",{attrs:{placeholder:\"请选择\"},on:{change:e.changeType},model:{value:e.form.type,callback:function(t){e.$set(e.form,\"type\",t)},expression:\"form.type\"}},e._l(e.messageTypes,(function(e){return i(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.isText?i(\"el-form-item\",{attrs:{label:\"内容\",prop:\"text\"}},[i(\"el-input\",{attrs:{type:\"textarea\",autosize:{minRows:3,maxRows:5},placeholder:\"请输入内容\",maxlength:\"50\",\"show-word-limit\":\"\"},model:{value:e.form.text,callback:function(t){e.$set(e.form,\"text\",t)},expression:\"form.text\"}})],1):i(\"el-form-item\",{attrs:{label:\"文件\",prop:\"uri\"}},[i(\"div\",{staticClass:\"img\"},[i(\"el-upload\",{attrs:{limit:1,accept:e.accept,\"on-preview\":e.imgPreview,\"on-change\":e.successFile,\"on-remove\":e.removeFile,\"list-type\":\"picture-card\",\"file-list\":e.fileArr,\"auto-upload\":!1}},[i(\"i\",{staticClass:\"el-icon-plus\"})])],1)]),i(\"el-form-item\",{attrs:{label:\"排序\",prop:\"sort\"}},[i(\"el-input-number\",{attrs:{min:1},model:{value:e.form.sort,callback:function(t){e.$set(e.form,\"sort\",t)},expression:\"form.sort\"}})],1),i(\"el-form-item\",{attrs:{label:\"时间间隔\",prop:\"interval\"}},[i(\"el-input-number\",{attrs:{min:1},model:{value:e.form.interval,callback:function(t){e.$set(e.form,\"interval\",t)},expression:\"form.interval\"}}),e._v(\"  秒\\n                \")],1),i(\"el-form-item\",{attrs:{label:\"是否开启\",prop:\"enable\"}},[i(\"el-switch\",{model:{value:e.form.enable,callback:function(t){e.$set(e.form,\"enable\",t)},expression:\"form.enable\"}})],1),i(\"el-form-item\",{staticClass:\"submit-box\"},[i(\"el-button\",{staticStyle:{\"margin-right\":\"50px\"},attrs:{type:\"primary\"},on:{click:e.submitForm}},[e._v(\"确   定\")]),i(\"el-button\",{on:{click:e.resetForm}},[e._v(\"重   置\")])],1)],1)],1),i(\"el-dialog\",{attrs:{visible:e.imgDialog,\"modal-append-to-body\":!0,\"append-to-body\":\"\"},on:{\"update:visible\":function(t){e.imgDialog=t}}},[i(\"img\",{attrs:{width:\"100%\",src:e.imgUri,alt:\"\"}})])],1)},s=[],l=i(\"7139\"),c=i(\"f3e4\"),u=i(\"cebe\"),d=i.n(u),p={data:function(){return{form:{},title:\"新增话术\",dialogVisible:!1,formLoading:!1,isDisabled:!1,accept:\"\",isText:!0,fileType:1,imgDialog:!1,imgUri:void 0,fileArr:[],messageTypes:Object(l[\"v\"])(),actionTypes:Object(l[\"a\"])()}},methods:{init:function(e,t){\"undefined\"!=typeof e.id?(this.title=\"编辑话术\",this.form=e,this.fileArr.push({url:e.uri}),this.changeType(e.type,!0)):(this.form={},this.form.robotId=t),this.isDisabled=!0},submitForm:function(){var e=this,t=this;this.$refs.ruleForm.validate((function(i){if(i){var a=e.form;a.robotId=parseInt(a.robotId),e.$service.robot.saveRobotMessage(a,(function(e){e?(t.$message.success(\"保存成功!\"),t.closeDialog()):t.$message.error(\"保存失败!\")}))}}))},imgPreview:function(e){this.imgDialog=!0,this.imgUri=e.url},successFile:function(e){var t=this;this.formLoading=!0,this.imgUpload(e.raw,this.fileType,(function(e){1===t.fileType?t.form.uri=e.uri:2===t.fileType?(t.form.uri=e.uri,t.form.thumb=e.thumb):3===t.fileType&&(t.form.uri=e.uri,t.form.duration=e.duration),t.formLoading=!1}))},removeFile:function(e,t){this.form.uri=void 0,this.form.thumb=void 0,this.form.duration=void 0,this.fileArr=void 0},imgUpload:function(e,t,i){var a={\"Content-Type\":\"multipart/form-data\",token:Object(c[\"a\"])(),\"area-id\":1,\"file-type\":t},o=new FormData;o.append(\"file\",e),d()({url:\"https://freshjuice.cc/file/upload\",method:\"post\",data:o,headers:a}).then((function(e){var t=e.data;i(t)}))},changeType:function(e,t){1===e?this.isText=!0:4===e?(this.isText=!1,this.fileType=1,this.form.text=\"\",this.accept=\"image/*\"):5===e||8===e?(this.isText=!1,this.fileType=2,this.form.text=\"\",this.accept=\"video/*\"):6===e&&(this.isText=!1,this.fileType=3,this.form.text=\"\",this.accept=\"audio/*\"),t||(this.removeFile(),document.getElementsByClassName(\"el-icon-delete\")[0].click())},resetForm:function(e){this.$refs.ruleForm.resetFields()},closeDialog:function(){this.formLoading=!1,this.fileArr=[],this.isText=!0,this.dialogVisible=!1,this.isDisabled=!1,this.resetForm(),this.$emit(\"fetchData\")}}},f=p,m=(i(\"d650\"),i(\"2877\")),h=Object(m[\"a\"])(f,n,s,!1,null,null,null),b=h.exports,g=i(\"b522\"),v=i(\"be3f\"),y=i(\"4ec3\"),w={name:\"Table\",components:{Pagination:r[\"a\"],Hints:g[\"a\"],addRobotMessage:b,VueVideoPlayer:v[\"a\"]},data:function(){return{listLoading:!0,search:{robotId:void 0,anchorId:void 0,nickname:\"\",page:{currentPage:1,pageSize:10}},total:0,tableData:[],multipleSelection:[],formVisible:!1,playVisible:!1,isHints:!0}},created:function(){this.search.robotId=this.$route.query.robotId,this.search.nickname=this.$route.query.nickname,this.fetchData()},watch:{$route:{handler:function(){var e=this.$route.query.robotId,t=this.$route.query.nickname;Object(y[\"b\"])(e)||(this.search.robotId=e,this.search.nickname=t,this.fetchData())},deep:!0}},methods:{fetchData:function(){var e=this;this.listLoading=!0,\"undefined\"!=typeof this.search.robotId?this.$service.robot.getRobotMessageList(this.search,(function(t){var i=t.getMessagesList(),a=[];i.forEach((function(e,t){var i={id:e.getId(),robotId:e.getAnchorId(),type:e.getType(),typeStr:Object(l[\"u\"])(e.getType()),text:e.getText(),uri:e.getUri(),thumb:e.getThumb(),sort:e.getSort(),enable:e.getEnable(),interval:e.getInterval(),action:e.getAction(),actionStr:Object(l[\"a\"])(!1,e.getAction()),struct:e};a.push(i)})),e.tableData=a,e.listLoading=!1})):this.listLoading=!1},onSearch:function(){this.search.page.currentPage=1,this.fetchData()},toDialog:function(e,t){var i=this;this.$refs[e].dialogVisible=!0,this.$nextTick((function(){i.$refs[e].init(t,i.search.robotId)}))},handleSelectionChange:function(e){this.multipleSelection=e},play:function(e){var t=this;this.playVisible=!0;var i=e.uri;this.$nextTick((function(){t.$refs.myVideoPlayer.initSrc(i)}))},closeVideo:function(){var e=this;this.playVisible=!1,this.$nextTick((function(){e.$refs.myVideoPlayer.emptySrc()}))},deleteRobotMessage:function(e){var t=this;this.$confirm(\"是否删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){var i=t,a={id:e.id};t.$service.robot.deleteRobotMessage(a,(function(e){e?i.$message.success(\"删除成功!\"):i.$message.error(\"删除失败 !\"),i.fetchData()}))}))}}},x=w,$=(i(\"e550\"),Object(m[\"a\"])(x,a,o,!1,null,null,null));t[\"default\"]=$.exports},be3f:function(e,t,i){\"use strict\";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"videoPlayer\",{ref:\"videoPlayer\",staticClass:\"video-player vjs-custom-skin\",attrs:{playsinline:!0,options:e.playerOptions}})},o=[],r=i(\"d6d3\"),n=(i(\"fda2\"),{name:\"VueVideoPlayer\",components:{videoPlayer:r[\"videoPlayer\"]},data:function(){return{playerOptions:{playbackRates:[.7,1,1.5,2],autoplay:!0,muted:!1,loop:!1,preload:\"auto\",language:\"zh-CN\",aspectRatio:\"16:9\",fluid:!0,sources:[{type:\"video/mp4\",src:\"\"}],poster:\"\",notSupportedMessage:\"此视频暂无法播放，请稍后再试\",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}}},methods:{initSrc:function(e){this.playerOptions.sources[0].src=e},emptySrc:function(){this.playerOptions.sources[0].src=\"\"}}}),s=n,l=i(\"2877\"),c=Object(l[\"a\"])(s,a,o,!1,null,null,null);t[\"a\"]=c.exports},d650:function(e,t,i){\"use strict\";i(\"1acb\")},de17:function(e,t,i){},e550:function(e,t,i){\"use strict\";i(\"a55c\")},f678:function(e,t,i){}}]);","extractedComments":[]}