{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-0637f305\"],{1:function(e,t){},\"1a0d\":function(e,t,a){},\"1e1d\":function(e,t,a){\"use strict\";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"table-classic-wrapper\"},[a(\"el-card\",{attrs:{shadow:\"always\"}},[a(\"div\",{staticClass:\"control-btns\"},[a(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(t){return e.toDialog(\"addAutoMessage\",\"\")}}},[e._v(\"+ 新增话术\")])],1),a(\"el-form\",{ref:\"searchForm\",staticClass:\"search-form\",attrs:{inline:!0,model:e.search,\"label-width\":\"90px\"}},[[a(\"el-form-item\",{attrs:{label:\"区域\",prop:\"areaId\"}},[a(\"el-select\",{attrs:{disabled:0!==e.authAreaId,placeholder:\"请选择\"},model:{value:e.search.areaId,callback:function(t){e.$set(e.search,\"areaId\",t)},expression:\"search.areaId\"}},e._l(e.areaData,(function(e){return a(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"场景标签\",prop:\"action\"}},[a(\"el-select\",{attrs:{placeholder:\"请选择\"},model:{value:e.search.action,callback:function(t){e.$set(e.search,\"action\",t)},expression:\"search.action\"}},e._l(e.actionTypes,(function(e){return a(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"状态\",prop:\"enable\"}},[a(\"el-switch\",{model:{value:e.search.enable,callback:function(t){e.$set(e.search,\"enable\",t)},expression:\"search.enable\"}})],1),a(\"el-form-item\",[a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.onSearch}},[e._v(\"筛选\")])],1)]],2),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],ref:\"multipleTable\",staticStyle:{width:\"100%\"},attrs:{data:e.tableData,\"tooltip-effect\":\"dark\",size:\"medium\"},on:{\"selection-change\":e.handleSelectionChange}},[a(\"el-table-column\",{attrs:{type:\"selection\",width:\"60\"}}),a(\"el-table-column\",{attrs:{prop:\"id\",label:\"话术ID\",align:\"center\",width:\"80\"}}),a(\"el-table-column\",{attrs:{prop:\"areaName\",label:\"区域\",align:\"center\",width:\"120\"}}),a(\"el-table-column\",{attrs:{prop:\"action\",label:\"动作类型\",align:\"center\",width:\"150\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"div\",{attrs:{slot:\"reference\"},slot:\"reference\"},[a(\"el-tag\",{attrs:{size:\"medium\"}},[e._v(e._s(t.row.actionStr))])],1)]}}])}),a(\"el-table-column\",{attrs:{prop:\"type\",label:\"消息类型\",align:\"center\",width:\"150\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"div\",{attrs:{slot:\"reference\"},slot:\"reference\"},[a(\"el-tag\",{attrs:{size:\"medium\"}},[e._v(e._s(t.row.typeStr))])],1)]}}])}),a(\"el-table-column\",{attrs:{prop:\"enable\",label:\"状态\",align:\"center\",width:\"150\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-switch\",{attrs:{disabled:\"\"},model:{value:t.row.enable,callback:function(a){e.$set(t.row,\"enable\",a)},expression:\"scope.row.enable\"}})]}}])}),a(\"el-table-column\",{attrs:{prop:\"text\",label:\"内容\",align:\"center\"}}),a(\"el-table-column\",{attrs:{prop:\"thumb\",label:\"文件\",align:\"center\",width:\"200\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[4===t.row.type?a(\"div\",[a(\"el-image\",{staticStyle:{width:\"50px\",height:\"50px\"},attrs:{contain:\"\",src:t.row.uri,\"preview-src-list\":[t.row.uri]}})],1):e._e(),5===t.row.type||8===t.row.type?a(\"div\",[a(\"el-image\",{staticStyle:{width:\"50px\",height:\"50px\"},attrs:{src:t.row.thumb,contain:\"\"},on:{click:function(a){return e.play(t.row)}}})],1):e._e(),6===t.row.type?a(\"div\",[t.row.uri?a(\"div\",[a(\"m-audio\",{attrs:{src:t.row.uri}})],1):e._e()]):e._e()]}}])}),a(\"el-table-column\",{attrs:{label:\"操作\",align:\"center\",width:\"150\",fixed:\"right\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{attrs:{type:\"text\"},on:{click:function(a){return e.toDialog(\"addAutoMessage\",t.row)}}},[e._v(\"更新\")]),a(\"el-button\",{attrs:{type:\"text\"},on:{click:function(a){return e.deleteAutoMessage(t.row)}}},[e._v(\"删除\")])]}}])})],1),a(\"Pagination\",{attrs:{total:e.total,page:e.search.page.currentPage,limit:e.search.page.pageSize},on:{\"update:page\":function(t){return e.$set(e.search.page,\"currentPage\",t)},\"update:limit\":function(t){return e.$set(e.search.page,\"pageSize\",t)},pagination:e.fetchData,changePageSize:function(t){return e.changePageSize(t)}}}),a(\"addAutoMessage\",{ref:\"addAutoMessage\",on:{fetchData:e.fetchData}}),a(\"el-dialog\",{attrs:{title:\"播放视频\",visible:e.playVisible,\"before-close\":e.closeVideo,\"append-to-body\":!0},on:{\"update:visible\":function(t){e.playVisible=t}}},[a(\"div\",{staticClass:\"content-item\"},[a(\"VueVideoPlayer\",{ref:\"myVideoPlayer\"})],1)])],1)],1)},r=[],l=(a(\"ac1f\"),a(\"841c\"),a(\"159b\"),a(\"333d\")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"el-dialog\",{attrs:{title:\"新增话术\",visible:e.dialogVisible,\"append-to-body\":\"\",width:\"50%\",\"before-close\":e.closeDialog},on:{\"update:visible\":function(t){e.dialogVisible=t}}},[a(\"div\",{staticClass:\"form-list-wrapper\"},[a(\"el-form\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.formLoading,expression:\"formLoading\"}],ref:\"ruleForm\",staticClass:\"form-list\",attrs:{model:e.form,\"label-width\":\"150px\"}},[a(\"el-form-item\",{attrs:{label:\"运营区域\",prop:\"areaId\"}},[a(\"el-select\",{attrs:{placeholder:\"请选择\"},model:{value:e.form.areaId,callback:function(t){e.$set(e.form,\"areaId\",t)},expression:\"form.areaId\"}},e._l(e.areaList,(function(e){return a(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"动作类型\",prop:\"action\"}},[a(\"el-select\",{attrs:{placeholder:\"请选择\"},model:{value:e.form.action,callback:function(t){e.$set(e.form,\"action\",t)},expression:\"form.action\"}},e._l(e.actionTypes,(function(e){return a(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"话术类型\",prop:\"type\"}},[a(\"el-select\",{attrs:{placeholder:\"请选择\"},on:{change:e.changeType},model:{value:e.form.type,callback:function(t){e.$set(e.form,\"type\",t)},expression:\"form.type\"}},e._l(e.messageTypes,(function(e){return a(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.isText?a(\"el-form-item\",{attrs:{label:\"内容\",prop:\"text\"}},[a(\"el-input\",{attrs:{type:\"textarea\",autosize:{minRows:3,maxRows:5},placeholder:\"请输入内容\",\"show-word-limit\":\"\"},model:{value:e.form.text,callback:function(t){e.$set(e.form,\"text\",t)},expression:\"form.text\"}})],1):a(\"el-form-item\",{attrs:{label:\"文件\",prop:\"uri\"}},[a(\"div\",{staticClass:\"img\"},[a(\"el-upload\",{attrs:{action:\"\",limit:1,\"on-preview\":e.imgPreview,\"on-change\":e.successFile,\"on-remove\":e.removeFile,\"list-type\":\"picture-card\",\"file-list\":e.fileArr,\"auto-upload\":!1}},[a(\"i\",{staticClass:\"el-icon-plus\"})])],1)]),a(\"el-form-item\",{attrs:{label:\"是否开启\",prop:\"enable\"}},[a(\"el-switch\",{model:{value:e.form.enable,callback:function(t){e.$set(e.form,\"enable\",t)},expression:\"form.enable\"}})],1),a(\"el-form-item\",{staticClass:\"submit-box\"},[a(\"el-button\",{staticStyle:{\"margin-right\":\"50px\"},attrs:{type:\"primary\"},on:{click:e.submitForm}},[e._v(\"确   定\")]),a(\"el-button\",{on:{click:e.resetForm}},[e._v(\"重   置\")])],1)],1)],1)])},n=[],s=a(\"7139\"),c=a(\"f3e4\"),u=a(\"cebe\"),p=a.n(u),f={data:function(){return{form:{enable:!0},dialogVisible:!1,isText:!0,fileArr:[],formLoading:!1,areaList:Object(s[\"f\"])(!1),actionTypes:Object(s[\"a\"])(),messageTypes:Object(s[\"u\"])()}},methods:{init:function(e){\"undefined\"!=typeof e.id&&(this.title=\"编辑话术\",this.form=e,this.fileArr.push({url:e.uri}),this.changeType(e.type,!0))},submitForm:function(){var e=this,t=this;this.$refs.ruleForm.validate((function(a){if(a){var i=e.form;e.$service.robot.saveAutoMessage(i,(function(e){e?(t.$message.success(\"保存成功!\"),t.closeDialog()):t.$message.error(\"保存失败!\")}))}}))},imgPreview:function(e){this.imgDialog=!0,this.imgUri=e.url},successFile:function(e){var t=this;this.formLoading=!0,this.imgUpload(e.raw,this.fileType,(function(e){1===t.fileType?t.form.uri=e.uri:2===t.fileType?(t.form.uri=e.uri,t.form.thumb=e.thumb):3===t.fileType&&(t.form.uri=e.uri,t.form.duration=e.duration),t.formLoading=!1}))},removeFile:function(e,t){this.form.uri=void 0,this.form.thumb=void 0,this.form.duration=void 0,this.fileArr=void 0},imgUpload:function(e,t,a){var i={\"Content-Type\":\"multipart/form-data\",token:Object(c[\"a\"])(),\"area-id\":1,\"file-type\":t},r=new FormData;r.append(\"file\",e),p()({url:\"https://freshjuice.cc\",method:\"post\",data:r,headers:i}).then((function(e){var t=e.data;a(t)}))},changeType:function(e,t){1===e?this.isText=!0:4===e?(this.isText=!1,this.fileType=1,this.form.text=\"\"):5===e||8===e?(this.isText=!1,this.fileType=2,this.form.text=\"\"):6===e&&(this.isText=!1,this.fileType=3,this.form.text=\"\"),t||this.removeFile()},resetForm:function(){this.$refs.ruleForm.resetFields()},closeDialog:function(){this.formLoading=!1,this.fileArr=[],this.isText=!0,this.dialogVisible=!1,this.resetForm(),this.$emit(\"fetchData\")}}},d=f,m=(a(\"c48e\"),a(\"2877\")),h=Object(m[\"a\"])(d,o,n,!1,null,null,null),g=h.exports,b=a(\"be3f\"),y={components:{Pagination:l[\"a\"],addAutoMessage:g,VueVideoPlayer:b[\"a\"]},data:function(){return{listLoading:!0,search:{areaId:void 0,enable:!0,action:0,page:{currentPage:1,pageSize:10}},total:0,authAreaId:Object(s[\"n\"])(),multipleSelection:[],tableData:[],playVisible:!1,areaData:Object(s[\"f\"])(!1),bools:Object(s[\"j\"])(),actionTypes:Object(s[\"a\"])(!0)}},created:function(){this.search.areaId=0===this.authAreaId?this.areaData[0].value:this.authAreaId,this.fetchData()},methods:{handleSelectionChange:function(e){this.multipleSelection=e},fetchData:function(){var e=this;this.listLoading=!0,this.$service.robot.getAutoMessageList(this.search,(function(t){var a=t.getMessagesList(),i=[];a.forEach((function(t,a){var r={id:t.getId(),areaId:t.getAreaId(),areaName:Object(s[\"g\"])(e.areaData,t.getAreaId()),type:t.getType(),typeStr:Object(s[\"u\"])(t.getType()),action:t.getAction(),actionStr:Object(s[\"a\"])(!1,t.getAction()),text:t.getText(),enable:t.getEnable(),uri:t.getUri(),thumb:t.getThumb(),struct:t};i.push(r)})),e.total=t.getTotalCount(),e.tableData=i,e.listLoading=!1}))},onSearch:function(){this.search.currentPage=1,this.fetchData()},toDialog:function(e,t){var a=this;this.$refs[e].dialogVisible=!0,this.$nextTick((function(){a.$refs[e].init(t)}))},resetForm:function(){this.$refs.searchForm.resetFields()},changePageSize:function(e){this.search.page.pageSize=e.limit},play:function(e){var t=this;this.playVisible=!0;var a=e.uri;this.$nextTick((function(){t.$refs.myVideoPlayer.initSrc(a)}))},closeVideo:function(){var e=this;this.playVisible=!1,this.$nextTick((function(){e.$refs.myVideoPlayer.emptySrc()}))},deleteAutoMessage:function(e){var t=this;this.$confirm(\"是否删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){var a=t,i={id:e.id};t.$service.robot.deleteAutoMessage(i,(function(e){e?a.$message.success(\"删除成功!\"):a.$message.error(\"删除失败 !\"),a.fetchData()}))}))}}},v=y,w=(a(\"a0fc\"),Object(m[\"a\"])(v,i,r,!1,null,null,null));t[\"default\"]=w.exports},\"206f\":function(e,t,a){\"use strict\";a(\"f678\")},\"333d\":function(e,t,a){\"use strict\";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"pagination-wrapper\"},[a(\"el-pagination\",{attrs:{background:e.background,\"current-page\":e.currentPage,\"page-sizes\":e.pageSizes,\"page-size\":e.pageSize,total:e.total,layout:e.layout},on:{\"update:currentPage\":function(t){e.currentPage=t},\"update:current-page\":function(t){e.currentPage=t},\"update:pageSize\":function(t){e.pageSize=t},\"update:page-size\":function(t){e.pageSize=t},\"size-change\":e.handleSizeChange,\"current-change\":e.handleCurrentChange}})],1)},r=[],l=(a(\"a9e3\"),{name:\"Pagination\",props:{page:{type:Number,default:1,required:!0},limit:{type:Number,default:10,required:!0},background:{type:Boolean,default:!0},pageSizes:{type:Array,default:function(){return[5,10,15,20,50,1e3]}},total:{type:Number,default:0,required:!0},layout:{type:String,default:\"total, prev, pager, next, sizes, jumper\"}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit(\"update:page\",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.emit(\"update:limit\",e)}}},methods:{handleSizeChange:function(e){this.$emit(\"changePageSize\",{page:this.currentPage,limit:e}),this.$emit(\"pagination\",{page:this.currentPage,limit:e})},handleCurrentChange:function(e){this.$emit(\"pagination\",{page:e,limit:this.pageSize})}}}),o=l,n=(a(\"206f\"),a(\"2877\")),s=Object(n[\"a\"])(o,i,r,!1,null,null,null);t[\"a\"]=s.exports},a0fc:function(e,t,a){\"use strict\";a(\"1a0d\")},be3f:function(e,t,a){\"use strict\";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"videoPlayer\",{ref:\"videoPlayer\",staticClass:\"video-player vjs-custom-skin\",attrs:{playsinline:!0,options:e.playerOptions}})},r=[],l=a(\"d6d3\"),o=(a(\"fda2\"),{name:\"VueVideoPlayer\",components:{videoPlayer:l[\"videoPlayer\"]},data:function(){return{playerOptions:{playbackRates:[.7,1,1.5,2],autoplay:!0,muted:!1,loop:!1,preload:\"auto\",language:\"zh-CN\",aspectRatio:\"16:9\",fluid:!0,sources:[{type:\"video/mp4\",src:\"\"}],poster:\"\",notSupportedMessage:\"此视频暂无法播放，请稍后再试\",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}}},methods:{initSrc:function(e){this.playerOptions.sources[0].src=e},emptySrc:function(){this.playerOptions.sources[0].src=\"\"}}}),n=o,s=a(\"2877\"),c=Object(s[\"a\"])(n,i,r,!1,null,null,null);t[\"a\"]=c.exports},c13d:function(e,t,a){},c48e:function(e,t,a){\"use strict\";a(\"c13d\")},f678:function(e,t,a){}}]);","extractedComments":[]}