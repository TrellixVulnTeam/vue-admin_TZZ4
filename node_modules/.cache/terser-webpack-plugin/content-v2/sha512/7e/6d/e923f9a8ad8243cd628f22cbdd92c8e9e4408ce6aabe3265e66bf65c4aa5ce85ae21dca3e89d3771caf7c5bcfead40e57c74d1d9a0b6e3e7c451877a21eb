{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-d5312cd8\"],{1:function(t,e){},\"206f\":function(t,e,i){\"use strict\";i(\"f678\")},\"2f9b\":function(t,e,i){},\"333d\":function(t,e,i){\"use strict\";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"pagination-wrapper\"},[i(\"el-pagination\",{attrs:{background:t.background,\"current-page\":t.currentPage,\"page-sizes\":t.pageSizes,\"page-size\":t.pageSize,total:t.total,layout:t.layout},on:{\"update:currentPage\":function(e){t.currentPage=e},\"update:current-page\":function(e){t.currentPage=e},\"update:pageSize\":function(e){t.pageSize=e},\"update:page-size\":function(e){t.pageSize=e},\"size-change\":t.handleSizeChange,\"current-change\":t.handleCurrentChange}})],1)},n=[],o=(i(\"a9e3\"),{name:\"Pagination\",props:{page:{type:Number,default:1,required:!0},limit:{type:Number,default:10,required:!0},background:{type:Boolean,default:!0},pageSizes:{type:Array,default:function(){return[5,10,15,20,50,1e3]}},total:{type:Number,default:0,required:!0},layout:{type:String,default:\"total, prev, pager, next, sizes, jumper\"}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit(\"update:page\",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.emit(\"update:limit\",t)}}},methods:{handleSizeChange:function(t){this.$emit(\"changePageSize\",{page:this.currentPage,limit:t}),this.$emit(\"pagination\",{page:this.currentPage,limit:t})},handleCurrentChange:function(t){this.$emit(\"pagination\",{page:t,limit:this.pageSize})}}}),r=o,s=(i(\"206f\"),i(\"2877\")),l=Object(s[\"a\"])(r,a,n,!1,null,null,null);e[\"a\"]=l.exports},\"3c2a\":function(t,e,i){\"use strict\";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"table-classic-wrapper\"},[i(\"Hints\",[i(\"template\",{slot:\"hintName\"},[t._v(\" 编辑 < \"+t._s(t.search.nickname)+\" > 动态\")])],2),i(\"el-card\",{attrs:{shadow:\"always\"}},[i(\"div\",{staticClass:\"control-btns\"},[i(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(e){return t.toDialog(\"addRobotDynamic\",void 0,t.search.entityId)}}},[t._v(\"+ 新增动态\")]),i(\"el-button\",{attrs:{type:\"danger\"},on:{click:t.batchDelete}},[t._v(\"批量删除\")])],1),i(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],ref:\"multipleTable\",staticStyle:{width:\"100%\"},attrs:{data:t.tableData,\"tooltip-effect\":\"dark\",size:\"medium\"}},[i(\"el-table-column\",{attrs:{type:\"selection\",width:\"60\"}}),i(\"el-table-column\",{attrs:{prop:\"entityId\",label:\"机器人Id\",align:\"center\",width:\"100\"}}),i(\"el-table-column\",{attrs:{prop:\"areaStr\",label:\"区域\",align:\"center\",width:\"80\"}}),i(\"el-table-column\",{attrs:{prop:\"status\",label:\"审核状态\",align:\"center\",width:\"150\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[i(\"el-tag\",{attrs:{size:\"medium\"}},[t._v(t._s(e.row.status))])]}}])}),i(\"el-table-column\",{attrs:{prop:\"content\",label:\"内容\",align:\"center\",width:\"350\"}}),i(\"el-table-column\",{attrs:{prop:\"images\",label:\"图片\",align:\"center\",width:\"120\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[e.row.images[0]?i(\"el-image\",{staticStyle:{width:\"50px\",height:\"50px\"},attrs:{fit:\"contain\",src:e.row.images[0],\"preview-src-list\":e.row.images}}):t._e()]}}])}),i(\"el-table-column\",{attrs:{prop:\"thumb\",label:\"视频\",align:\"center\",width:\"150\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[e.row.thumb?i(\"el-image\",{staticStyle:{width:\"50px\",height:\"50px\"},attrs:{src:e.row.thumb,contain:\"\"},on:{click:function(i){return t.play(e.row)}}}):t._e()]}}])}),i(\"el-table-column\",{attrs:{prop:\"likes\",label:\"点赞次数\",align:\"center\",width:\"150\"}}),i(\"el-table-column\",{attrs:{prop:\"publishAtTime\",label:\"发布时间\",align:\"center\"}}),i(\"el-table-column\",{attrs:{label:\"操作\",align:\"center\",width:\"150\",fixed:\"right\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[i(\"el-button\",{attrs:{type:\"text\"},on:{click:function(i){return t.toDialog(\"addRobotDynamic\",e.row)}}},[t._v(\"更新\")])]}}])})],1),i(\"addRobotDynamic\",{ref:\"addRobotDynamic\",on:{fetchData:t.fetchData}}),i(\"el-dialog\",{attrs:{title:\"播放视频\",visible:t.playVisible,\"before-close\":t.closeVideo,\"append-to-body\":!0},on:{\"update:visible\":function(e){t.playVisible=e}}},[i(\"div\",{staticClass:\"content-item\"},[i(\"VueVideoPlayer\",{ref:\"myVideoPlayer\"})],1)])],1)],1)},n=[],o=(i(\"ac1f\"),i(\"841c\"),i(\"159b\"),i(\"333d\")),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"el-dialog\",{attrs:{title:t.title,visible:t.dialogVisible,\"append-to-body\":\"\",width:\"50%\",\"before-close\":t.closeDialog},on:{\"update:visible\":function(e){t.dialogVisible=e}}},[i(\"div\",{staticClass:\"form-list-wrapper\"},[i(\"el-form\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.formLoading,expression:\"formLoading\"}],ref:\"ruleForm\",staticClass:\"form-list\",attrs:{model:t.form,\"label-width\":\"150px\"}},[i(\"el-form-item\",{attrs:{label:\"机器人Id\",prop:\"entityId\"}},[i(\"el-input\",{attrs:{disabled:t.isDisabled},model:{value:t.form.entityId,callback:function(e){t.$set(t.form,\"entityId\",e)},expression:\"form.entityId\"}})],1),i(\"el-form-item\",{attrs:{label:\"区域\",prop:\"areaId\"}},[i(\"el-select\",{attrs:{placeholder:\"请选择\"},model:{value:t.form.areaId,callback:function(e){t.$set(t.form,\"areaId\",e)},expression:\"form.areaId\"}},t._l(t.areaList,(function(t){return i(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),i(\"el-form-item\",{attrs:{label:\"内容\",prop:\"content\"}},[i(\"el-input\",{attrs:{type:\"textarea\",autosize:{minRows:3,maxRows:5},placeholder:\"请输入内容\",maxlength:\"50\",\"show-word-limit\":\"\"},model:{value:t.form.content,callback:function(e){t.$set(t.form,\"content\",e)},expression:\"form.content\"}})],1),i(\"el-form-item\",{attrs:{label:\"图片\",prop:\"imgUris\"}},[i(\"div\",{staticClass:\"img\"},[i(\"el-upload\",{attrs:{limit:10,accept:\"image/*\",\"on-preview\":t.imgPreview,\"on-change\":t.successPhoto,\"on-remove\":t.removePhoto,\"list-type\":\"picture-card\",\"file-list\":t.imgUris,\"auto-upload\":!1}},[i(\"i\",{staticClass:\"el-icon-plus\"})])],1)]),i(\"el-form-item\",{attrs:{label:\"视频\",prop:\"videoUris\"}},[i(\"div\",{staticClass:\"img\"},[i(\"el-upload\",{attrs:{limit:10,accept:\"video/*\",\"on-change\":t.successVideo,\"on-remove\":t.removeVideo,\"list-type\":\"picture-card\",\"file-list\":t.videoUris,\"auto-upload\":!1}},[i(\"i\",{staticClass:\"el-icon-plus\"})])],1)]),i(\"el-form-item\",{attrs:{label:\"点赞次数\",prop:\"likes\"}},[i(\"el-input-number\",{attrs:{min:1},model:{value:t.form.likes,callback:function(e){t.$set(t.form,\"likes\",e)},expression:\"form.likes\"}})],1),i(\"el-form-item\",{attrs:{label:\"发布时间\",prop:\"likes\"}},[i(\"el-date-picker\",{attrs:{type:\"datetime\",placeholder:\"选择日期时间\",\"default-time\":\"12:00:00\"},model:{value:t.form.publishAtTime,callback:function(e){t.$set(t.form,\"publishAtTime\",e)},expression:\"form.publishAtTime\"}})],1),i(\"el-form-item\",{staticClass:\"submit-box\"},[i(\"el-button\",{staticStyle:{\"margin-right\":\"50px\"},attrs:{type:\"primary\"},on:{click:t.submitForm}},[t._v(\"确   定\")]),i(\"el-button\",{on:{click:t.resetForm}},[t._v(\"重   置\")])],1)],1)],1),i(\"el-dialog\",{attrs:{visible:t.imgDialog,\"modal-append-to-body\":!0,\"append-to-body\":\"\"},on:{\"update:visible\":function(e){t.imgDialog=e}}},[i(\"img\",{attrs:{width:\"100%\",src:t.imgUri,alt:\"\"}})])],1)},s=[],l=(i(\"a434\"),i(\"7139\")),c=i(\"f3e4\"),u=i(\"cebe\"),d=i.n(u),m=i(\"4ec3\"),f={data:function(){return{form:{images:[]},title:\"新增动态\",formLoading:!1,imgDialog:!1,imgUri:void 0,imgUris:[],videoUris:[],isDisabled:!1,dialogVisible:!1,imgDialogVisible:!1,messageTypes:Object(l[\"u\"])(),areaList:Object(l[\"f\"])(!1),appList:Object(l[\"c\"])()}},methods:{init:function(t,e){var i=this;Object(m[\"b\"])(t)?(this.form.entityId=e,this.imgUris=void 0):(this.title=\"编辑动态\",this.form=t,t.images.length>0&&!Object(m[\"b\"])(t.images[0])?t.images.forEach((function(t){i.imgUris.push({url:t})})):this.imgUris=void 0,Object(m[\"b\"])(t.thumb)||this.videoUris.push({thumb:t.thumb,url:t.uri}),this.form.publishAtTime=new Date(this.form.publishAtTime)),this.isDisabled=!0},submitForm:function(){var t=this,e=this;this.$refs.ruleForm.validate((function(i){if(i){var a=t.form;a.entityType=2,a.status=5,a.publishAt=a.publishAtTime.getTime()/1e3,t.$service.robot.saveMoment(a,(function(t){t?(e.$message.success(\"保存成功!\"),e.closeDialog()):e.$message.error(\"保存失败!\")}))}}))},resetForm:function(){this.$refs.ruleForm.resetFields()},closeDialog:function(){this.formLoading=!1,this.form.video=void 0,this.form.images=[],this.imgUris=[],this.videoUris=[],this.form.entityId=void 0,this.isDisabled=!1,this.dialogVisible=!1,this.resetForm(),this.$emit(\"fetchData\")},imgPreview:function(t){this.imgDialog=!0,this.imgUri=t.url},successPhoto:function(t){var e=this;this.formLoading=!0,this.imgUpload(t.raw,1,(function(t){e.form.images.push(t.uri),e.formLoading=!1}))},successVideo:function(t){var e=this;this.formLoading=!0,this.imgUpload(t.raw,2,(function(t){e.form.video=t.uri,e.form.thumb=t.thumb,e.formLoading=!1}))},removePhoto:function(t,e){for(var i=this.form.images,a=t.url,n=0;n<i.length;n++)if(i[n]===a){i.splice(n,1),this.form.images=0===i.length?void 0:i,alert(this.form.images);break}},removeVideo:function(t,e){this.form.video=void 0},imgUpload:function(t,e,i){var a={\"Content-Type\":\"multipart/form-data\",token:Object(c[\"a\"])(),\"area-id\":1,\"file-type\":e},n=new FormData;n.append(\"file\",t),d()({url:\"http://101.33.118.232:8101/file/upload\",method:\"post\",data:n,headers:a}).then((function(t){var e=t.data;i(e)}))}}},p=f,h=(i(\"bc7a\"),i(\"2877\")),g=Object(h[\"a\"])(p,r,s,!1,null,null,null),b=g.exports,y=i(\"b522\"),v=i(\"ca00\"),w=i(\"be3f\"),D={name:\"Table\",components:{Pagination:o[\"a\"],Hints:y[\"a\"],addRobotDynamic:b,VueVideoPlayer:w[\"a\"]},data:function(){return{listLoading:!0,search:{entityType:2,entityId:\"\",page:{currentPage:1,pageSize:10}},total:0,tableData:[],multipleSelection:[],formVisible:!1,playVisible:!1,areaList:Object(l[\"f\"])(!0),appList:[]}},created:function(){this.search.entityId=this.$route.query.robotId,this.search.nickname=this.$route.query.nickname,this.fetchData()},watch:{$route:{handler:function(t,e){this.search.entityId=this.$route.query.robotId,this.search.nickname=this.$route.query.nickname,this.fetchData()},deep:!0}},methods:{fetchData:function(){var t=this;this.listLoading=!0,this.$service.robot.getMomentList(this.search,(function(e){var i=e.getMomentsList(),a=[];i.forEach((function(e,i){var n={id:e.getId(),appId:e.getAppId(),areaId:e.getAreaId(),areaStr:Object(l[\"g\"])(t.areaList,e.getAreaId()),entityType:e.getEntityType(),entityId:e.getEntityId(),status:Object(l[\"D\"])(e.getStatus()),content:e.getContent(),images:e.getImagesList(),video:e.getVideo(),thumb:e.getThumb(),likes:e.getLikes(),publishAtTime:Object(v[\"i\"])(e.getPublishAt()),nickname:e.getNickname(),avatar:e.getAvatar(),struct:e};a.push(n)})),t.tableData=a,t.listLoading=!1}))},onSubmit:function(){this.search.page.currentPage=1,this.fetchData()},toDialog:function(t,e,i){var a=this;this.$refs[t].dialogVisible=!0,this.$nextTick((function(){a.$refs[t].init(e,i)}))},play:function(t){var e=this;this.playVisible=!0;var i=t.video;this.$nextTick((function(){e.$refs.myVideoPlayer.initSrc(i)}))},closeVideo:function(){var t=this;this.playVisible=!1,this.$nextTick((function(){t.$refs.myVideoPlayer.emptySrc()}))},handleDelete:function(t,e){var i=this;console.log(t,e),this.$confirm(\"此操作将删除选中数据, 是否继续?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){i.$message({type:\"success\",message:\"删除成功!\"})})).catch((function(){i.$message({type:\"info\",message:\"已取消删除\"})}))},batchDelete:function(){this.multipleSelection.length<1?this.$message({message:\"请先选择要删除的数据！\",type:\"warning\"}):this.handleDelete()}}},k=D,$=(i(\"82bb\"),Object(h[\"a\"])(k,a,n,!1,null,null,null));e[\"default\"]=$.exports},\"404b\":function(t,e,i){\"use strict\";i(\"de17\")},\"82bb\":function(t,e,i){\"use strict\";i(\"2f9b\")},\"8b72\":function(t,e,i){},b522:function(t,e,i){\"use strict\";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"hints-wrapper\"},[i(\"div\",{staticClass:\"hint-title\"},[i(\"i\",{staticClass:\"vue-dsn-icon-tishi\"}),i(\"span\",[t._t(\"hintName\")],2)]),i(\"div\",{staticClass:\"hint-info\"},[t._t(\"hintInfo\")],2)])},n=[],o={name:\"Hints\"},r=o,s=(i(\"404b\"),i(\"2877\")),l=Object(s[\"a\"])(r,a,n,!1,null,null,null);e[\"a\"]=l.exports},bc7a:function(t,e,i){\"use strict\";i(\"8b72\")},be3f:function(t,e,i){\"use strict\";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"videoPlayer\",{ref:\"videoPlayer\",staticClass:\"video-player vjs-custom-skin\",attrs:{playsinline:!0,options:t.playerOptions}})},n=[],o=i(\"d6d3\"),r=(i(\"fda2\"),{name:\"VueVideoPlayer\",components:{videoPlayer:o[\"videoPlayer\"]},data:function(){return{playerOptions:{playbackRates:[.7,1,1.5,2],autoplay:!0,muted:!1,loop:!1,preload:\"auto\",language:\"zh-CN\",aspectRatio:\"16:9\",fluid:!0,sources:[{type:\"video/mp4\",src:\"\"}],poster:\"\",notSupportedMessage:\"此视频暂无法播放，请稍后再试\",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}}},methods:{initSrc:function(t){this.playerOptions.sources[0].src=t},emptySrc:function(){this.playerOptions.sources[0].src=\"\"}}}),s=r,l=i(\"2877\"),c=Object(l[\"a\"])(s,a,n,!1,null,null,null);e[\"a\"]=c.exports},ca00:function(t,e,i){\"use strict\";i.d(e,\"h\",(function(){return a})),i.d(e,\"g\",(function(){return n})),i.d(e,\"i\",(function(){return o})),i.d(e,\"d\",(function(){return r})),i.d(e,\"c\",(function(){return s})),i.d(e,\"e\",(function(){return l})),i.d(e,\"a\",(function(){return c})),i.d(e,\"f\",(function(){return u})),i.d(e,\"b\",(function(){return d}));i(\"b0c0\");function a(t){return t/100}function n(t){return 0===t?\"\":new Date(1e3*t).format(\"yyyy-MM-dd\")}function o(t){return 0===t?\"\":new Date(1e3*t).format(\"yyyy-MM-dd hh:mm:ss\")}function r(t){return\"undefined\"==typeof t&&(t=new Date),t.format(\"yyyy-MM-dd\")}function s(t){var e=new Date((new Date).toLocaleDateString());return t?new Date(e.setDate(e.getDate()+t)):e}function l(){return new Date((new Date).toLocaleDateString())}function c(){return new Date(1e3*d(new Date))}function u(t){return new Date(t.toLocaleDateString()).getTime()/1e3}function d(t){return u(t)+86400-1}},de17:function(t,e,i){},f678:function(t,e,i){}}]);","extractedComments":[]}